######################################################################
#Python Script Generated by GeneratePythonScript Algorithm
######################################################################
LoadAscii(Filename=r'NOM_11848-4.dat',OutputWorkspace='NOM_11848-4',Unit='TOF')
CreateLeBailFitInput(ReflectionsFile=r'LB4853b2.hkl',FullprofParameterFile=r'nom60b4.irf',Bank='4',LatticeConstant='4.1568899999999998',InstrumentParameterWorkspace='Bank4InstrumentParameterTable1',BraggPeakParameterWorkspace='BraggPeakParameterTable1')
ProcessBackground(InputWorkspace='NOM_11848-4',OutputWorkspace='NOM_11848-4_Background',Options='SelectBackgroundPoints',LowerBound='2390',UpperBound='18500',BackgroundPoints='2391,2435,2551,3313,4030,5314,5780,7470,8250,10090,10400,12243,14000,15520,17000,18076,18490',NoiseTolerance='0.10000000000000001')
Fit(Function='name=Polynomial,n=6,A0=0.735996,A1=-8.00661e-05,A2=-2.62779e-08,A3=6.85811e-12,A4=-6.29727e-16,A5=2.5987e-20,A6=-4.04945e-25',InputWorkspace='NOM_11848-4_Background',MaxIterations='1000',Minimizer='Levenberg-MarquardtMD',CreateOutput='1',Output='NOM_11848-4_Background',StartX='2390',EndX='18500')
LeBailFit(InputWorkspace='NOM_11848-4',OutputWorkspace='NOM_11848-4_InitGuess',InputParameterWorkspace='Bank4InstrumentParameterTable1',OutputParameterWorkspace='TempTable',InputHKLWorkspace='BraggPeakParameterTable1',OutputPeaksWorkspace='BraggPeakParameterTable2',FitRegion='2390,18500',Function='Calculation',BackgroundParametersWorkspace='NOM_11848-4_Background_Parameters',PeakRadius='8',UseInputPeakHeights='0',Minimizer='Levenberg-Marquardt',MinimumPeakHeight='0.0001')
FitPowderDiffPeaks(InputWorkspace='NOM_11848-4',OutputWorkspace='Bank4FittedPeaks',BraggPeakParameterWorkspace='BraggPeakParameterTable2',InstrumentParameterWorkspace='Bank4InstrumentParameterTable1',OutputBraggPeakParameterWorkspace='BraggPeakParameterTable2_0',OutputBraggPeakParameterDataWorkspace='BraggPeakParameterTable2_P',OutputZscoreWorkspace='BraggPeakParameterTable2_Zscore',MinTOF='10300',MaxTOF='18500',UseGivenPeakCentreTOF='0',MinimumPeakHeight='0.050000000000000003',PeaksCorrelated='1',MinimumHKL='12,12,12',RightMostPeakHKL='2,1,0',RightMostPeakLeftBound='17236',RightMostPeakRightBound='18170')
UpdatePeakParameterTableValue(InputWorkspace='Bank4InstrumentParameterTable1',Column='FitOrTie',NewStringValue='tie')
UpdatePeakParameterTableValue(InputWorkspace='Bank4InstrumentParameterTable1',Column='FitOrTie',ParameterNames='Dtt1',NewStringValue='fit')
RefinePowderInstrumentParameters(InputPeakPositionWorkspace='BraggPeakParameterTable2_P',OutputPeakPositionWorkspace='NOM_11848-4_PeakPositions_Dtt1',InputInstrumentParameterWorkspace='Bank4InstrumentParameterTable1',OutputInstrumentParameterWorkspace='Bank4InstrumentParameterTable1_01',RefinementAlgorithm='OneStepFit')
UpdatePeakParameterTableValue(InputWorkspace='Bank4InstrumentParameterTable1_01',Column='FitOrTie',NewStringValue='tie')
UpdatePeakParameterTableValue(InputWorkspace='Bank4InstrumentParameterTable1_01',Column='FitOrTie',ParameterNames='Dtt1t',NewStringValue='fit')
RefinePowderInstrumentParameters(InputPeakPositionWorkspace='BraggPeakParameterTable2_P',OutputPeakPositionWorkspace='NOM_11848-4_PeakPositions_Dtt1t',InputInstrumentParameterWorkspace='Bank4InstrumentParameterTable1_01',OutputInstrumentParameterWorkspace='Bank4InstrumentParameterTable1_02',RefinementAlgorithm='OneStepFit')
UpdatePeakParameterTableValue(InputWorkspace='Bank4InstrumentParameterTable1_02',Column='FitOrTie',NewStringValue='tie')
UpdatePeakParameterTableValue(InputWorkspace='Bank4InstrumentParameterTable1_02',Column='FitOrTie',ParameterNames='Zerot',NewStringValue='fit')
RefinePowderInstrumentParameters(InputPeakPositionWorkspace='BraggPeakParameterTable2_P',OutputPeakPositionWorkspace='NOM_11848-4_PeakPositions_Zerot',InputInstrumentParameterWorkspace='Bank4InstrumentParameterTable1_02',OutputInstrumentParameterWorkspace='Bank4InstrumentParameterTable1_03',RefinementAlgorithm='OneStepFit')
UpdatePeakParameterTableValue(InputWorkspace='Bank4InstrumentParameterTable1_03',Column='FitOrTie',NewStringValue='tie')
UpdatePeakParameterTableValue(InputWorkspace='Bank4InstrumentParameterTable1_03',Column='FitOrTie',ParameterNames='Zerot,Dtt1,Dtt1t',NewStringValue='fit')
RefinePowderInstrumentParameters(InputPeakPositionWorkspace='BraggPeakParameterTable2_P',OutputPeakPositionWorkspace='NOM_11848-4_PeakPositions_All',InputInstrumentParameterWorkspace='Bank4InstrumentParameterTable1_03',OutputInstrumentParameterWorkspace='Bank4InstrumentParameterTable1_04',RefinementAlgorithm='OneStepFit')
RenameWorkspace(InputWorkspace='Bank4InstrumentParameterTable1_04',OutputWorkspace='Bank4InstrumentParameterTable1_Step2')
ProcessBackground(InputWorkspace='NOM_11848-4',OutputWorkspace='NOM_11848-4_Background',Options='SelectBackgroundPoints',LowerBound='2390',UpperBound='18500',BackgroundPoints='2391,2435,2551,3313,4030,5314,5780,7470,8250,10090,10400,12243,14000,15520,17000,18076,18490',NoiseTolerance='0.10000000000000001')
Fit(Function='name=Polynomial,n=6,A0=0.735996,A1=-8.00661e-05,A2=-2.62779e-08,A3=6.85811e-12,A4=-6.29727e-16,A5=2.5987e-20,A6=-4.04945e-25',InputWorkspace='NOM_11848-4_Background',MaxIterations='1000',Minimizer='Levenberg-MarquardtMD',CreateOutput='1',Output='NOM_11848-4_Background',StartX='2390',EndX='18500')
LeBailFit(InputWorkspace='NOM_11848-4',OutputWorkspace='CalculatedPattern0',InputParameterWorkspace='Bank4InstrumentParameterTable1_Step2',OutputParameterWorkspace='Bank4InstrumentParameterTable1_0',InputHKLWorkspace='BraggPeakParameterTable1',OutputPeaksWorkspace='BraggPeakParameterTable2_0',FitRegion='2390,18500',Function='Calculation',BackgroundParametersWorkspace='NOM_11848-4_Background_Parameters',PeakRadius='8',UseInputPeakHeights='0',Minimizer='Levenberg-Marquardt')

DeleteWorkspace(Workspace="Bank4InstrumentParameterTable1")
DeleteWorkspace(Workspace="Bank4InstrumentParameterTable1_01")
DeleteWorkspace(Workspace="Bank4InstrumentParameterTable1_02")
DeleteWorkspace(Workspace="Bank4InstrumentParameterTable1_03")
#DeleteWorkspace(Workspace="BraggPeakParameterTable1")
DeleteWorkspace(Workspace="BraggPeakParameterTable2")
DeleteWorkspace(Workspace="TempTable")
DeleteWorkspace(Workspace="NOM_11848-4_InitGuess")
DeleteWorkspace(Workspace="NOM_11848-4_PeakPositions_Dtt1")
DeleteWorkspace(Workspace="NOM_11848-4_PeakPositions_Dtt1t")
DeleteWorkspace(Workspace="NOM_11848-4_PeakPositions_Zerot")
DeleteWorkspace(Workspace="NOM_11848-4_PeakPositions_All")
#DeleteWorkspace(Workspace="")
#DeleteWorkspace(Workspace="")
#DeleteWorkspace(Workspace="")
