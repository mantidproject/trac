<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #7677 (Reduction for several inelastic instruments hangs part way through reduction)
     – Mantid Project
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="prev" href="7676.html" title="Ticket #7676" />
        <link rel="last" href="11888.html" title="Ticket #11888" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/7677?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/7677?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/7677?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="7678.html" title="Ticket #7678" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="1.html" title="Ticket #1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Mantid Project" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="a82fe30e7bef2e30fd2838e9";
    </script>
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="../chrome/common/js/resizer.js"></script><script type="text/javascript" src="../chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/mantid/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 7677, escape_newlines: 0}
        $("#comment").autoPreview("/mantid/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/mantid/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.mantidproject.org/"><img src="../chrome/site/mantid_logo_with_name.png" alt="Mantid Logo" width="250" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.mantidproject.org/mantid/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="7676.html" title="Ticket #7676">Previous Ticket</a></span></li><li><span><a class="next" href="7678.html" title="Ticket #7678">Next Ticket</a> &rarr;</span></li><li class="last"><a href="../depgraph/7677.html">Depgraph</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="7677.html">Ticket #7677</a>
          <span class="status">(closed: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-07T09%3A44%3A18%2B01%3A00&amp;precision=second" title="2013-08-07T09:44:18+01:00 in Timeline">7 years</a> ago</p>
    <p>Last modified <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T02%3A05%3A10%2B01%3A00&amp;precision=second" title="2015-06-04T02:05:10+01:00 in Timeline">5 years</a> ago</p>
  </div>
  <h2 class="summary searchable">Reduction for several inelastic instruments hangs part way through reduction</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;reporter=Martyn+Gigg">Martyn Gigg</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;owner=Martyn+Gigg">Martyn Gigg</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;priority=blocker">blocker</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="../milestone/Release&#32;2.6.1.html">Release 2.6.1</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;component=Framework">Framework</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;keywords=~PatchCandidate">PatchCandidate</a>
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby"><span></span></td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking"><span><a class="closed ticket" href="7718.html" title="[C2E] &#34;Do Not Rebin&#34; option causes error with TOSCA">#7718</a></span></td>
        <th id="h_tester">
          Tester:
        </th>
        <td headers="h_tester">
              Wenduo Zhou
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
This happens with release 2.6.
</p>
<ul><li>Start MantidPlot
</li><li>Open Interfaces-&gt;Convert To Energy and select TOSCA
</li><li>Browse for a file, e.g. TSC11453.raw in systemtests/Data
</li><li>For "Rebin Steps", uncheck "do not rebin", select multiple and enter: -2.5,0.015,3,-0.005,1000
</li><li>Click "Run Energy Transfer"
</li></ul>
    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="7677.html#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-07T09%3A44%3A24%2B01%3A00&amp;precision=second" title="2013-08-07T09:44:24+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>inprogress</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="7677.html#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-07T10%3A01%3A08%2B01%3A00&amp;precision=second" title="2013-08-07T10:01:08+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
The problem appears to be with the fix for <a class="closed ticket" href="7583.html" title="defect: Crash with quick script that changes log values or instrument parameters (closed: fixed)">#7583</a>. 
</p>
<p>
At the point the tree is updated the createInfoNode virtual method on Workspace is called. This in turn calls addInfoNodeTo method, which currently holds a lock while the information is gathered. If the object is actually a WorkspaceGroup then a separate lock is held by WorkspaceGroup in createInfoNode and this then deadlocks with the one trying to be held by addInfoNodeTo.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="7677.html#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-07T16%3A17%3A14%2B01%3A00&amp;precision=second" title="2013-08-07T16:17:14+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Remove mutex lock from WorkspaceGroup::createInfoNode
</p>
<p>
This is called by the base Workspace::addInfoNodeTo method when the object
is a WorkspaceGroup. The base method locks the workspace RWLock but then
for a group the overloaded createInfoNode was then also locking a mutex
that causes a dead-lock while both locks wait for each other to release.
Refs <a class="closed ticket" href="7677.html" title="defect: Reduction for several inelastic instruments hangs part way through ... (closed: fixed)">#7677</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/59477d7a6745832606b84ef724b707ae3022de49" title="59477d7a6745832606b84ef724b707ae3022de49">59477d7a6745832606b84ef724b707ae3022de49</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="7677.html#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-07T16%3A17%3A14%2B01%3A00&amp;precision=second" title="2013-08-07T16:17:14+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix a minor bug in naming of group members in ChopData.
</p>
<p>
The ADS tries to add the members of a group to the ADS if they don't have
a name. It's naming scheme is different to what ChopData does and
so you effectively end up with an object having two names. The dock
then reports workspaces that don't exist and you can't delete them.
Refs <a class="closed ticket" href="7677.html" title="defect: Reduction for several inelastic instruments hangs part way through ... (closed: fixed)">#7677</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/cc0bf307301d176a2082637cd30fd08996681a00" title="cc0bf307301d176a2082637cd30fd08996681a00">cc0bf307301d176a2082637cd30fd08996681a00</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="7677.html#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-08T13%3A41%3A17%2B01%3A00&amp;precision=second" title="2013-08-08T13:41:17+01:00 in Timeline">7 years</a> ago by Nick Draper
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Milestone</strong>
        changed from <em>Release 3.0</em> to <em>Release 2.6.1</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="7677.html#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-08T13%3A53%3A10%2B01%3A00&amp;precision=second" title="2013-08-08T13:53:10+01:00 in Timeline">7 years</a> ago by Nick Draper
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Summary</strong>
        changed from <em>Convert to Energy for TOSCA hangs part way through reduction</em> to <em>Reduction for several inelastic instruments hangs part way through reduction</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="7677.html#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-08T19%3A35%3A33%2B01%3A00&amp;precision=second" title="2013-08-08T19:35:33+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Handle locking of run/sample in ExperimentInfo.
</p>
<p>
This way we can use a more general mutex rather than the specific
critical section used in cow_ptr. Also move some calls that access
the object directly to use the accessor methods that should prevent
access to the object while it is being copied.
Refs <a class="closed ticket" href="7677.html" title="defect: Reduction for several inelastic instruments hangs part way through ... (closed: fixed)">#7677</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/de17341707935da61e5513f74e5dde9a7a93f9b7" title="de17341707935da61e5513f74e5dde9a7a93f9b7">de17341707935da61e5513f74e5dde9a7a93f9b7</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="7677.html#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-09T15%3A10%3A31%2B01%3A00&amp;precision=second" title="2013-08-09T15:10:31+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Branch: bugfix/7677_segfault_c2e
</p>
<p>
Tester: The fix here has been to protect the methods that use a cow_ptr with a mutex so that when they block when copying the cow_ptr.
</p>
<p>
All scripts MUST be run in MantidPlot as the error is with populating the dock. 
</p>
<p>
At minimum the steps in the description should work. Also rerun the script from <a class="closed ticket" href="7583.html" title="defect: Crash with quick script that changes log values or instrument parameters (closed: fixed)">#7583</a> to confirm that it is still okay.
</p>
<p>
Also, check this LET reduction script (data is in the systemtests/Data directory)
</p>
<div class="code"><pre>dgreduce<span class="o">.</span>setup<span class="p">(</span><span class="s">'LET'</span><span class="p">)</span>
white_run <span class="o">=</span> <span class="s">'LET00005545.raw'</span>
sample_run <span class="o">=</span> <span class="s">'LET00006278.nxs'</span>
ei <span class="o">=</span> <span class="mf">7.0</span>
ebin <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.002</span><span class="p">,</span><span class="mf">0.95</span><span class="p">]</span>
map_file <span class="o">=</span> <span class="s">'rings_103'</span>
white_ws <span class="o">=</span> <span class="s">'wb_wksp'</span>
LoadRaw<span class="p">(</span>Filename<span class="o">=</span>white_run<span class="p">,</span>OutputWorkspace<span class="o">=</span>white_ws<span class="p">)</span>
sample_ws <span class="o">=</span> <span class="s">'w1'</span>
monitors_ws <span class="o">=</span> sample_ws <span class="o">+</span> <span class="s">'_monitors'</span>
LoadEventNexus<span class="p">(</span>Filename<span class="o">=</span>sample_run<span class="p">,</span>OutputWorkspace<span class="o">=</span>sample_ws<span class="p">,</span>
               SingleBankPixelsOnly<span class="o">=</span><span class="s">'0'</span><span class="p">,</span>LoadMonitors<span class="o">=</span><span class="s">'1'</span><span class="p">,</span>
               MonitorsAsEvents<span class="o">=</span><span class="s">'1'</span><span class="p">)</span>
ConjoinWorkspaces<span class="p">(</span>InputWorkspace1<span class="o">=</span>sample_ws<span class="p">,</span> InputWorkspace2<span class="o">=</span>monitors_ws<span class="p">)</span>

energy <span class="o">=</span> ei
emin <span class="o">=</span> <span class="mf">0.2</span><span class="o">*</span>energy   <span class="c">#minimum energy is with 80% energy loss</span>
lam <span class="o">=</span> <span class="p">(</span><span class="mf">81.81</span><span class="o">/</span>energy<span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
lam_max <span class="o">=</span> <span class="p">(</span><span class="mf">81.81</span><span class="o">/</span>emin<span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
tsam <span class="o">=</span> <span class="mf">252.82</span><span class="o">*</span>lam<span class="o">*</span><span class="mi">25</span>   <span class="c">#time at sample</span>
tmon2 <span class="o">=</span> <span class="mf">252.82</span><span class="o">*</span>lam<span class="o">*</span><span class="mf">23.5</span> <span class="c">#time to monitor 6 on LET</span>
tmax <span class="o">=</span> tsam<span class="o">+</span><span class="p">(</span><span class="mf">252.82</span><span class="o">*</span>lam_max<span class="o">*</span><span class="mf">4.1</span><span class="p">)</span> <span class="c">#maximum time to measure inelastic signal to</span>
t_elastic <span class="o">=</span> tsam<span class="o">+</span><span class="p">(</span><span class="mf">252.82</span><span class="o">*</span>lam<span class="o">*</span><span class="mf">4.1</span><span class="p">)</span>   <span class="c">#maximum time of elastic signal</span>
tbin <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span>tmon2<span class="p">),</span><span class="mf">1.6</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span>tmax<span class="p">)]</span>
Rebin<span class="p">(</span>InputWorkspace<span class="o">=</span>sample_ws<span class="p">,</span>OutputWorkspace<span class="o">=</span>sample_ws<span class="p">,</span> Params<span class="o">=</span>tbin<span class="p">,</span> PreserveEvents<span class="o">=</span><span class="s">'1'</span><span class="p">)</span>
energybin <span class="o">=</span> <span class="p">[</span>ebin<span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span>energy<span class="p">,</span>ebin<span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span>energy<span class="p">,</span>ebin<span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span>energy<span class="p">]</span>
energybin <span class="o">=</span> <span class="p">[</span> <span class="s">'</span><span class="si">%.4f</span><span class="s">'</span> <span class="o">%</span> elem <span class="k">for</span> elem <span class="ow">in</span> energybin <span class="p">]</span>  
ebinstring <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>energybin<span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s">','</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span>energybin<span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s">','</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span>energybin<span class="p">[</span><span class="mi">2</span><span class="p">])</span>
argi<span class="o">=</span><span class="p">{}</span>
argi<span class="p">[</span><span class="s">'det_cal_file'</span><span class="p">]</span><span class="o">=</span><span class="s">'det_corrected7.dat'</span>
argi<span class="p">[</span><span class="s">'bleed'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
argi<span class="p">[</span><span class="s">'norm_method'</span><span class="p">]</span><span class="o">=</span><span class="s">'current'</span>
argi<span class="p">[</span><span class="s">'detector_van_range'</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span>
argi<span class="p">[</span><span class="s">'bkgd_range'</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span>t_elastic<span class="p">),</span><span class="nb">int</span><span class="p">(</span>tmax<span class="p">)]</span>
argi<span class="p">[</span><span class="s">'hard_mask_file'</span><span class="p">]</span><span class="o">=</span><span class="s">'LET_hard.msk'</span>
reduced_ws <span class="o">=</span> dgreduce<span class="o">.</span>arb_units<span class="p">(</span>white_ws<span class="p">,</span> sample_ws<span class="p">,</span> energy<span class="p">,</span> ebinstring<span class="p">,</span> map_file<span class="p">,</span><span class="o">**</span>argi<span class="p">)</span>
</pre></div><p>
 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="7677.html#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-09T16%3A03%3A25%2B01%3A00&amp;precision=second" title="2013-08-09T16:03:25+01:00 in Timeline">7 years</a> ago by Samuel Jackson
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>7718</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="7677.html#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-12T20%3A05%3A25%2B01%3A00&amp;precision=second" title="2013-08-12T20:05:25+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Remove mutex lock from WorkspaceGroup::createInfoNode
</p>
<p>
This is called by the base Workspace::addInfoNodeTo method when the object
is a WorkspaceGroup. The base method locks the workspace RWLock but then
for a group the overloaded createInfoNode was then also locking a mutex
that causes a dead-lock while both locks wait for each other to release.
Refs <a class="closed ticket" href="7677.html" title="defect: Reduction for several inelastic instruments hangs part way through ... (closed: fixed)">#7677</a>
(cherry picked from commit <a class="changeset" href="https://github.com/mantidproject/mantid/commit/59477d7a6745832606b84ef724b707ae3022de49" title="59477d7a6745832606b84ef724b707ae3022de49">59477d7a6745832606b84ef724b707ae3022de49</a>)
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/839a0fe6d2b3af69aa1e0c82bd985286f1d5e756" title="839a0fe6d2b3af69aa1e0c82bd985286f1d5e756">839a0fe6d2b3af69aa1e0c82bd985286f1d5e756</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-11">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:11" class="cnum">
      <a href="7677.html#comment:11">comment:11</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-12T20%3A05%3A25%2B01%3A00&amp;precision=second" title="2013-08-12T20:05:25+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix a minor bug in naming of group members in ChopData.
</p>
<p>
The ADS tries to add the members of a group to the ADS if they don't have
a name. It's naming scheme is different to what ChopData does and
so you effectively end up with an object having two names. The dock
then reports workspaces that don't exist and you can't delete them.
Refs <a class="closed ticket" href="7677.html" title="defect: Reduction for several inelastic instruments hangs part way through ... (closed: fixed)">#7677</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/0465652f4023bd56e559ac48570a9345c1d7abf9" title="0465652f4023bd56e559ac48570a9345c1d7abf9">0465652f4023bd56e559ac48570a9345c1d7abf9</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:12" class="cnum">
      <a href="7677.html#comment:12">comment:12</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-12T20%3A05%3A25%2B01%3A00&amp;precision=second" title="2013-08-12T20:05:25+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Handle locking of run/sample in ExperimentInfo.
</p>
<p>
This way we can use a more general mutex rather than the specific
critical section used in cow_ptr. Also move some calls that access
the object directly to use the accessor methods that should prevent
access to the object while it is being copied.
Refs <a class="closed ticket" href="7677.html" title="defect: Reduction for several inelastic instruments hangs part way through ... (closed: fixed)">#7677</a>
(cherry picked from commit <a class="changeset" href="https://github.com/mantidproject/mantid/commit/de17341707935da61e5513f74e5dde9a7a93f9b7" title="de17341707935da61e5513f74e5dde9a7a93f9b7">de17341707935da61e5513f74e5dde9a7a93f9b7</a>)
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/e77151b599b161cbea47749af3d3888f4a831bfb" title="e77151b599b161cbea47749af3d3888f4a831bfb">e77151b599b161cbea47749af3d3888f4a831bfb</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-13">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:13" class="cnum">
      <a href="7677.html#comment:13">comment:13</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-13T12%3A01%3A57%2B01%3A00&amp;precision=second" title="2013-08-13T12:01:57+01:00 in Timeline">7 years</a> ago by Wenduo Zhou
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        set to <em>Wenduo Zhou</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-14">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:14" class="cnum">
      <a href="7677.html#comment:14">comment:14</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-14T15%3A42%3A43%2B01%3A00&amp;precision=second" title="2013-08-14T15:42:43+01:00 in Timeline">7 years</a> ago by Wenduo Zhou
                </h3>
                
    <div class="comment searchable">
      
      <p>
Both scripts worked.  The test is thus passed. 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-15">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:15" class="cnum">
      <a href="7677.html#comment:15">comment:15</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-08-14T15%3A42%3A56%2B01%3A00&amp;precision=second" title="2013-08-14T15:42:56+01:00 in Timeline">7 years</a> ago by Wenduo Zhou
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Merge remote-tracking branch 'origin/bugfix/7677_segfault_c2e'
</p>

    </div>

              </div>
              <div class="change" id="trac-change-16">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:16" class="cnum">
      <a href="7677.html#comment:16">comment:16</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T02%3A05%3A10%2B01%3A00&amp;precision=second" title="2015-06-04T02:05:10+01:00 in Timeline">5 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
This ticket has been transferred to github issue <a class="ext-link" href="http://github.com/mantidproject/mantid/issues/8522"><span class="icon">​</span>8522</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="../wiki/TracTickets.html">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/mantid/pygments/trac.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/7677?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/7677?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/7677?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.5</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>