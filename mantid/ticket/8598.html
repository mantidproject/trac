<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #8598 (Add algorithm to normalise compton scattering spectrum by hydrogen peak area)
     – Mantid Project
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="prev" href="8597.html" title="Ticket #8597" />
        <link rel="last" href="11888.html" title="Ticket #11888" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/8598?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/8598?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/8598?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="8599.html" title="Ticket #8599" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="1.html" title="Ticket #1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Mantid Project" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="a82fe30e7bef2e30fd2838e9";
    </script>
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="../chrome/common/js/resizer.js"></script><script type="text/javascript" src="../chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/mantid/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 8598, escape_newlines: 0}
        $("#comment").autoPreview("/mantid/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/mantid/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.mantidproject.org/"><img src="../chrome/site/mantid_logo_with_name.png" alt="Mantid Logo" width="250" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.mantidproject.org/mantid/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="8597.html" title="Ticket #8597">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="8599.html" title="Ticket #8599">Next Ticket</a> &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="8598.html">Ticket #8598</a>
          <span class="status">(closed: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-11T12%3A41%3A15Z&amp;precision=second" title="2013-12-11T12:41:15Z in Timeline">7 years</a> ago</p>
    <p>Last modified <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T02%3A43%3A22%2B01%3A00&amp;precision=second" title="2015-06-04T02:43:22+01:00 in Timeline">5 years</a> ago</p>
  </div>
  <h2 class="summary searchable">Add algorithm to normalise compton scattering spectrum by hydrogen peak area</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;reporter=Martyn+Gigg">Martyn Gigg</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;owner=Martyn+Gigg">Martyn Gigg</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;priority=critical">critical</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="../milestone/Release&#32;3.1.html">Release 3.1</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;component=Direct+Inelastic">Direct Inelastic</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby"><span></span></td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking"><span></span></td>
        <th id="h_tester">
          Tester:
        </th>
        <td headers="h_tester">
              Samuel Jackson
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
      <span class="lastmod" title="2013-12-16 09:49:18.345903+00:00">
        (last modified by Martyn Gigg)
        (<a href="https://trac.mantidproject.org/mantid/ticket/8598?action=diff&amp;version=2">diff</a>)
      </span>
    </h3>
    <div class="searchable">
      <p>
This will require two new algorithms:
</p>
<ol><li>ConvertToYSpace -
</li></ol><p>
The required conversion is defined by equation (7) in this paper:
<a class="ext-link" href="http://link.aip.org/link/doi/10.1063/1.3561493?ver=pdfcov"><span class="icon">​</span>http://link.aip.org/link/doi/10.1063/1.3561493?ver=pdfcov</a>. As the mass &amp; detector delay time are required to calculate Y we cannot simply add a new unit for ConvertUnits. The algorithm will have a single input, the mass and all other parameters: l1,l2,theta,efixed,t0 will be required to be attached to the workspace instrument. 
</p>
<ol start="2"><li>NormaliseByPeakArea - 
</li></ol><p>
This will use the above algorithm to convert the input TOF spectrum to yspace &amp; then Fit the peak defined by the input mass value. The input data will then be normalised by the fitted peak area value.
</p>

    </div>
  </div>
</div>
          
    <div id="attachments">
        <h2 class="foldable">Attachments</h2>
        <div>
          <dl class="attachments">
              <dt>
    <a href="../attachment/ticket/8598/HydrogenPeakFit.jpg.html" title="View attachment">HydrogenPeakFit.jpg</a><a href="../raw-attachment/ticket/8598/HydrogenPeakFit.jpg" class="trac-rawlink" title="Download">​</a>
       (<span title="1504911 bytes">1.4 MB</span>) -
      added by <em>Martyn Gigg</em> <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-08T11%3A20%3A09Z&amp;precision=second" title="2014-01-08T11:20:09Z in Timeline">7 years</a> ago.
  </dt>
          </dl>
          
        </div>
    </div>

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="8598.html#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-11T12%3A51%3A27Z&amp;precision=second" title="2013-12-11T12:51:27Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>inprogress</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="8598.html#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-16T09%3A49%3A18Z&amp;precision=second" title="2013-12-16T09:49:18Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Description</strong>
        modified (<a href="https://trac.mantidproject.org/mantid/ticket/8598?action=diff&amp;version=2">diff</a>)
    </li><li>
      <strong>Summary</strong>
        changed from <em>Add algorithm to convert X from TOF to compton scattering Y-space</em> to <em>Add algorithm to normalise compton scattering spectrum by hydrogen peak area</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="8598.html#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-17T16%3A45%3A52Z&amp;precision=second" title="2013-12-17T16:45:52Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Basic structure for ConvertToYSpace algorithm
</p>
<p>
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/f7b330be5b3b8d144a1e2f9d3e5df2576f179104" title="f7b330be5b3b8d144a1e2f9d3e5df2576f179104">f7b330be5b3b8d144a1e2f9d3e5df2576f179104</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="8598.html#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-17T16%3A45%3A52Z&amp;precision=second" title="2013-12-17T16:45:52Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Refactoring to avoid code duplication.
</p>
<ul><li>getComponentParameter is now only defined in ConvertToYSpace
</li><li>DetectorParams struct has moved to ConvertToYSpace
</li><li>Y calculation has moved to ConvertToYSpace
</li></ul><p>
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/06606cc87c57f610512cb29b61537f57ef9ebdd8" title="06606cc87c57f610512cb29b61537f57ef9ebdd8">06606cc87c57f610512cb29b61537f57ef9ebdd8</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="8598.html#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-17T16%3A45%3A52Z&amp;precision=second" title="2013-12-17T16:45:52Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Tidy up in ConvertToYSpace and implement exec test
</p>
<p>
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/4287d1f3f285c6796f16c4c357c205a1641d940f" title="4287d1f3f285c6796f16c4c357c205a1641d940f">4287d1f3f285c6796f16c4c357c205a1641d940f</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="8598.html#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-17T16%3A45%3A52Z&amp;precision=second" title="2013-12-17T16:45:52Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Set units on output workspace.
</p>
<p>
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/cc054f995a23a612b2c3f9dee2cd88c45846fee8" title="cc054f995a23a612b2c3f9dee2cd88c45846fee8">cc054f995a23a612b2c3f9dee2cd88c45846fee8</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="8598.html#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-17T16%3A45%3A52Z&amp;precision=second" title="2013-12-17T16:45:52Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Implement a profile function to fit a mass peak in Y-space.
</p>
<p>
Used in neutron compton scattering to Fit a spectrum using only the proton
peak.
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/6c9b13e71e5c8b07939990cdf4faec8c1a0ed67f" title="6c9b13e71e5c8b07939990cdf4faec8c1a0ed67f">6c9b13e71e5c8b07939990cdf4faec8c1a0ed67f</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="8598.html#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-17T16%3A45%3A53Z&amp;precision=second" title="2013-12-17T16:45:53Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Start of NormaliseByPeakArea algorithm
</p>
<p>
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/d3a554670c218be64ba0f002bcac2db40e9312e6" title="d3a554670c218be64ba0f002bcac2db40e9312e6">d3a554670c218be64ba0f002bcac2db40e9312e6</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="8598.html#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-17T16%3A45%3A53Z&amp;precision=second" title="2013-12-17T16:45:53Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Refactor test helper to allow multiple spectra.
</p>
<p>
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/0e5969b9890b5db3aa7721bd9d368bdafb8e1381" title="0e5969b9890b5db3aa7721bd9d368bdafb8e1381">0e5969b9890b5db3aa7721bd9d368bdafb8e1381</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="8598.html#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-17T16%3A45%3A53Z&amp;precision=second" title="2013-12-17T16:45:53Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Symmetrised output is correct for non-sum behaviour
</p>
<p>
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/343b03de957e2a3b5ee999ede90bced6b733d1e2" title="343b03de957e2a3b5ee999ede90bced6b733d1e2">343b03de957e2a3b5ee999ede90bced6b733d1e2</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-11">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:11" class="cnum">
      <a href="8598.html#comment:11">comment:11</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-17T16%3A45%3A53Z&amp;precision=second" title="2013-12-17T16:45:53Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Implement summing behaviour in NormaliseByPeakArea.
</p>
<p>
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/9eb98715068602cbe5a3cdb020a6c8d4288d47f3" title="9eb98715068602cbe5a3cdb020a6c8d4288d47f3">9eb98715068602cbe5a3cdb020a6c8d4288d47f3</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:12" class="cnum">
      <a href="8598.html#comment:12">comment:12</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-07T14%3A13%3A39Z&amp;precision=second" title="2014-01-07T14:13:39Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix default value of test helper create2DWorkspaceWithFullInstrument
</p>
<p>
Accidentally changed the behaviour that everyone else was expecting.
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/28d9a8859d736d23dc8da108243cb98d93930946" title="28d9a8859d736d23dc8da108243cb98d93930946">28d9a8859d736d23dc8da108243cb98d93930946</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-13">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:13" class="cnum">
      <a href="8598.html#comment:13">comment:13</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-07T15%3A05%3A01Z&amp;precision=second" title="2014-01-07T15:05:01Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix silly unit test mistake.
</p>
<p>
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8a0bfebef6515ca81f682e855a29cc718467db19" title="8a0bfebef6515ca81f682e855a29cc718467db19">8a0bfebef6515ca81f682e855a29cc718467db19</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-14">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:14" class="cnum">
      <a href="8598.html#comment:14">comment:14</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-08T10%3A30%3A19Z&amp;precision=second" title="2014-01-08T10:30:19Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix system VesuvioFitting tests.
</p>
<p>
Converting the TOF from seconds to microseconds and then back seems
to have caused instability in the fitting when including the background.
It is actually more sensible to have convertToYSpace take the time in
seconds anyway.
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/ba48d4c771b60c7ce6d7289d5b7a39c6c0c5ee78" title="ba48d4c771b60c7ce6d7289d5b7a39c6c0c5ee78">ba48d4c771b60c7ce6d7289d5b7a39c6c0c5ee78</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-15">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:15" class="cnum">
      <a href="8598.html#comment:15">comment:15</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-08T11%3A19%3A48Z&amp;precision=second" title="2014-01-08T11:19:48Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Branch: feature/8598_convert_to_yspace
</p>
<p>
Tester: 
First check that the system tests are passing. 
</p>
<p>
The required data for the tests is on the ISIS archive in EVS cycle 09_1 &amp; the IP file is attached to <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>.
</p>
<pre class="wiki">from mantid.simpleapi import *

LoadVesuvio(Filename='14188-14195',OutputWorkspace='test_nosum',
            SpectrumList='135-142',Mode='SingleDifference',
            InstrumentParFile=r'IP0004_10.par')
CropWorkspace(InputWorkspace='test_nosum',OutputWorkspace='test_nosum',
              XMin='50',XMax='562')
NormaliseByPeakArea(InputWorkspace='test_nosum',Mass='1.0079',Sum=False,
                    OutputWorkspace='norm', YSpaceDataWorkspace='yspace',
                    FittedWorkspace='fitted',SymmetrisedWorkspace='sym')
</pre><p>
Run the following script. It should produce 4 workspaces:
</p>
<ul><li><tt>yspace</tt>, <tt>fitted</tt> and <tt>sym</tt> should all be in units of A<sup>-1</sup>
</li><li><tt>norm</tt> should be in units of tof
</li></ul><p>
Plot spectrum 135 from <tt>yspace</tt>, <tt>fitted</tt> &amp; <tt>sym</tt> on 1 plot. It should look like the attached image from the VMS manual with the exception that there is an additional peak between approx [-27,-24]A<sup>-1</sup> that we chose not to exclude here.
</p>
<p>
Now plot spectrum 135 on both test_no_sum &amp; norm. You should find that the <tt>norm</tt> workspace has the same features as <tt>test_nosum</tt> and <tt>test_nosum</tt> ~ 60.177*<tt>norm</tt> (to within expected precision)
</p>

    </div>

              </div>
              <div class="change">
                <h3 class="change">
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-08T11%3A20%3A09Z&amp;precision=second" title="2014-01-08T11:20:09Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Attachment</strong>
        <a href="../attachment/ticket/8598/HydrogenPeakFit.jpg.html"><em>HydrogenPeakFit.jpg</em></a><a href="../raw-attachment/ticket/8598/HydrogenPeakFit.jpg" title="Download" class="trac-rawlink">​</a>
          added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-16">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:16" class="cnum">
      <a href="8598.html#comment:16">comment:16</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-08T17%3A16%3A36Z&amp;precision=second" title="2014-01-08T17:16:36Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-17">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:17" class="cnum">
      <a href="8598.html#comment:17">comment:17</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-09T08%3A04%3A55Z&amp;precision=second" title="2014-01-09T08:04:55Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix cppcheck scope error.
</p>
<p>
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/16710a8cdceb9b5bc30b274110564500f690f937" title="16710a8cdceb9b5bc30b274110564500f690f937">16710a8cdceb9b5bc30b274110564500f690f937</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-18">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:18" class="cnum">
      <a href="8598.html#comment:18">comment:18</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-09T08%3A11%3A35Z&amp;precision=second" title="2014-01-09T08:11:35Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix doxygen warning.
</p>
<p>
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/3a534b82c2899d15f8ab8c7156901185683b9a35" title="3a534b82c2899d15f8ab8c7156901185683b9a35">3a534b82c2899d15f8ab8c7156901185683b9a35</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-19">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:19" class="cnum">
      <a href="8598.html#comment:19">comment:19</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-09T08%3A20%3A03Z&amp;precision=second" title="2014-01-09T08:20:03Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Put back accidentally removed variable.
</p>
<p>
Refs <a class="closed ticket" href="8598.html" title="enhancement: Add algorithm to normalise compton scattering spectrum by hydrogen peak ... (closed: fixed)">#8598</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/d43bfcb8fcb4036afd77b59c7787c795ea26d93d" title="d43bfcb8fcb4036afd77b59c7787c795ea26d93d">d43bfcb8fcb4036afd77b59c7787c795ea26d93d</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-20">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:20" class="cnum">
      <a href="8598.html#comment:20">comment:20</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-17T14%3A20%3A56Z&amp;precision=second" title="2014-01-17T14:20:56Z in Timeline">7 years</a> ago by Samuel Jackson
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        set to <em>Samuel Jackson</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-21">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:21" class="cnum">
      <a href="8598.html#comment:21">comment:21</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-17T15%3A12%3A53Z&amp;precision=second" title="2014-01-17T15:12:53Z in Timeline">7 years</a> ago by Samuel Jackson
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Merge remote-tracking branch 'origin/feature/8598_convert_to_yspace'
</p>
<p>
Full changeset: <a class="ext-link" href="https://github.com/mantidproject/mantid/commit/5cfc6fbd16d17cc500df15b2039be3607b4010e8"><span class="icon">​</span>5cfc6fbd16d17cc500df15b2039be3607b4010e8</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-22">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:22" class="cnum">
      <a href="8598.html#comment:22">comment:22</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-17T15%3A30%3A44Z&amp;precision=second" title="2014-01-17T15:30:44Z in Timeline">7 years</a> ago by Samuel Jackson
                </h3>
                
    <div class="comment searchable">
      
      <p>
Checked that everything mentioned in the testing description appears to work as expected. Plots match as in description. Checked that input workspace is approx. 60.177*norm. System tests are passing and code review looks good.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-23">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:23" class="cnum">
      <a href="8598.html#comment:23">comment:23</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T02%3A43%3A22%2B01%3A00&amp;precision=second" title="2015-06-04T02:43:22+01:00 in Timeline">5 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
This ticket has been transferred to github issue <a class="ext-link" href="http://github.com/mantidproject/mantid/issues/9442"><span class="icon">​</span>9442</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="../wiki/TracTickets.html">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/8598?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/8598?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/8598?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.5</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>