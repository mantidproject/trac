<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #8378 (Implement gamma correction for vesuvio)
     – Mantid Project
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="prev" href="8377.html" title="Ticket #8377" />
        <link rel="last" href="11888.html" title="Ticket #11888" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/8378?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/8378?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/8378?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="8379.html" title="Ticket #8379" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="1.html" title="Ticket #1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Mantid Project" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="a82fe30e7bef2e30fd2838e9";
    </script>
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="../chrome/common/js/resizer.js"></script><script type="text/javascript" src="../chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/mantid/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 8378, escape_newlines: 0}
        $("#comment").autoPreview("/mantid/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/mantid/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.mantidproject.org/"><img src="../chrome/site/mantid_logo_with_name.png" alt="Mantid Logo" width="250" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.mantidproject.org/mantid/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="8377.html" title="Ticket #8377">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="8379.html" title="Ticket #8379">Next Ticket</a> &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="8378.html">Ticket #8378</a>
          <span class="status">(closed: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-11-06T11%3A42%3A03Z&amp;precision=second" title="2013-11-06T11:42:03Z in Timeline">7 years</a> ago</p>
    <p>Last modified <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T02%3A34%3A17%2B01%3A00&amp;precision=second" title="2015-06-04T02:34:17+01:00 in Timeline">5 years</a> ago</p>
  </div>
  <h2 class="summary searchable">Implement gamma correction for vesuvio</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;reporter=Martyn+Gigg">Martyn Gigg</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;owner=Martyn+Gigg">Martyn Gigg</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;priority=blocker">blocker</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="../milestone/Release&#32;3.1.html">Release 3.1</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;component=Indirect+Inelastic">Indirect Inelastic</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby"><span></span></td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking"><span></span></td>
        <th id="h_tester">
          Tester:
        </th>
        <td headers="h_tester">
              Roman Tolchenov
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
      <span class="lastmod" title="2013-12-09 11:08:04.343291+00:00">
        (last modified by Martyn Gigg)
        (<a href="https://trac.mantidproject.org/mantid/ticket/8378?action=diff&amp;version=18">diff</a>)
      </span>
    </h3>
    <div class="searchable">
      <p>
Andrew Seel has sent the fortran code for the current gamma correction on VMS. We need to include this within Mantid.
</p>
<p>
The attached image shows the results from the VMS manual.
</p>

    </div>
  </div>
</div>
          
    <div id="attachments">
        <h2 class="foldable">Attachments</h2>
        <div>
          <dl class="attachments">
              <dt>
    <a href="../attachment/ticket/8378/IMG_20131209_111244.jpg.html" title="View attachment">IMG_20131209_111244.jpg</a><a href="../raw-attachment/ticket/8378/IMG_20131209_111244.jpg" class="trac-rawlink" title="Download">​</a>
       (<span title="3001791 bytes">2.9 MB</span>) -
      added by <em>Martyn Gigg</em> <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-09T11%3A07%3A26Z&amp;precision=second" title="2013-12-09T11:07:26Z in Timeline">7 years</a> ago.
  </dt>
              <dt>
    <a href="../attachment/ticket/8378/IP0004_10.par.html" title="View attachment">IP0004_10.par</a><a href="../raw-attachment/ticket/8378/IP0004_10.par" class="trac-rawlink" title="Download">​</a>
       (<span title="7325 bytes">7.2 KB</span>) -
      added by <em>Martyn Gigg</em> <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-09T11%3A09%3A26Z&amp;precision=second" title="2013-12-09T11:09:26Z in Timeline">7 years</a> ago.
  </dt>
          </dl>
          
        </div>
    </div>

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="8378.html#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-11-07T16%3A10%3A05Z&amp;precision=second" title="2013-11-07T16:10:05Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Summary</strong>
        changed from <em>Implement gaama correction for vesuvio</em> to <em>Implement gamma correction for vesuvio</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="8378.html#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T09%3A35%3A43Z&amp;precision=second" title="2013-12-06T09:35:43Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>inprogress</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="8378.html#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A24Z&amp;precision=second" title="2013-12-06T12:44:24Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Add foil &amp; foil-changer positions to Vesuvio IDF.
</p>
<p>
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/125d559f02e864cb1edf603e3648e079c4d49c03" title="125d559f02e864cb1edf603e3648e079c4d49c03">125d559f02e864cb1edf603e3648e079c4d49c03</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="8378.html#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A24Z&amp;precision=second" title="2013-12-06T12:44:24Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Rename VESUVIO analyser parameters to make way for foil parameters.
</p>
<p>
There are foil parameters that will require similar names so they have
been made more explicit.
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/68b834993da79d891cf538a4bcdc6b8097576b80" title="68b834993da79d891cf538a4bcdc6b8097576b80">68b834993da79d891cf538a4bcdc6b8097576b80</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="8378.html#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A24Z&amp;precision=second" title="2013-12-06T12:44:24Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Add resolution parameters for the foil components.
</p>
<p>
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/7dfd416920aeb81b0988b0dcad45656cd863ac68" title="7dfd416920aeb81b0988b0dcad45656cd863ac68">7dfd416920aeb81b0988b0dcad45656cd863ac68</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="8378.html#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A24Z&amp;precision=second" title="2013-12-06T12:44:24Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Skeleton algorithm &amp; test.
</p>
<p>
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/0b5f5561908cfd44358cb6f7f5a33223e52fdb3c" title="0b5f5561908cfd44358cb6f7f5a33223e52fdb3c">0b5f5561908cfd44358cb6f7f5a33223e52fdb3c</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="8378.html#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A25Z&amp;precision=second" title="2013-12-06T12:44:25Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Have separate names in Vesuvio definition for foils in position 0 &amp; 1.
</p>
<p>
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/5a4e7e52d8495f716a86f703b6ef42b21e246ee1" title="5a4e7e52d8495f716a86f703b6ef42b21e246ee1">5a4e7e52d8495f716a86f703b6ef42b21e246ee1</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="8378.html#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A25Z&amp;precision=second" title="2013-12-06T12:44:25Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Add/rename some helper methods in ComptonProfileTestHelpers.
</p>
<p>
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8e62e0cbfc68827e50cc9be080fdd6587bf1eb82" title="8e62e0cbfc68827e50cc9be080fdd6587bf1eb82">8e62e0cbfc68827e50cc9be080fdd6587bf1eb82</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="8378.html#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A25Z&amp;precision=second" title="2013-12-06T12:44:25Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix VESUVIO foil shape/location definitions.
</p>
<p>
The shapes are slightly more accurate to improve theta calculation.
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/3af0c0cc7d4d72746d48791157bfeeacaa833c39" title="3af0c0cc7d4d72746d48791157bfeeacaa833c39">3af0c0cc7d4d72746d48791157bfeeacaa833c39</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="8378.html#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A25Z&amp;precision=second" title="2013-12-06T12:44:25Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Algorithm now caches required instrument geometry.
</p>
<p>
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/f39772071928b3ac5a0f2a46a8a2d63cc9593cd4" title="f39772071928b3ac5a0f2a46a8a2d63cc9593cd4">f39772071928b3ac5a0f2a46a8a2d63cc9593cd4</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-11">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:11" class="cnum">
      <a href="8378.html#comment:11">comment:11</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A25Z&amp;precision=second" title="2013-12-06T12:44:25Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Convert CalculateGammaBackground to use input function.
</p>
<p>
This will allow it to use the same function types that has been set during
the fitting procedure and does not then hard-code the mass profiles that
will be used to calculate the spectrum.
VESUVIO parameters have been tidied up and the foil-specific ones added.
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/6e6f7e1732cfbcf785fdeead97c2e356f0b872cd" title="6e6f7e1732cfbcf785fdeead97c2e356f0b872cd">6e6f7e1732cfbcf785fdeead97c2e356f0b872cd</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:12" class="cnum">
      <a href="8378.html#comment:12">comment:12</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A25Z&amp;precision=second" title="2013-12-06T12:44:25Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix foil position definitions so that they sit at phi=0
</p>
<p>
The foil-changer also has been changed to switch the radius with the height.
This now gives the correct integration range for CalculateGammaBackground
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/cca181b5ffc08425809ea3467a46b9e6258ee6b1" title="cca181b5ffc08425809ea3467a46b9e6258ee6b1">cca181b5ffc08425809ea3467a46b9e6258ee6b1</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-13">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:13" class="cnum">
      <a href="8378.html#comment:13">comment:13</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A25Z&amp;precision=second" title="2013-12-06T12:44:25Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix the theta/phi angles for the forward scattering detectors.
</p>
<p>
They all had the incorrect sign as the VMS detpos.dat file says that they
all belong in the mirror positions to each other. The absolute scattering
angle remains the same so the original fitting is unaffected. It does,
however, affect the gamma background calculation as this relies on knowing
the distance between a given foil &amp; detector.
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/4c8c3b51fe39f89df419028b34a8113a4386f170" title="4c8c3b51fe39f89df419028b34a8113a4386f170">4c8c3b51fe39f89df419028b34a8113a4386f170</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-14">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:14" class="cnum">
      <a href="8378.html#comment:14">comment:14</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A26Z&amp;precision=second" title="2013-12-06T12:44:26Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix spectrum Y values that do not fall in forward scattering range.
</p>
<p>
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/d2e7e1e2bc4216d881614a88b6c6be960423f3f5" title="d2e7e1e2bc4216d881614a88b6c6be960423f3f5">d2e7e1e2bc4216d881614a88b6c6be960423f3f5</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-15">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:15" class="cnum">
      <a href="8378.html#comment:15">comment:15</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-06T12%3A44%3A26Z&amp;precision=second" title="2013-12-06T12:44:26Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix ComptonProfile attribute storage.
</p>
<p>
If the base class method is not called then the IFunction::asString method
does not work as expected.
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/4095a83f5da06ae23e660a89d033224a433a66ac" title="4095a83f5da06ae23e660a89d033224a433a66ac">4095a83f5da06ae23e660a89d033224a433a66ac</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-16">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:16" class="cnum">
      <a href="8378.html#comment:16">comment:16</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-09T09%3A52%3A01Z&amp;precision=second" title="2013-12-09T09:52:01Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Refactor tests to use the same helper function.
</p>
<p>
This eliminates a function that was not used in some cpp files and could
cause a compiler warning.
Refs <a class="closed ticket" href="8378.html" title="enhancement: Implement gamma correction for vesuvio (closed: fixed)">#8378</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/4da04053c1ac735b54c7a9e6cdc3f1429aa22d42" title="4da04053c1ac735b54c7a9e6cdc3f1429aa22d42">4da04053c1ac735b54c7a9e6cdc3f1429aa22d42</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-17">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:17" class="cnum">
      <a href="8378.html#comment:17">comment:17</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-09T10%3A56%3A41Z&amp;precision=second" title="2013-12-09T10:56:41Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Description</strong>
        modified (<a href="https://trac.mantidproject.org/mantid/ticket/8378?action=diff&amp;version=17">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change">
                <h3 class="change">
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-09T11%3A07%3A26Z&amp;precision=second" title="2013-12-09T11:07:26Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Attachment</strong>
        <a href="../attachment/ticket/8378/IMG_20131209_111244.jpg.html"><em>IMG_20131209_111244.jpg</em></a><a href="../raw-attachment/ticket/8378/IMG_20131209_111244.jpg" title="Download" class="trac-rawlink">​</a>
          added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-18">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:18" class="cnum">
      <a href="8378.html#comment:18">comment:18</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-09T11%3A08%3A04Z&amp;precision=second" title="2013-12-09T11:08:04Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Description</strong>
        modified (<a href="https://trac.mantidproject.org/mantid/ticket/8378?action=diff&amp;version=18">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change">
                <h3 class="change">
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-09T11%3A09%3A26Z&amp;precision=second" title="2013-12-09T11:09:26Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Attachment</strong>
        <a href="../attachment/ticket/8378/IP0004_10.par.html"><em>IP0004_10.par</em></a><a href="../raw-attachment/ticket/8378/IP0004_10.par" title="Download" class="trac-rawlink">​</a>
          added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-19">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:19" class="cnum">
      <a href="8378.html#comment:19">comment:19</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-09T11%3A13%3A47Z&amp;precision=second" title="2013-12-09T11:13:47Z in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Branch: feature/8378_gamma_correction
</p>
<p>
Tester: The required files are EVS14188-14195 on the ISIS archive along with the attached IP file. Download the IP file &amp; tick archive searching in the manage user directories and this should fine the required files. The script is a stripped down version of what would be used by the users. The Fit-like function string will usually be created by a separate method using the results from an earlier Fit.
</p>
<p>
Here the results of plotting the final 3 workspaces together should reproduce the attached image from the VMS manual. As usual ultimate acceptance will have to  be provided by the instrument scientists but this should at least give a very good start.
</p>
<div class="code"><pre><span class="kn">from</span> <span class="nn">mantid.simpleapi</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c">#</span>
<span class="c"># Load</span>
<span class="c"># </span>
runs <span class="o">=</span> <span class="s">"14188-14195"</span>
spectra <span class="o">=</span> <span class="s">"135-142"</span>
diff_type<span class="o">=</span><span class="s">"SingleDifference"</span> <span class="c"># Allowed values=Single,Double,Thick</span>
ip_file <span class="o">=</span> <span class="s">"IP0004_10.par"</span>

raw_ws <span class="o">=</span> LoadVesuvio<span class="p">(</span>Filename<span class="o">=</span>runs<span class="p">,</span> SpectrumList<span class="o">=</span>spectra<span class="p">,</span>
                     Mode<span class="o">=</span>diff_type<span class="p">,</span>InstrumentParFile<span class="o">=</span>ip_file<span class="p">)</span>
raw_ws <span class="o">=</span> CropWorkspace<span class="p">(</span>raw_ws<span class="p">,</span>XMin<span class="o">=</span><span class="mf">50.0</span><span class="p">,</span>XMax<span class="o">=</span><span class="mf">562.0</span><span class="p">)</span>


<span class="c">#</span>
<span class="c"># Correct - Usually this string would come out of being constructed from Fit</span>
<span class="c">#</span>
mass1_str <span class="o">=</span> <span class="s">"name=GramCharlierComptonProfile,WorkspaceIndex=0,Mass=1.007900,HermiteCoeffs=1 0 0,Width=4.226288,FSECoeff=0.498073,C_0=57.941101"</span>
mass2_str <span class="o">=</span> <span class="s">"name=GaussianComptonProfile,WorkspaceIndex=0,Mass=27.000000,Width=13.000000,Intensity=1.626268"</span>
mass3_str <span class="o">=</span> <span class="s">"name=GaussianComptonProfile,WorkspaceIndex=0,Mass=91.200000,Width=26.000000,Intensity=2.977515"</span>
func_str <span class="o">=</span> <span class="s">"</span><span class="si">%s</span><span class="s">;</span><span class="si">%s</span><span class="s">;</span><span class="si">%s</span><span class="s">"</span> <span class="o">%</span><span class="p">(</span>mass1_str<span class="p">,</span>mass2_str<span class="p">,</span>mass3_str<span class="p">)</span>

background<span class="p">,</span>corrected <span class="o">=</span> CalculateGammaBackground<span class="p">(</span>InputWorkspace<span class="o">=</span>raw_ws<span class="p">,</span> ComptonFunction<span class="o">=</span>func_str<span class="p">)</span>

raw_ws <span class="o">=</span> SumSpectra<span class="p">(</span>InputWorkspace<span class="o">=</span>raw_ws<span class="p">)</span>
background <span class="o">=</span> SumSpectra<span class="p">(</span>InputWorkspace<span class="o">=</span>background<span class="p">)</span>
corrected <span class="o">=</span> SumSpectra<span class="p">(</span>InputWorkspace<span class="o">=</span>corrected<span class="p">)</span>
</pre></div>
    </div>

              </div>
              <div class="change" id="trac-change-20">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:20" class="cnum">
      <a href="8378.html#comment:20">comment:20</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-09T11%3A23%3A34Z&amp;precision=second" title="2013-12-09T11:23:34Z in Timeline">7 years</a> ago by Roman Tolchenov
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        set to <em>Roman Tolchenov</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-21">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:21" class="cnum">
      <a href="8378.html#comment:21">comment:21</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-12-09T11%3A44%3A10Z&amp;precision=second" title="2013-12-09T11:44:10Z in Timeline">7 years</a> ago by Roman Tolchenov
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Merge remote-tracking branch 'origin/feature/8378_gamma_correction'
</p>
<p>
Full changeset: <a class="ext-link" href="https://github.com/mantidproject/mantid/commit/763efca88d62a873a55fbf7285b4cb0a0c5d3ca4"><span class="icon">​</span>763efca88d62a873a55fbf7285b4cb0a0c5d3ca4</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-22">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:22" class="cnum">
      <a href="8378.html#comment:22">comment:22</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-01-31T13%3A48%3A11Z&amp;precision=second" title="2014-01-31T13:48:11Z in Timeline">7 years</a> ago by Nick Draper
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Component</strong>
        changed from <em>Framework</em> to <em>Indirect Inelastic</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-23">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:23" class="cnum">
      <a href="8378.html#comment:23">comment:23</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T02%3A34%3A17%2B01%3A00&amp;precision=second" title="2015-06-04T02:34:17+01:00 in Timeline">5 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
This ticket has been transferred to github issue <a class="ext-link" href="http://github.com/mantidproject/mantid/issues/9223"><span class="icon">​</span>9223</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="../wiki/TracTickets.html">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/mantid/pygments/trac.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/8378?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/8378?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/8378?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.5</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>