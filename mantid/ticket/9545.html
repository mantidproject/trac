<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #9545 (Add setting of internal monitor workspace to LoadEventNexus)
     – Mantid Project
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="prev" href="9544.html" title="Ticket #9544" />
        <link rel="last" href="11888.html" title="Ticket #11888" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/9545?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/9545?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/9545?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="9546.html" title="Ticket #9546" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="1.html" title="Ticket #1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Mantid Project" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="a82fe30e7bef2e30fd2838e9";
    </script>
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="../chrome/common/js/resizer.js"></script><script type="text/javascript" src="../chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/mantid/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 9545, escape_newlines: 0}
        $("#comment").autoPreview("/mantid/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/mantid/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.mantidproject.org/"><img src="../chrome/site/mantid_logo_with_name.png" alt="Mantid Logo" width="250" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.mantidproject.org/mantid/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="9544.html" title="Ticket #9544">Previous Ticket</a></span></li><li><span><a class="next" href="9546.html" title="Ticket #9546">Next Ticket</a> &rarr;</span></li><li class="last"><a href="../depgraph/9545.html">Depgraph</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="9545.html">Ticket #9545</a>
          <span class="status">(closed: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-29T19%3A02%3A29%2B01%3A00&amp;precision=second" title="2014-05-29T19:02:29+01:00 in Timeline">6 years</a> ago</p>
    <p>Last modified <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T03%3A22%3A43%2B01%3A00&amp;precision=second" title="2015-06-04T03:22:43+01:00 in Timeline">5 years</a> ago</p>
  </div>
  <h2 class="summary searchable">Add setting of internal monitor workspace to LoadEventNexus</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;reporter=Russell+Taylor">Russell Taylor</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;owner=Russell+Taylor">Russell Taylor</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;priority=minor">minor</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="../milestone/Release&#32;3.2.html">Release 3.2</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;component=Framework">Framework</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby"><span><a class="closed ticket" href="9541.html" title="Add the capability of holding a workspace of monitor data within another workspace">#9541</a></span></td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking"><span><a class="closed ticket" href="9540.html" title="Add full event monitor data to the live data processing capabilities at the SNS.">#9540</a></span></td>
        <th id="h_tester">
          Tester:
        </th>
        <td headers="h_tester">
              Michael Wedel
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
...and possibly other loaders.
</p>
<p>
This is just setting the new internal pointer to the same workspace that will be added to the ADS with the "_monitors" suffix. It gives people the option of doing things either in the new or old way and hopefully might lead people to prefer the better 'new' way.
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="9545.html#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-29T19%3A02%3A40%2B01%3A00&amp;precision=second" title="2014-05-29T19:02:40+01:00 in Timeline">6 years</a> ago by Russell Taylor
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>assigned</em>
    </li><li>
      <strong>Blocked By</strong>
        <em>9541</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="9545.html#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-29T19%3A05%3A36%2B01%3A00&amp;precision=second" title="2014-05-29T19:05:36+01:00 in Timeline">6 years</a> ago by Russell Taylor
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>9540</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="9545.html#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-09T22%3A14%3A53%2B01%3A00&amp;precision=second" title="2014-06-09T22:14:53+01:00 in Timeline">6 years</a> ago by Russell Taylor
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>assigned</em> to <em>inprogress</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="9545.html" title="enhancement: Add setting of internal monitor workspace to LoadEventNexus (closed: fixed)">#9545</a>. Set internal monitor workspace pointer.
</p>
<p>
This is in addition to the existing ways of adding the workspace
separately to the ADS with a "_monitors" suffix and returning
it as an output property. This will allow the new way to be used going
forward without breaking the old way.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/22401766e1c578f1c120919a02e4d1f01c172e5f" title="22401766e1c578f1c120919a02e4d1f01c172e5f">22401766e1c578f1c120919a02e4d1f01c172e5f</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="9545.html#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-10T16%3A43%3A12%2B01%3A00&amp;precision=second" title="2014-06-10T16:43:12+01:00 in Timeline">6 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="9545.html" title="enhancement: Add setting of internal monitor workspace to LoadEventNexus (closed: fixed)">#9545</a>. Add setting of the monitor workspace pointer.
</p>
<p>
This is in addition to the existing way of an additional ADS entry with
"_monitors" suffix. It allows clients to use ExtractMonitorWorkspace on
the main output workspace and not need to worry about the name of the
workspace (it will work if LoadPreNexus was run as a subalgorithm, which
is not the case for old way).
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/4988ec885f07c4ec9eb927fd8ba08916dfbd64f0" title="4988ec885f07c4ec9eb927fd8ba08916dfbd64f0">4988ec885f07c4ec9eb927fd8ba08916dfbd64f0</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="9545.html#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-10T19%3A11%3A08%2B01%3A00&amp;precision=second" title="2014-06-10T19:11:08+01:00 in Timeline">6 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="9545.html" title="enhancement: Add setting of internal monitor workspace to LoadEventNexus (closed: fixed)">#9545</a>. Doxygen fix.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/6de53295998d17c562f1c032ea3b07128c59d7f5" title="6de53295998d17c562f1c032ea3b07128c59d7f5">6de53295998d17c562f1c032ea3b07128c59d7f5</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="9545.html#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-10T20%3A34%3A07%2B01%3A00&amp;precision=second" title="2014-06-10T20:34:07+01:00 in Timeline">6 years</a> ago by Russell Taylor
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
The three algorithms that currently load monitors into a "_monitors" ADS entry are LoadEventNexus, LoadPreNexus &amp; LoadRaw. I've added the internal pointer for the first two. I'm not going to do LoadRaw because the logic in that algorithm is just too convoluted for me to easily put it in.
</p>
<p>
<strong>To test</strong>: Load a file using LoadEventNexus or LoadPreNexus. Make sure that LoadMonitors is checked. Run ExtractMonitorWorkspace on the main (not the "_monitors") output workspace and observe that (a) it succeeds, and (b) the workspace is the same as the "_monitors" one.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="9545.html#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-13T15%3A05%3A10%2B01%3A00&amp;precision=second" title="2014-06-13T15:05:10+01:00 in Timeline">6 years</a> ago by Michael Wedel
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        set to <em>Michael Wedel</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="9545.html#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-13T16%3A08%3A01%2B01%3A00&amp;precision=second" title="2014-06-13T16:08:01+01:00 in Timeline">6 years</a> ago by Michael Wedel
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
I tested this with the following small script, using data from systemtests:
</p>
<pre class="wiki">import numpy as np

data_7860, data_7860_monitors = LoadEventNexus(Filename='CNCS_7860_event.nxs',LoadMonitors='1')

monitors = ExtractMonitorWorkspace(data_7860)

assert(monitors.getNumberHistograms() == data_7860_monitors.getNumberHistograms())

for i in range(1, data_7860_monitors.getNumberHistograms()):
   yMonitorLoad = data_7860_monitors.readY(i)
   yMonitorExtract = monitors.readY(i)
	
   assert(np.array_equal(yMonitorLoad, yMonitorExtract))

</pre><p>
It works as described, the arrays are identical. Executing the loading and extracting through the GUI dialogs also worked, I checked instrument and logs of the workspaces.
</p>

    </div>

                <div class="trac-lastedit ">
                  Last edited <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-13T16%3A11%3A17%2B01%3A00&amp;precision=second" title="2014-06-13T16:11:17+01:00 in Timeline">6 years</a> ago
                      by Michael Wedel
                    (<a href="https://trac.mantidproject.org/mantid/ticket/9545?cversion=0&amp;cnum_hist=8#comment:8">previous</a>)
                    (<a href="https://trac.mantidproject.org/mantid/ticket/9545?action=comment-diff&amp;cnum=8&amp;version=1">diff</a>)
                </div>
              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="9545.html#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-13T16%3A08%3A29%2B01%3A00&amp;precision=second" title="2014-06-13T16:08:29+01:00 in Timeline">6 years</a> ago by Michael Wedel
                </h3>
                
    <div class="comment searchable">
      
      <p>
Merge remote-tracking branch 'origin/feature/9545_loadeventnexus_add_internal_monitor'
</p>
<p>
Full changeset: <a class="ext-link" href="https://github.com/mantidproject/mantid/commit/106853ecc28b1e5de826a4f762b48687c3aa3116"><span class="icon">​</span>106853ecc28b1e5de826a4f762b48687c3aa3116</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="9545.html#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T03%3A22%3A43%2B01%3A00&amp;precision=second" title="2015-06-04T03:22:43+01:00 in Timeline">5 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
This ticket has been transferred to github issue <a class="ext-link" href="http://github.com/mantidproject/mantid/issues/10388"><span class="icon">​</span>10388</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="../wiki/TracTickets.html">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/9545?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/9545?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/9545?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.5</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>