<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #6198 (Mapping functions: Return bare pointer -&gt; shared pointer)
     â€“ Mantid Project
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="prev" href="6197.html" title="Ticket #6197" />
        <link rel="last" href="11888.html" title="Ticket #11888" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/6198?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/6198?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/6198?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="6199.html" title="Ticket #6199" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="1.html" title="Ticket #1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Mantid Project" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="a82fe30e7bef2e30fd2838e9";
    </script>
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="../chrome/common/js/resizer.js"></script><script type="text/javascript" src="../chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/mantid/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 6198, escape_newlines: 0}
        $("#comment").autoPreview("/mantid/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/mantid/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.mantidproject.org/"><img src="../chrome/site/mantid_logo_with_name.png" alt="Mantid Logo" width="250" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.mantidproject.org/mantid/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="6197.html" title="Ticket #6197">Previous Ticket</a></span></li><li><span><a class="next" href="6199.html" title="Ticket #6199">Next Ticket</a> &rarr;</span></li><li class="last"><a href="../depgraph/6198.html">Depgraph</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="6198.html">Ticket #6198</a>
          <span class="status">(closed: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2012-11-19T13%3A07%3A59Z&amp;precision=second" title="2012-11-19T13:07:59Z in Timeline">8 years</a> ago</p>
    <p>Last modified <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T01%3A03%3A57%2B01%3A00&amp;precision=second" title="2015-06-04T01:03:57+01:00 in Timeline">5 years</a> ago</p>
  </div>
  <h2 class="summary searchable">Mapping functions: Return bare pointer -&gt; shared pointer</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;reporter=Nick+Draper">Nick Draper</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;owner=Russell+Taylor">Russell Taylor</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;priority=critical">critical</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="../milestone/Release&#32;3.0.html">Release 3.0</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;component=Framework">Framework</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;keywords=~Maintenance">Maintenance</a>
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby"><span><a class="closed ticket" href="6191.html" title="Remove SpDetMap + replace with Ispectrum">#6191</a></span></td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking"><span></span></td>
        <th id="h_tester">
          Tester:
        </th>
        <td headers="h_tester">
              Roman Tolchenov
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
We should replace with shared pointers throughout
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="6198.html#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2012-11-22T16%3A32%3A23Z&amp;precision=second" title="2012-11-22T16:32:23Z in Timeline">8 years</a> ago by Nick Draper
                </h3>
                
    <div class="comment searchable">
      
      <p>
These are the methods that I think Stuart added to create vectors of detector_id given workspaces indexes and the other similar methods.
</p>
<p>
There was some concern that they returned bare pointers and that the responsibility of deleting the object fell to the calling method.  The developers at the dev meeting agreed that this should be altered to return shared pointers to reduce the liklihood of memory leaks.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="6198.html#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2012-11-27T19%3A38%3A55Z&amp;precision=second" title="2012-11-27T19:38:55Z in Timeline">8 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
I don't remember adding anything - can you be more specific to where in the code to look?
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="6198.html#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-02-01T15%3A39%3A44Z&amp;precision=second" title="2013-02-01T15:39:44Z in Timeline">8 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
The methods mentioned in duplicate ticket <a class="closed ticket" href="6481.html" title="defect: Use shared_ptrs in MatrixWorkspace get mapping functions (closed: duplicate)">#6481</a> are (in MatrixWorkspace):
</p>
<pre class="wiki">index2spec_map * getWorkspaceIndexToSpectrumMap() const;
spec2index_map * getSpectrumToWorkspaceIndexMap() const;
index2detid_map * getWorkspaceIndexToDetectorIDMap() const;
detid2index_map * getDetectorIDToWorkspaceIndexMap( bool throwIfMultipleDets ) const;
</pre><p>
As I said over there the first two will go away under <a class="closed ticket" href="6191.html" title="enhancement: Remove SpDetMap + replace with Ispectrum (closed: fixed)">#6191</a>.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="6198.html#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-02-12T14%3A42%3A25Z&amp;precision=second" title="2013-02-12T14:42:25Z in Timeline">8 years</a> ago by Nick Draper
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Priority</strong>
        changed from <em>critical</em> to <em>blocker</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="6198.html#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-02-12T15%3A20%3A24Z&amp;precision=second" title="2013-02-12T15:20:24Z in Timeline">8 years</a> ago by Russell Taylor
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocked By</strong>
        <em>6191</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Suggest waiting for <a class="closed ticket" href="6191.html" title="enhancement: Remove SpDetMap + replace with Ispectrum (closed: fixed)">#6191</a> to avoid wasting time.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="6198.html#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-02-15T20%3A23%3A11Z&amp;precision=second" title="2013-02-15T20:23:11Z in Timeline">8 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      
    </div>

                <div class="trac-lastedit ">
                  Last edited <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-02-15T20%3A55%3A01Z&amp;precision=second" title="2013-02-15T20:55:01Z in Timeline">8 years</a> ago
                      by Russell Taylor
                    (<a href="https://trac.mantidproject.org/mantid/ticket/6198?cversion=0&amp;cnum_hist=6#comment:6">previous</a>)
                    (<a href="https://trac.mantidproject.org/mantid/ticket/6198?action=comment-diff&amp;cnum=6&amp;version=1">diff</a>)
                </div>
              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="6198.html#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-04-16T15%3A47%3A41%2B01%3A00&amp;precision=second" title="2013-04-16T15:47:41+01:00 in Timeline">7 years</a> ago by Stuart Campbell
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Milestone</strong>
        changed from <em>Release 2.5</em> to <em>Release 2.6</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
bumping to next release as blocking ticket <a class="closed ticket" href="6191.html" title="enhancement: Remove SpDetMap + replace with Ispectrum (closed: fixed)">#6191</a> is delayed.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="6198.html#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-05-02T14%3A57%3A55%2B01%3A00&amp;precision=second" title="2013-05-02T14:57:55+01:00 in Timeline">7 years</a> ago by Nick Draper
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Keywords</strong>
        <em>Maintenance</em> added
    </li><li>
      <strong>Priority</strong>
        changed from <em>blocker</em> to <em>critical</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="6198.html#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-05-21T22%3A28%3A54%2B01%3A00&amp;precision=second" title="2013-05-21T22:28:54+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
The two "getWorkspaceIndexTo..." methods have gone under <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a> (commits <a class="missing changeset" title="No default repository defined">[873db8e8c]</a> &amp; <a class="missing changeset" title="No default repository defined">[757dc57b]</a>).
</p>

    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="6198.html#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-24T09%3A53%3A05%2B01%3A00&amp;precision=second" title="2013-07-24T09:53:05+01:00 in Timeline">7 years</a> ago by Nick Draper
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Component</strong>
        changed from <em>Mantid</em> to <em>Framework</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-11">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:11" class="cnum">
      <a href="6198.html#comment:11">comment:11</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-26T15%3A01%3A42%2B01%3A00&amp;precision=second" title="2013-07-26T15:01:42+01:00 in Timeline">7 years</a> ago by Nick Draper
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Milestone</strong>
        changed from <em>Release 2.6</em> to <em>Backlog</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Moved to the Backlog after R2.6
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:12" class="cnum">
      <a href="6198.html#comment:12">comment:12</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-05T12%3A44%3A15%2B01%3A00&amp;precision=second" title="2013-09-05T12:44:15+01:00 in Timeline">7 years</a> ago by Stuart Campbell
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Owner</strong>
        changed from <em>Stuart Campbell</em> to <em>Russell Taylor</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Because Russell asked for it.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-13">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:13" class="cnum">
      <a href="6198.html#comment:13">comment:13</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-18T16%3A35%3A51%2B01%3A00&amp;precision=second" title="2013-09-18T16:35:51+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>inprogress</em>
    </li><li>
      <strong>Milestone</strong>
        changed from <em>Backlog</em> to <em>Release 3.0</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
The Coverity scan showed yet another leak surrounding the use of these functions (in MantidWSIndexDialog). Let's just get it fixed.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-14">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:14" class="cnum">
      <a href="6198.html#comment:14">comment:14</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-18T20%3A53%3A37%2B01%3A00&amp;precision=second" title="2013-09-18T20:53:37+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Just return the maps by value.
</p>
<p>
In C++11, map has a move constructor so returning by value isn't expensive.
Actually, even on the non-C++11 Mac tests show that the RVO saves us.
</p>
<p>
Now to fix all the client code...
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/1f525ef0258912ec82af95695d3a53629aa3f99e" title="1f525ef0258912ec82af95695d3a53629aa3f99e">1f525ef0258912ec82af95695d3a53629aa3f99e</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-15">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:15" class="cnum">
      <a href="6198.html#comment:15">comment:15</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-18T20%3A53%3A37%2B01%3A00&amp;precision=second" title="2013-09-18T20:53:37+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix usages of mapping methods for value return.
</p>
<p>
Notes:
</p>
<ul><li>4 classes weren't deleting the returned pointer
</li><li>more were not exception safe
</li><li>some changes rely on the move assignment operator for efficiency.
</li></ul><p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/d0f54814f44ad884aa6bc484d7380d10ad2b4116" title="d0f54814f44ad884aa6bc484d7380d10ad2b4116">d0f54814f44ad884aa6bc484d7380d10ad2b4116</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-16">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:16" class="cnum">
      <a href="6198.html#comment:16">comment:16</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-18T20%3A53%3A37%2B01%3A00&amp;precision=second" title="2013-09-18T20:53:37+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix clients of mapping methods in Algorithms package.
</p>
<p>
(At least 5 more places that weren't deleting the returned map.)
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/7c7bbfae6393b73dfbf6a488d3c0605f4df132df" title="7c7bbfae6393b73dfbf6a488d3c0605f4df132df">7c7bbfae6393b73dfbf6a488d3c0605f4df132df</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-17">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:17" class="cnum">
      <a href="6198.html#comment:17">comment:17</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-18T20%3A53%3A37%2B01%3A00&amp;precision=second" title="2013-09-18T20:53:37+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix clients of mapping methods in Crystal package.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/c25a88b42b87bf415ef896bf7fcb0621b17090bb" title="c25a88b42b87bf415ef896bf7fcb0621b17090bb">c25a88b42b87bf415ef896bf7fcb0621b17090bb</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-18">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:18" class="cnum">
      <a href="6198.html#comment:18">comment:18</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-18T20%3A53%3A38%2B01%3A00&amp;precision=second" title="2013-09-18T20:53:38+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix last use of mapping method in Framework.
</p>
<p>
We're relying on the move assignment operator here for efficiency, so
things will be a little slower on the Mac until it gets C++11 libs.
But we're not leaking the thing like we were before.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/b49330ab6febb0460cb017447ea9e54de9f0bcd5" title="b49330ab6febb0460cb017447ea9e54de9f0bcd5">b49330ab6febb0460cb017447ea9e54de9f0bcd5</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-19">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:19" class="cnum">
      <a href="6198.html#comment:19">comment:19</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-18T20%3A53%3A38%2B01%3A00&amp;precision=second" title="2013-09-18T20:53:38+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix previously-leaking usage of getSpectrumToWorkspaceIndexMap.
</p>
<p>
This is the one that the Coverity scan highlighted. Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/c96632afb717277197b0016a2950a8b83b0ac63f" title="c96632afb717277197b0016a2950a8b83b0ac63f">c96632afb717277197b0016a2950a8b83b0ac63f</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-20">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:20" class="cnum">
      <a href="6198.html#comment:20">comment:20</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-18T20%3A53%3A38%2B01%3A00&amp;precision=second" title="2013-09-18T20:53:38+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Update InstrumentView usage of mapping method.
</p>
<p>
I restored the documented exception throwing behaviour after checking that
every place that calls the method catches the exception. Not sure when/why
that behaviour was changed, but this avoids the risk of accessing an
invalid iterator.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/f09ccaf65f7ec33a28ae630218c024f967812a1a" title="f09ccaf65f7ec33a28ae630218c024f967812a1a">f09ccaf65f7ec33a28ae630218c024f967812a1a</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-21">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:21" class="cnum">
      <a href="6198.html#comment:21">comment:21</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-18T20%3A53%3A38%2B01%3A00&amp;precision=second" title="2013-09-18T20:53:38+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix usages of mapping methods in tests.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/b6cad4120186ff174ca027fcf977f0029578a5b7" title="b6cad4120186ff174ca027fcf977f0029578a5b7">b6cad4120186ff174ca027fcf977f0029578a5b7</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-22">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:22" class="cnum">
      <a href="6198.html#comment:22">comment:22</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-18T22%3A25%3A53%2B01%3A00&amp;precision=second" title="2013-09-18T22:25:53+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
On the Mac, EditInstrumentGeometryTest is crashing inside the map::find method at line 290 of EditInstrumentGeometry. I cannot for the moment fathom why. 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-23">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:23" class="cnum">
      <a href="6198.html#comment:23">comment:23</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-23T21%3A22%3A19%2B01%3A00&amp;precision=second" title="2013-09-23T21:22:19+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix for crashing unit test on Mac.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8c931453f53bbd32c26c8c90d26ec60158c7fb89" title="8c931453f53bbd32c26c8c90d26ec60158c7fb89">8c931453f53bbd32c26c8c90d26ec60158c7fb89</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-24">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:24" class="cnum">
      <a href="6198.html#comment:24">comment:24</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-24T15%3A04%3A56%2B01%3A00&amp;precision=second" title="2013-09-24T15:04:56+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
<strong>Tester</strong>: Branch is feature/6198_mapping_functions_remove_bare_pointers
</p>
<p>
Despite the ticket description, I went for returning the created map by value. In the vast majority of cases this is just fine everywhere because we get the Named Return Value Optimization. There are just a couple of cases where the methods are called and assigned to an existing variable. With C++11, return-by-value is still fine as std::map has a move assignment operator. Without a C++11 library (currently the Mac) we will suffer a copy in these cases, but I'm asserting that we can live with that until the Mac catches up.
</p>
<p>
Test by inspecting code and observing that all tests are passing.
</p>

    </div>

                <div class="trac-lastedit ">
                  Last edited <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-24T15%3A05%3A22%2B01%3A00&amp;precision=second" title="2013-09-24T15:05:22+01:00 in Timeline">7 years</a> ago
                      by Russell Taylor
                    (<a href="https://trac.mantidproject.org/mantid/ticket/6198?cversion=0&amp;cnum_hist=24#comment:24">previous</a>)
                    (<a href="https://trac.mantidproject.org/mantid/ticket/6198?action=comment-diff&amp;cnum=24&amp;version=1">diff</a>)
                </div>
              </div>
              <div class="change" id="trac-change-25">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:25" class="cnum">
      <a href="6198.html#comment:25">comment:25</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-27T13%3A35%3A35%2B01%3A00&amp;precision=second" title="2013-09-27T13:35:35+01:00 in Timeline">7 years</a> ago by Roman Tolchenov
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        set to <em>Roman Tolchenov</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-26">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:26" class="cnum">
      <a href="6198.html#comment:26">comment:26</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-09-27T14%3A36%3A34%2B01%3A00&amp;precision=second" title="2013-09-27T14:36:34+01:00 in Timeline">7 years</a> ago by Roman Tolchenov
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Merge remote-tracking branch 'origin/feature/6198_mapping_functions_remove_bare_pointers'
</p>

    </div>

              </div>
              <div class="change" id="trac-change-27">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:27" class="cnum">
      <a href="6198.html#comment:27">comment:27</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-01T17%3A12%3A54%2B01%3A00&amp;precision=second" title="2013-10-01T17:12:54+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Just return the maps by value.
</p>
<p>
In C++11, map has a move constructor so returning by value isn't expensive.
Actually, even on the non-C++11 Mac tests show that the RVO saves us.
</p>
<p>
Now to fix all the client code...
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/419a24854a0bcdd1913e0a39b316845406bce967" title="419a24854a0bcdd1913e0a39b316845406bce967">419a24854a0bcdd1913e0a39b316845406bce967</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-28">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:28" class="cnum">
      <a href="6198.html#comment:28">comment:28</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-01T17%3A12%3A55%2B01%3A00&amp;precision=second" title="2013-10-01T17:12:55+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix usages of mapping methods for value return.
</p>
<p>
Notes:
</p>
<ul><li>4 classes weren't deleting the returned pointer
</li><li>more were not exception safe
</li><li>some changes rely on the move assignment operator for efficiency.
</li></ul><p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/59e1811525e3e61e990fc9768bf73e9dd8716019" title="59e1811525e3e61e990fc9768bf73e9dd8716019">59e1811525e3e61e990fc9768bf73e9dd8716019</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-29">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:29" class="cnum">
      <a href="6198.html#comment:29">comment:29</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-01T17%3A12%3A55%2B01%3A00&amp;precision=second" title="2013-10-01T17:12:55+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix clients of mapping methods in Algorithms package.
</p>
<p>
(At least 5 more places that weren't deleting the returned map.)
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/553f7fe05e9a6d4aa8b618ecb8a623fd1c33a251" title="553f7fe05e9a6d4aa8b618ecb8a623fd1c33a251">553f7fe05e9a6d4aa8b618ecb8a623fd1c33a251</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-30">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:30" class="cnum">
      <a href="6198.html#comment:30">comment:30</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-01T17%3A12%3A55%2B01%3A00&amp;precision=second" title="2013-10-01T17:12:55+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix clients of mapping methods in Crystal package.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8a44c333e947a1f4e831b74047781789a561ddeb" title="8a44c333e947a1f4e831b74047781789a561ddeb">8a44c333e947a1f4e831b74047781789a561ddeb</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-31">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:31" class="cnum">
      <a href="6198.html#comment:31">comment:31</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-01T17%3A12%3A55%2B01%3A00&amp;precision=second" title="2013-10-01T17:12:55+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix last use of mapping method in Framework.
</p>
<p>
We're relying on the move assignment operator here for efficiency, so
things will be a little slower on the Mac until it gets C++11 libs.
But we're not leaking the thing like we were before.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/14b9d0b7003b0440453033fbeaef2d1e291f77b4" title="14b9d0b7003b0440453033fbeaef2d1e291f77b4">14b9d0b7003b0440453033fbeaef2d1e291f77b4</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-32">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:32" class="cnum">
      <a href="6198.html#comment:32">comment:32</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-01T17%3A12%3A55%2B01%3A00&amp;precision=second" title="2013-10-01T17:12:55+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix previously-leaking usage of getSpectrumToWorkspaceIndexMap.
</p>
<p>
This is the one that the Coverity scan highlighted. Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/e30fb507baf4fd0fed58d8b0ba71048276e691cd" title="e30fb507baf4fd0fed58d8b0ba71048276e691cd">e30fb507baf4fd0fed58d8b0ba71048276e691cd</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-33">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:33" class="cnum">
      <a href="6198.html#comment:33">comment:33</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-01T17%3A12%3A55%2B01%3A00&amp;precision=second" title="2013-10-01T17:12:55+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Update InstrumentView usage of mapping method.
</p>
<p>
I restored the documented exception throwing behaviour after checking that
every place that calls the method catches the exception. Not sure when/why
that behaviour was changed, but this avoids the risk of accessing an
invalid iterator.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/c67e1e850528a02136aafc36b2f99a428cc4c574" title="c67e1e850528a02136aafc36b2f99a428cc4c574">c67e1e850528a02136aafc36b2f99a428cc4c574</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-34">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:34" class="cnum">
      <a href="6198.html#comment:34">comment:34</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-01T17%3A12%3A55%2B01%3A00&amp;precision=second" title="2013-10-01T17:12:55+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix usages of mapping methods in tests.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8aacb1e0c25b284c4db46843007f1ff7e5bc6234" title="8aacb1e0c25b284c4db46843007f1ff7e5bc6234">8aacb1e0c25b284c4db46843007f1ff7e5bc6234</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-35">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:35" class="cnum">
      <a href="6198.html#comment:35">comment:35</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-01T17%3A12%3A55%2B01%3A00&amp;precision=second" title="2013-10-01T17:12:55+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix for crashing unit test on Mac.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/85dcbe2cb34a7240230e68f417ab4025caa49836" title="85dcbe2cb34a7240230e68f417ab4025caa49836">85dcbe2cb34a7240230e68f417ab4025caa49836</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-36">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:36" class="cnum">
      <a href="6198.html#comment:36">comment:36</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A01%3A41%2B01%3A00&amp;precision=second" title="2013-10-02T10:01:41+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Just return the maps by value.
</p>
<p>
In C++11, map has a move constructor so returning by value isn't expensive.
Actually, even on the non-C++11 Mac tests show that the RVO saves us.
</p>
<p>
Now to fix all the client code...
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/419a24854a0bcdd1913e0a39b316845406bce967" title="419a24854a0bcdd1913e0a39b316845406bce967">419a24854a0bcdd1913e0a39b316845406bce967</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-37">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:37" class="cnum">
      <a href="6198.html#comment:37">comment:37</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A01%3A42%2B01%3A00&amp;precision=second" title="2013-10-02T10:01:42+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix usages of mapping methods for value return.
</p>
<p>
Notes:
</p>
<ul><li>4 classes weren't deleting the returned pointer
</li><li>more were not exception safe
</li><li>some changes rely on the move assignment operator for efficiency.
</li></ul><p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/59e1811525e3e61e990fc9768bf73e9dd8716019" title="59e1811525e3e61e990fc9768bf73e9dd8716019">59e1811525e3e61e990fc9768bf73e9dd8716019</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-38">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:38" class="cnum">
      <a href="6198.html#comment:38">comment:38</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A01%3A42%2B01%3A00&amp;precision=second" title="2013-10-02T10:01:42+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix clients of mapping methods in Algorithms package.
</p>
<p>
(At least 5 more places that weren't deleting the returned map.)
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/553f7fe05e9a6d4aa8b618ecb8a623fd1c33a251" title="553f7fe05e9a6d4aa8b618ecb8a623fd1c33a251">553f7fe05e9a6d4aa8b618ecb8a623fd1c33a251</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-39">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:39" class="cnum">
      <a href="6198.html#comment:39">comment:39</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A01%3A42%2B01%3A00&amp;precision=second" title="2013-10-02T10:01:42+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix clients of mapping methods in Crystal package.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8a44c333e947a1f4e831b74047781789a561ddeb" title="8a44c333e947a1f4e831b74047781789a561ddeb">8a44c333e947a1f4e831b74047781789a561ddeb</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-40">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:40" class="cnum">
      <a href="6198.html#comment:40">comment:40</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A01%3A42%2B01%3A00&amp;precision=second" title="2013-10-02T10:01:42+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix last use of mapping method in Framework.
</p>
<p>
We're relying on the move assignment operator here for efficiency, so
things will be a little slower on the Mac until it gets C++11 libs.
But we're not leaking the thing like we were before.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/14b9d0b7003b0440453033fbeaef2d1e291f77b4" title="14b9d0b7003b0440453033fbeaef2d1e291f77b4">14b9d0b7003b0440453033fbeaef2d1e291f77b4</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-41">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:41" class="cnum">
      <a href="6198.html#comment:41">comment:41</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A01%3A42%2B01%3A00&amp;precision=second" title="2013-10-02T10:01:42+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix previously-leaking usage of getSpectrumToWorkspaceIndexMap.
</p>
<p>
This is the one that the Coverity scan highlighted. Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/e30fb507baf4fd0fed58d8b0ba71048276e691cd" title="e30fb507baf4fd0fed58d8b0ba71048276e691cd">e30fb507baf4fd0fed58d8b0ba71048276e691cd</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-42">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:42" class="cnum">
      <a href="6198.html#comment:42">comment:42</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A01%3A43%2B01%3A00&amp;precision=second" title="2013-10-02T10:01:43+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Update InstrumentView usage of mapping method.
</p>
<p>
I restored the documented exception throwing behaviour after checking that
every place that calls the method catches the exception. Not sure when/why
that behaviour was changed, but this avoids the risk of accessing an
invalid iterator.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/c67e1e850528a02136aafc36b2f99a428cc4c574" title="c67e1e850528a02136aafc36b2f99a428cc4c574">c67e1e850528a02136aafc36b2f99a428cc4c574</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-43">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:43" class="cnum">
      <a href="6198.html#comment:43">comment:43</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A01%3A43%2B01%3A00&amp;precision=second" title="2013-10-02T10:01:43+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix usages of mapping methods in tests.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8aacb1e0c25b284c4db46843007f1ff7e5bc6234" title="8aacb1e0c25b284c4db46843007f1ff7e5bc6234">8aacb1e0c25b284c4db46843007f1ff7e5bc6234</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-44">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:44" class="cnum">
      <a href="6198.html#comment:44">comment:44</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A01%3A43%2B01%3A00&amp;precision=second" title="2013-10-02T10:01:43+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix for crashing unit test on Mac.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/85dcbe2cb34a7240230e68f417ab4025caa49836" title="85dcbe2cb34a7240230e68f417ab4025caa49836">85dcbe2cb34a7240230e68f417ab4025caa49836</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-45">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:45" class="cnum">
      <a href="6198.html#comment:45">comment:45</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A16%3A18%2B01%3A00&amp;precision=second" title="2013-10-02T10:16:18+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Just return the maps by value.
</p>
<p>
In C++11, map has a move constructor so returning by value isn't expensive.
Actually, even on the non-C++11 Mac tests show that the RVO saves us.
</p>
<p>
Now to fix all the client code...
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/419a24854a0bcdd1913e0a39b316845406bce967" title="419a24854a0bcdd1913e0a39b316845406bce967">419a24854a0bcdd1913e0a39b316845406bce967</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-46">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:46" class="cnum">
      <a href="6198.html#comment:46">comment:46</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A16%3A18%2B01%3A00&amp;precision=second" title="2013-10-02T10:16:18+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix usages of mapping methods for value return.
</p>
<p>
Notes:
</p>
<ul><li>4 classes weren't deleting the returned pointer
</li><li>more were not exception safe
</li><li>some changes rely on the move assignment operator for efficiency.
</li></ul><p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/59e1811525e3e61e990fc9768bf73e9dd8716019" title="59e1811525e3e61e990fc9768bf73e9dd8716019">59e1811525e3e61e990fc9768bf73e9dd8716019</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-47">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:47" class="cnum">
      <a href="6198.html#comment:47">comment:47</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A16%3A19%2B01%3A00&amp;precision=second" title="2013-10-02T10:16:19+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix clients of mapping methods in Algorithms package.
</p>
<p>
(At least 5 more places that weren't deleting the returned map.)
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/553f7fe05e9a6d4aa8b618ecb8a623fd1c33a251" title="553f7fe05e9a6d4aa8b618ecb8a623fd1c33a251">553f7fe05e9a6d4aa8b618ecb8a623fd1c33a251</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-48">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:48" class="cnum">
      <a href="6198.html#comment:48">comment:48</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A16%3A19%2B01%3A00&amp;precision=second" title="2013-10-02T10:16:19+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix clients of mapping methods in Crystal package.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8a44c333e947a1f4e831b74047781789a561ddeb" title="8a44c333e947a1f4e831b74047781789a561ddeb">8a44c333e947a1f4e831b74047781789a561ddeb</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-49">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:49" class="cnum">
      <a href="6198.html#comment:49">comment:49</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A16%3A19%2B01%3A00&amp;precision=second" title="2013-10-02T10:16:19+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix last use of mapping method in Framework.
</p>
<p>
We're relying on the move assignment operator here for efficiency, so
things will be a little slower on the Mac until it gets C++11 libs.
But we're not leaking the thing like we were before.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/14b9d0b7003b0440453033fbeaef2d1e291f77b4" title="14b9d0b7003b0440453033fbeaef2d1e291f77b4">14b9d0b7003b0440453033fbeaef2d1e291f77b4</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-50">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:50" class="cnum">
      <a href="6198.html#comment:50">comment:50</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A16%3A19%2B01%3A00&amp;precision=second" title="2013-10-02T10:16:19+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Fix previously-leaking usage of getSpectrumToWorkspaceIndexMap.
</p>
<p>
This is the one that the Coverity scan highlighted. Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/e30fb507baf4fd0fed58d8b0ba71048276e691cd" title="e30fb507baf4fd0fed58d8b0ba71048276e691cd">e30fb507baf4fd0fed58d8b0ba71048276e691cd</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-51">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:51" class="cnum">
      <a href="6198.html#comment:51">comment:51</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A16%3A19%2B01%3A00&amp;precision=second" title="2013-10-02T10:16:19+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Update InstrumentView usage of mapping method.
</p>
<p>
I restored the documented exception throwing behaviour after checking that
every place that calls the method catches the exception. Not sure when/why
that behaviour was changed, but this avoids the risk of accessing an
invalid iterator.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/c67e1e850528a02136aafc36b2f99a428cc4c574" title="c67e1e850528a02136aafc36b2f99a428cc4c574">c67e1e850528a02136aafc36b2f99a428cc4c574</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-52">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:52" class="cnum">
      <a href="6198.html#comment:52">comment:52</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A16%3A19%2B01%3A00&amp;precision=second" title="2013-10-02T10:16:19+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix usages of mapping methods in tests.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8aacb1e0c25b284c4db46843007f1ff7e5bc6234" title="8aacb1e0c25b284c4db46843007f1ff7e5bc6234">8aacb1e0c25b284c4db46843007f1ff7e5bc6234</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-53">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:53" class="cnum">
      <a href="6198.html#comment:53">comment:53</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-02T10%3A16%3A19%2B01%3A00&amp;precision=second" title="2013-10-02T10:16:19+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
Re <a class="closed ticket" href="6198.html" title="enhancement: Mapping functions: Return bare pointer -&gt; shared pointer (closed: fixed)">#6198</a>. Fix for crashing unit test on Mac.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/85dcbe2cb34a7240230e68f417ab4025caa49836" title="85dcbe2cb34a7240230e68f417ab4025caa49836">85dcbe2cb34a7240230e68f417ab4025caa49836</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-54">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:54" class="cnum">
      <a href="6198.html#comment:54">comment:54</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T01%3A03%3A57%2B01%3A00&amp;precision=second" title="2015-06-04T01:03:57+01:00 in Timeline">5 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
This ticket has been transferred to github issue <a class="ext-link" href="http://github.com/mantidproject/mantid/issues/7044"><span class="icon">â€‹</span>7044</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="../wiki/TracTickets.html">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/6198?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/6198?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/6198?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.5</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>