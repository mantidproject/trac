<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #9184 (ReflectometryReductionOne should correct positions)
     â€“ Mantid Project
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="prev" href="9183.html" title="Ticket #9183" />
        <link rel="last" href="11888.html" title="Ticket #11888" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/9184?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/9184?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/9184?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="9185.html" title="Ticket #9185" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="1.html" title="Ticket #1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Mantid Project" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="a82fe30e7bef2e30fd2838e9";
    </script>
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="../chrome/common/js/resizer.js"></script><script type="text/javascript" src="../chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/mantid/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 9184, escape_newlines: 0}
        $("#comment").autoPreview("/mantid/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/mantid/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.mantidproject.org/"><img src="../chrome/site/mantid_logo_with_name.png" alt="Mantid Logo" width="250" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.mantidproject.org/mantid/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="9183.html" title="Ticket #9183">Previous Ticket</a></span></li><li><span><a class="next" href="9185.html" title="Ticket #9185">Next Ticket</a> &rarr;</span></li><li class="last"><a href="../depgraph/9184.html">Depgraph</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="9184.html">Ticket #9184</a>
          <span class="status">(closed: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-03-14T09%3A56%3A52Z&amp;precision=second" title="2014-03-14T09:56:52Z in Timeline">7 years</a> ago</p>
    <p>Last modified <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T03%3A07%3A42%2B01%3A00&amp;precision=second" title="2015-06-04T03:07:42+01:00 in Timeline">5 years</a> ago</p>
  </div>
  <h2 class="summary searchable">ReflectometryReductionOne should correct positions</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;reporter=Owen+Arnold">Owen Arnold</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;owner=Owen+Arnold">Owen Arnold</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;priority=critical">critical</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="../milestone/Release&#32;3.2.html">Release 3.2</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;component=Reflectometry">Reflectometry</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby"><span><a class="closed ticket" href="9389.html" title="SpecularReflectionPositionCorrect algorithm">#9389</a>, <a class="closed ticket" href="9401.html" title="Theta calculation bug">#9401</a></span></td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking"><span></span></td>
        <th id="h_tester">
          Tester:
        </th>
        <td headers="h_tester">
              Keith Brown
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
      <span class="lastmod" title="2014-05-13 16:10:54.344797+00:00">
        (last modified by Owen Arnold)
        (<a href="https://trac.mantidproject.org/mantid/ticket/9184?action=diff&amp;version=6">diff</a>)
      </span>
    </h3>
    <div class="searchable">
      <p>
This is a simple principle: If you have known incident theta angle, and a reflection condition, i.e. theta_in == theta_out, then you can correct the detector positions accordingly.
</p>
<p>
I've avoided this problem so far, because for the multi-detector case you may have a number of 'masked' pixels, in which case there is no easily identifiable vertical centre position. 
</p>
<p>
Having had a chat with Tim about this, we've agreed that if you have a range of pixels in the processing instructions, you should find the centre location and use that, along with the theta position to correct location. Corrections should still be optional.
</p>
<p>
Changes should apply to ReflectometryReductionOne, ReflectometryReductionOneAuto, CreateTransmissionWorkspace and CreateTransmissionWorkspaceAuto.
</p>
<p>
As part of this. We should also update ReflectometryReductionOne (following <a class="closed ticket" href="9401.html" title="enhancement: Theta calculation bug (closed: fixed)">#9401</a>) to calculate The OuptutTheta value if Multiple Spectrum numbers are given instead of component names.
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="9184.html#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-03-14T09%3A57%3A08Z&amp;precision=second" title="2014-03-14T09:57:08Z in Timeline">7 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Component</strong>
        changed from <em>Framework</em> to <em>Reflectometry</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="9184.html#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-03-14T14%3A51%3A21Z&amp;precision=second" title="2014-03-14T14:51:21Z in Timeline">7 years</a> ago by Nick Draper
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>assigned</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="9184.html#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-28T17%3A16%3A21%2B01%3A00&amp;precision=second" title="2014-04-28T17:16:21+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
This can be fixed around lines 308 of ReflectometryReductionOne.cpp. Instead of knowing the exact components to use in the multidetector case, we must determine them from the ProcessingCommands. Should be relatively easy given that we know the Reference frame and the detector positions corresponding to these workspace indexes.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="9184.html#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-29T10%3A46%3A50%2B01%3A00&amp;precision=second" title="2014-04-29T10:46:50+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
This is complex enough that the functionality to do it is deserving of it's own algorithm. I'm going to create a new blocking ticket to do this first. 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="9184.html#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-29T10%3A52%3A26%2B01%3A00&amp;precision=second" title="2014-04-29T10:52:26+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocked By</strong>
        <em>9389</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="9184.html#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-13T17%3A10%3A54%2B01%3A00&amp;precision=second" title="2014-05-13T17:10:54+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Description</strong>
        modified (<a href="https://trac.mantidproject.org/mantid/ticket/9184?action=diff&amp;version=6">diff</a>)
    </li><li>
      <strong>Blocked By</strong>
        <em>9401</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="9184.html#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-02T15%3A57%3A56%2B01%3A00&amp;precision=second" title="2014-06-02T15:57:56+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>assigned</em> to <em>inprogress</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9184.html" title="defect: ReflectometryReductionOne should correct positions (closed: fixed)">#9184</a>. Test point detector position correction.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/d0d12dd1ffc5e0c102d319b21acfde55f23527b2" title="d0d12dd1ffc5e0c102d319b21acfde55f23527b2">d0d12dd1ffc5e0c102d319b21acfde55f23527b2</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="9184.html#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-03T15%3A18%3A44%2B01%3A00&amp;precision=second" title="2014-06-03T15:18:44+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9184.html" title="defect: ReflectometryReductionOne should correct positions (closed: fixed)">#9184</a>. Employ and test position correction multidetector
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/759476e7b68a2c30968ca8a03ffb2ebc4dc2bec7" title="759476e7b68a2c30968ca8a03ffb2ebc4dc2bec7">759476e7b68a2c30968ca8a03ffb2ebc4dc2bec7</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="9184.html#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-03T15%3A37%3A31%2B01%3A00&amp;precision=second" title="2014-06-03T15:37:31+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
Tester: 
</p>
<p>
Unit tests demonstrate this new functionality behaving properly. To manually test...
</p>
<p>
1) Run the following. It prints out the x,y,z of the linear detector of the corrected component. This is taken from an existing system test. The z-offset is correct.
</p>
<div class="code"><pre><span class="kn">from</span> <span class="nn">mantid.simpleapi</span> <span class="kn">import</span> <span class="o">*</span>


<span class="k">class</span> <span class="nc">ReflectometryISIS</span><span class="p">():</span>
    

    <span class="k">def</span> <span class="nf">get_workspace_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">"POLREF4699"</span>
    
    <span class="k">def</span> <span class="nf">runTest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        workspace_name <span class="o">=</span> <span class="bp">self</span><span class="o">.</span>get_workspace_name<span class="p">()</span>
        workspace_nexus_file <span class="o">=</span> workspace_name <span class="o">+</span> <span class="s">".nxs"</span>
        
        PIX<span class="o">=</span><span class="mf">1.1E-3</span> <span class="c">#m</span>
        SC<span class="o">=</span><span class="mi">75</span>
        avgDB<span class="o">=</span><span class="mi">29</span>
        Load<span class="p">(</span>Filename<span class="o">=</span>workspace_nexus_file<span class="p">,</span>OutputWorkspace<span class="o">=</span>workspace_name<span class="p">)</span>
        X<span class="o">=</span>mtd<span class="p">[</span>workspace_name<span class="p">]</span>
        X <span class="o">=</span> ConvertUnits<span class="p">(</span>InputWorkspace<span class="o">=</span>X<span class="p">,</span>Target<span class="o">=</span><span class="s">"Wavelength"</span><span class="p">,</span>AlignBins<span class="o">=</span><span class="s">"1"</span><span class="p">)</span>
        <span class="c"># Reference intensity to normalise by</span>
        CropWorkspace<span class="p">(</span>InputWorkspace<span class="o">=</span>X<span class="p">,</span>OutputWorkspace<span class="o">=</span><span class="s">'Io'</span><span class="p">,</span>XMin<span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>XMax<span class="o">=</span><span class="mf">14.5</span><span class="p">,</span>StartWorkspaceIndex<span class="o">=</span><span class="mi">2</span><span class="p">,</span>EndWorkspaceIndex<span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c"># Crop out transmission and noisy data </span>
        CropWorkspace<span class="p">(</span>InputWorkspace<span class="o">=</span>X<span class="p">,</span>OutputWorkspace<span class="o">=</span><span class="s">'D'</span><span class="p">,</span>XMin<span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>XMax<span class="o">=</span><span class="mf">14.5</span><span class="p">,</span>StartWorkspaceIndex<span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        Io<span class="o">=</span>mtd<span class="p">[</span><span class="s">'Io'</span><span class="p">]</span>
        D<span class="o">=</span>mtd<span class="p">[</span><span class="s">'D'</span><span class="p">]</span>
    
        <span class="c"># Peform the normaisation step</span>
        Divide<span class="p">(</span>LHSWorkspace<span class="o">=</span>D<span class="p">,</span>RHSWorkspace<span class="o">=</span>Io<span class="p">,</span>OutputWorkspace<span class="o">=</span><span class="s">'I'</span><span class="p">,</span>
               AllowDifferentNumberSpectra<span class="o">=</span><span class="s">'1'</span><span class="p">,</span>ClearRHSWorkspace<span class="o">=</span><span class="s">'1'</span><span class="p">)</span>
        I<span class="o">=</span>mtd<span class="p">[</span><span class="s">'I'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="c"># Automatically determine the SC and averageDB </span>
        FindReflectometryLines<span class="p">(</span>InputWorkspace<span class="o">=</span>I<span class="p">,</span> StartWavelength<span class="o">=</span><span class="mi">10</span><span class="p">,</span> OutputWorkspace<span class="o">=</span><span class="s">'spectrum_numbers'</span><span class="p">)</span>
        spectrum_table <span class="o">=</span> mtd<span class="p">[</span><span class="s">'spectrum_numbers'</span><span class="p">]</span>
        
        x <span class="o">=</span> CloneWorkspace<span class="p">(</span>I<span class="p">)</span>
        y <span class="o">=</span> CloneWorkspace<span class="p">(</span>I<span class="p">)</span>
        
        <span class="c"># Move the detector so that the detector channel matching the reflected beam is at 0,0</span>
        MoveInstrumentComponent<span class="p">(</span>Workspace<span class="o">=</span>y<span class="p">,</span>ComponentName<span class="o">=</span><span class="s">"lineardetector"</span><span class="p">,</span>X<span class="o">=</span><span class="mi">0</span><span class="p">,</span>Y<span class="o">=</span><span class="mi">0</span><span class="p">,</span>Z<span class="o">=-</span>PIX<span class="o">*</span><span class="p">(</span> <span class="p">(</span>SC<span class="o">-</span>avgDB<span class="p">)</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">+</span>avgDB<span class="p">)</span> <span class="p">)</span>
        
        
        <span class="k">return</span> x<span class="p">,</span> y
        
   
<span class="c"># Specialisation for testing POLREF</span>
z <span class="o">=</span> ReflectometryISIS<span class="p">()</span>
x<span class="p">,</span> y <span class="o">=</span> z<span class="o">.</span>runTest<span class="p">()</span>

<span class="k">print</span> y<span class="o">.</span>getInstrument<span class="p">()</span><span class="o">.</span>getComponentByName<span class="p">(</span><span class="s">'lineardetector'</span><span class="p">)</span><span class="o">.</span>getPos<span class="p">()</span>

</pre></div><p>
2) Now run ReflectometryReductionOneAuto below. This handles the same problem but the correction is made in the algorithm. The Z-offset should be similar to (1)
</p>
<div class="code"><pre><span class="kn">from</span> <span class="nn">mantid.simpleapi</span> <span class="kn">import</span> <span class="o">*</span>


<span class="k">class</span> <span class="nc">ReflectometryISIS</span><span class="p">():</span>
    
    <span class="k">def</span> <span class="nf">get_workspace_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">"POLREF4699"</span>
    
    <span class="k">def</span> <span class="nf">runTest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        workspace_name <span class="o">=</span> <span class="bp">self</span><span class="o">.</span>get_workspace_name<span class="p">()</span>
        workspace_nexus_file <span class="o">=</span> workspace_name <span class="o">+</span> <span class="s">".nxs"</span>
        ws <span class="o">=</span> Load<span class="p">(</span>workspace_nexus_file<span class="p">)</span>
        
        out_lam<span class="p">,</span> out_q<span class="p">,</span> s <span class="o">=</span> ReflectometryReductionOneAuto<span class="p">(</span>ws<span class="p">,</span> CorrectDetectorPositions<span class="o">=</span><span class="bp">True</span><span class="p">,</span> AnalysisMode<span class="o">=</span><span class="s">'MultiDetectorAnalysis'</span><span class="p">,</span> ProcessingInstructions<span class="o">=</span><span class="s">'73'</span><span class="p">,</span> ThetaIn<span class="o">=</span><span class="mf">0.49</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> out_lam<span class="p">,</span> out_q

z <span class="o">=</span> ReflectometryISIS<span class="p">()</span>
x<span class="p">,</span> y <span class="o">=</span> z<span class="o">.</span>runTest<span class="p">()</span>

<span class="k">print</span> y<span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span>getInstrument<span class="p">()</span><span class="o">.</span>getComponentByName<span class="p">(</span><span class="s">'lineardetector'</span><span class="p">)</span><span class="o">.</span>getPos<span class="p">()</span>
</pre></div>
    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="9184.html#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-03T15%3A37%3A39%2B01%3A00&amp;precision=second" title="2014-06-03T15:37:39+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-11">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:11" class="cnum">
      <a href="9184.html#comment:11">comment:11</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-04T08%3A41%3A06%2B01%3A00&amp;precision=second" title="2014-06-04T08:41:06+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9184.html" title="defect: ReflectometryReductionOne should correct positions (closed: fixed)">#9184</a>. Merge branch 'master'
</p>
<p>
Merge branch 'master' into feature/9184_correct_positions_rro
</p>
<p>
Conflicts:
</p>
<blockquote>
<p>
Code/Mantid/Framework/Algorithms/src/ReflectometryReductionOne.cpp
</p>
</blockquote>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/396ba4e249e42331b914f8e34b19b9e77de98988" title="396ba4e249e42331b914f8e34b19b9e77de98988">396ba4e249e42331b914f8e34b19b9e77de98988</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:12" class="cnum">
      <a href="9184.html#comment:12">comment:12</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-04T09%3A15%3A32%2B01%3A00&amp;precision=second" title="2014-06-04T09:15:32+01:00 in Timeline">6 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>reopened</em>
    </li><li>
      <strong>Resolution</strong>
        <em>fixed</em> deleted
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
There is a cppcheck error in ReflectometryReductionOne: <a class="ext-link" href="http://builds.mantidproject.org/job/cppcheck_develop/430/cppcheckResult/"><span class="icon">â€‹</span>http://builds.mantidproject.org/job/cppcheck_develop/430/cppcheckResult/</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-13">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:13" class="cnum">
      <a href="9184.html#comment:13">comment:13</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-04T13%3A31%3A49%2B01%3A00&amp;precision=second" title="2014-06-04T13:31:49+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>reopened</em> to <em>inprogress</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9184.html" title="defect: ReflectometryReductionOne should correct positions (closed: fixed)">#9184</a>. Unused var removed.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/10ad21ac02469ab949e266094c4e6d5339477324" title="10ad21ac02469ab949e266094c4e6d5339477324">10ad21ac02469ab949e266094c4e6d5339477324</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-14">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:14" class="cnum">
      <a href="9184.html#comment:14">comment:14</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-07T17%3A32%3A27%2B01%3A00&amp;precision=second" title="2014-06-07T17:32:27+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-15">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:15" class="cnum">
      <a href="9184.html#comment:15">comment:15</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-09T14%3A14%3A18%2B01%3A00&amp;precision=second" title="2014-06-09T14:14:18+01:00 in Timeline">6 years</a> ago by Keith Brown
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        set to <em>Keith Brown</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-16">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:16" class="cnum">
      <a href="9184.html#comment:16">comment:16</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-09T16%3A25%3A13%2B01%3A00&amp;precision=second" title="2014-06-09T16:25:13+01:00 in Timeline">6 years</a> ago by Keith Brown
                </h3>
                
    <div class="comment searchable">
      
      <p>
Scripts return the same values to 2 decimal places
</p>

    </div>

              </div>
              <div class="change" id="trac-change-17">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:17" class="cnum">
      <a href="9184.html#comment:17">comment:17</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-06-09T16%3A25%3A43%2B01%3A00&amp;precision=second" title="2014-06-09T16:25:43+01:00 in Timeline">6 years</a> ago by Keith Brown
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Merge remote-tracking branch 'origin/feature/9184_correct_positions_rro'
</p>
<p>
Full changeset: <a class="ext-link" href="https://github.com/mantidproject/mantid/commit/59a5abba7f9326fde8702242fc61387ad7b52b86"><span class="icon">â€‹</span>59a5abba7f9326fde8702242fc61387ad7b52b86</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-18">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:18" class="cnum">
      <a href="9184.html#comment:18">comment:18</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T03%3A07%3A42%2B01%3A00&amp;precision=second" title="2015-06-04T03:07:42+01:00 in Timeline">5 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
This ticket has been transferred to github issue <a class="ext-link" href="http://github.com/mantidproject/mantid/issues/10027"><span class="icon">â€‹</span>10027</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="../wiki/TracTickets.html">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/mantid/pygments/trac.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/9184?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/9184?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/9184?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.5</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>