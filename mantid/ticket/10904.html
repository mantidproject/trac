<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #10904 (Write PeakShape)
     â€“ Mantid Project
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="prev" href="10903.html" title="Ticket #10903" />
        <link rel="last" href="11888.html" title="Ticket #11888" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/10904?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/10904?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/10904?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="10905.html" title="Ticket #10905" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="1.html" title="Ticket #1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Mantid Project" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="a82fe30e7bef2e30fd2838e9";
    </script>
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="../chrome/common/js/resizer.js"></script><script type="text/javascript" src="../chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/mantid/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 10904, escape_newlines: 0}
        $("#comment").autoPreview("/mantid/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/mantid/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.mantidproject.org/"><img src="../chrome/site/mantid_logo_with_name.png" alt="Mantid Logo" width="250" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.mantidproject.org/mantid/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="10903.html" title="Ticket #10903">Previous Ticket</a></span></li><li><span><a class="next" href="10905.html" title="Ticket #10905">Next Ticket</a> &rarr;</span></li><li class="last"><a href="../depgraph/10904.html">Depgraph</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="10904.html">Ticket #10904</a>
          <span class="status">(closed: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-01-15T15%3A56%3A20Z&amp;precision=second" title="2015-01-15T15:56:20Z in Timeline">6 years</a> ago</p>
    <p>Last modified <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T04%3A15%3A49%2B01%3A00&amp;precision=second" title="2015-06-04T04:15:49+01:00 in Timeline">5 years</a> ago</p>
  </div>
  <h2 class="summary searchable">Write PeakShape</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;reporter=Owen+Arnold">Owen Arnold</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;owner=Owen+Arnold">Owen Arnold</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;priority=critical">critical</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="../milestone/Release&#32;3.4.html">Release 3.4</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;component=Diffraction">Diffraction</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby"><span><a class="closed ticket" href="10878.html" title="Peak Shape">#10878</a></span></td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking"><span><a class="assigned ticket" href="10905.html" title="Redesign the PeaksViewer to draw multiple shape types">#10905</a></span></td>
        <th id="h_tester">
          Tester:
        </th>
        <td headers="h_tester">
              Martyn Gigg
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
These algorithms should be writing out peak shape information:
</p>
<p>
IntegrateMD
IntegrateEllipsoids
IntegratePeaksHybrid
</p>
<p>
Drawing of these types in the PeaksViewer will require a redesign of parts of the peaks viewer and is the subject of a later ticket.
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="10904.html#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-01-15T15%3A56%3A38Z&amp;precision=second" title="2015-01-15T15:56:38Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
changes in 10878 will allow this to happen.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="10904.html#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-01-15T15%3A58%3A32Z&amp;precision=second" title="2015-01-15T15:58:32Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>10905</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="10904.html#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-01-16T14%3A14%3A05Z&amp;precision=second" title="2015-01-16T14:14:05Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>assigned</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="10904.html#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-05T16%3A45%3A06Z&amp;precision=second" title="2015-02-05T16:45:06Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>assigned</em> to <em>inprogress</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. IntegratePeaksMD algorithms done.
</p>
<p>
IntegratePeaksMD v1 and v2 write out integrated peak info in the form of PeakShape
</p>
<p>
PeakShapeSpherical adapted to write out background outer radius and background inner radius as well as the peak radius. Factories also updated for this, unit tests added to and updated for this.
</p>
<p>
I got a little worried that someone may change the integer values agaist the enum entries of SpecialCoordinateSystem. So I put in place a unit test to sanity check those.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/4427109cf115e1a82aa734433567825260d8c5d2" title="4427109cf115e1a82aa734433567825260d8c5d2">4427109cf115e1a82aa734433567825260d8c5d2</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="10904.html#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-05T16%3A45%3A06Z&amp;precision=second" title="2015-02-05T16:45:06Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. Ellipsoid shape.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/2387ce56192b68b8e817acc2f7867c9bc706e9bf" title="2387ce56192b68b8e817acc2f7867c9bc706e9bf">2387ce56192b68b8e817acc2f7867c9bc706e9bf</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="10904.html#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-06T11%3A34%3A15Z&amp;precision=second" title="2015-02-06T11:34:15Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. Factory for elliptical peak shapes
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/78da6586affaaeb716be0bf5a600a8faa90aaead" title="78da6586affaaeb716be0bf5a600a8faa90aaead">78da6586affaaeb716be0bf5a600a8faa90aaead</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="10904.html#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-06T11%3A34%3A15Z&amp;precision=second" title="2015-02-06T11:34:15Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. Hook new factory into loader.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8d327c5fb2c546e06cdb04f9f45b3666f20a999a" title="8d327c5fb2c546e06cdb04f9f45b3666f20a999a">8d327c5fb2c546e06cdb04f9f45b3666f20a999a</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="10904.html#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-06T11%3A34%3A15Z&amp;precision=second" title="2015-02-06T11:34:15Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. Write from IntegrateEllipsoids.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/3d558b329cc794b4b193e860851f62f88234b6e8" title="3d558b329cc794b4b193e860851f62f88234b6e8">3d558b329cc794b4b193e860851f62f88234b6e8</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="10904.html#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-06T11%3A37%3A45Z&amp;precision=second" title="2015-02-06T11:37:45Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
This is being verified as <a class="ext-link" href="https://github.com/mantidproject/mantid/pull/179"><span class="icon">â€‹</span>pull request #179</a>.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="10904.html#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-06T13%3A44%3A19Z&amp;precision=second" title="2015-02-06T13:44:19Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. Mv PeakShape an fix warnings.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/0dd26e09dce1a86ae91341ae120499db6bd7b61c" title="0dd26e09dce1a86ae91341ae120499db6bd7b61c">0dd26e09dce1a86ae91341ae120499db6bd7b61c</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-11">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:11" class="cnum">
      <a href="10904.html#comment:11">comment:11</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-09T10%3A14%3A45Z&amp;precision=second" title="2015-02-09T10:14:45Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. Fix remaining warning.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/43d4e257400c3dd46d1e2f081a192d06158d7593" title="43d4e257400c3dd46d1e2f081a192d06158d7593">43d4e257400c3dd46d1e2f081a192d06158d7593</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:12" class="cnum">
      <a href="10904.html#comment:12">comment:12</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-09T10%3A14%3A45Z&amp;precision=second" title="2015-02-09T10:14:45Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. Expose PeakShape to python.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/bf2702633f1a18ab35ab234fd0378f52aa2767f8" title="bf2702633f1a18ab35ab234fd0378f52aa2767f8">bf2702633f1a18ab35ab234fd0378f52aa2767f8</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-13">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:13" class="cnum">
      <a href="10904.html#comment:13">comment:13</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-09T10%3A14%3A45Z&amp;precision=second" title="2015-02-09T10:14:45Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a> SpecialCoords API-&gt;Kernel
</p>
<p>
Since we have put PeakShape in Geometry, SpecialCoordinateSystem must be moved to the Kernel package out of API.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/561214347d175ee881aadba4e8796c51f8c359e5" title="561214347d175ee881aadba4e8796c51f8c359e5">561214347d175ee881aadba4e8796c51f8c359e5</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-14">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:14" class="cnum">
      <a href="10904.html#comment:14">comment:14</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-09T12%3A23%3A43Z&amp;precision=second" title="2015-02-09T12:23:43Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. Python tests for PeakShape.
</p>
<p>
Also fix GCC and Windows warnings
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8996ec68fc0f83d080026fbe978c8519d819b551" title="8996ec68fc0f83d080026fbe978c8519d819b551">8996ec68fc0f83d080026fbe978c8519d819b551</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-15">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:15" class="cnum">
      <a href="10904.html#comment:15">comment:15</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-09T13%3A58%3A39Z&amp;precision=second" title="2015-02-09T13:58:39Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. Resolve conflict with master.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/f910af2cda11091a56dd9cd69fd3621e9c4bcb9a" title="f910af2cda11091a56dd9cd69fd3621e9c4bcb9a">f910af2cda11091a56dd9cd69fd3621e9c4bcb9a</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-16">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:16" class="cnum">
      <a href="10904.html#comment:16">comment:16</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-09T14%3A07%3A35Z&amp;precision=second" title="2015-02-09T14:07:35Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
Tester: 
</p>
<p>
What's been done as part of this ticket has been well covered by unit tests. In addition, there are some new things that can be done in python (see below)
</p>
<p>
Setup steps
</p>
<div class="code"><pre><span class="c"># Basic parameters  for  Triphylite Crystal</span>
<span class="c">#Name of the workspaces to create</span>
ws_name <span class="o">=</span> <span class="s">"TOPAZ_3132"</span>
filename <span class="o">=</span> ws_name <span class="o">+</span><span class="s">"_event.nxs"</span>
ws <span class="o">=</span> LoadEventNexus<span class="p">(</span>Filename<span class="o">=</span>filename<span class="p">,</span>FilterByTofMin<span class="o">=</span><span class="mi">3000</span><span class="p">,</span> FilterByTofMax<span class="o">=</span><span class="mi">16000</span><span class="p">)</span>

<span class="c"># -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c"># Part 1. Basic Reduction</span>

<span class="c"># Spherical Absorption and Lorentz Corrections</span>
ws <span class="o">=</span> AnvredCorrection<span class="p">(</span>InputWorkspace<span class="o">=</span>ws<span class="p">,</span> LinearScatteringCoef<span class="o">=</span><span class="mf">0.451</span><span class="p">,</span> LinearAbsorptionCoef<span class="o">=</span><span class="mf">0.993</span><span class="p">,</span> Radius<span class="o">=</span><span class="mf">0.14</span><span class="p">)</span>

<span class="c"># Convert to Q space</span>
LabQ <span class="o">=</span> ConvertToDiffractionMDWorkspace<span class="p">(</span>InputWorkspace<span class="o">=</span>ws<span class="p">,</span> LorentzCorrection<span class="o">=</span><span class="s">'0'</span><span class="p">,</span>
        OutputDimensions<span class="o">=</span><span class="s">'Q (lab frame)'</span><span class="p">,</span> SplitInto<span class="o">=</span><span class="mi">2</span><span class="p">,</span> SplitThreshold<span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="c"># Find peaks</span>
PeaksLattice <span class="o">=</span> FindPeaksMD<span class="p">(</span>InputWorkspace<span class="o">=</span>LabQ<span class="p">,</span>MaxPeaks<span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c"># 3d integration to centroid peaks</span>
PeaksLattice <span class="o">=</span> CentroidPeaksMD<span class="p">(</span>InputWorkspace<span class="o">=</span>LabQ<span class="p">,</span>
    PeakRadius<span class="o">=</span><span class="mf">0.12</span><span class="p">,</span> PeaksWorkspace<span class="o">=</span>PeaksLattice<span class="p">)</span>

<span class="c"># Find the UB matrix using the peaks and known lattice parameters</span>
FindUBUsingLatticeParameters<span class="p">(</span>PeaksWorkspace<span class="o">=</span>PeaksLattice<span class="p">,</span> a<span class="o">=</span><span class="mf">10.3522</span><span class="p">,</span> b<span class="o">=</span><span class="mf">6.0768</span><span class="p">,</span> c<span class="o">=</span><span class="mf">4.7276</span><span class="p">,</span>
                alpha<span class="o">=</span><span class="mi">90</span><span class="p">,</span> beta<span class="o">=</span><span class="mi">90</span><span class="p">,</span> gamma<span class="o">=</span><span class="mi">90</span><span class="p">,</span> NumInitial<span class="o">=</span><span class="mi">20</span><span class="p">,</span> Tolerance<span class="o">=</span><span class="mf">0.12</span><span class="p">)</span>

<span class="c"># And index to HKL</span>
IndexPeaks<span class="p">(</span>PeaksWorkspace<span class="o">=</span>PeaksLattice<span class="p">,</span> Tolerance<span class="o">=</span><span class="mf">0.12</span><span class="p">)</span>

</pre></div><p>
Then run 
</p>
<div class="code"><pre>PeaksLatticeFFT <span class="o">=</span> IntegratePeaksMD<span class="p">(</span>InputWorkspace<span class="o">=</span>LabQ<span class="p">,</span> PeakRadius<span class="o">=</span><span class="mf">0.12</span><span class="p">,</span>
    BackgroundOuterRadius<span class="o">=</span><span class="mf">0.18</span><span class="p">,</span>BackgroundInnerRadius<span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
    PeaksWorkspace<span class="o">=</span>PeaksLatticeFFT<span class="p">)</span>

<span class="c"># The new bit:</span>
shape <span class="o">=</span> PeaksLatticeFFT<span class="o">.</span>getPeak<span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span>getPeakShape<span class="p">()</span>
<span class="k">print</span> shape<span class="o">.</span>toJSON<span class="p">()</span>

</pre></div><p>
And you should get this:
</p>
<pre class="wiki">{
   "algorithm_name" : "IntegratePeaksMD",
   "algorithm_version" : 2,
   "background_inner_radius" : 0.150,
   "background_outer_radius" : 0.180,
   "frame" : 1,
   "radius" : 0.120,
   "shape" : "spherical"
}
</pre><p>
Then run 
</p>
<div class="code"><pre>PeaksLatticeFFT <span class="o">=</span> IntegrateEllipsoids<span class="p">(</span>InputWorkspace<span class="o">=</span>ws<span class="p">,</span> PeaksWorkspace<span class="o">=</span>PeaksLatticeFFT<span class="p">)</span> 
    
<span class="c"># The new bit</span>
shape <span class="o">=</span> PeaksLatticeFFT<span class="o">.</span>getPeak<span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span>getPeakShape<span class="p">()</span>
<span class="k">print</span> shape<span class="o">.</span>toJSON<span class="p">()</span>
</pre></div><p>
And you should get this:
</p>
<pre class="wiki">{
   "algorithm_name" : "IntegrateEllipsoids",
   "algorithm_version" : -1,
   "background_inner_radius0" : 0.1569320366997004,
   "background_inner_radius1" : 0.1904709902029069,
   "background_inner_radius2" : 0.2009385702055810,
   "background_outer_radius0" : 0.1977219764573250,
   "background_outer_radius1" : 0.2399784099709861,
   "background_outer_radius2" : 0.2531667343589144,
   "direction0" : "-0.397112 0.592816 0.700622",
   "direction1" : "-0.674626 -0.706126 0.215095",
   "direction2" : "-0.622239 0.387241 -0.68034",
   "frame" : 1,
   "radius0" : 0.1569320366997004,
   "radius1" : 0.1904709902029069,
   "radius2" : 0.2009385702055810,
   "shape" : "ellipsoid"
}
</pre>
    </div>

              </div>
              <div class="change" id="trac-change-17">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:17" class="cnum">
      <a href="10904.html#comment:17">comment:17</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-09T14%3A09%3A56Z&amp;precision=second" title="2015-02-09T14:09:56Z in Timeline">6 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        set to <em>Martyn Gigg</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-18">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:18" class="cnum">
      <a href="10904.html#comment:18">comment:18</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-09T17%3A49%3A03Z&amp;precision=second" title="2015-02-09T17:49:03Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. Fix windows build.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/a22ac8e3d0f6fead27e7209c2dc4f6232d24c62f" title="a22ac8e3d0f6fead27e7209c2dc4f6232d24c62f">a22ac8e3d0f6fead27e7209c2dc4f6232d24c62f</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-19">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:19" class="cnum">
      <a href="10904.html#comment:19">comment:19</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-10T07%3A56%3A06Z&amp;precision=second" title="2015-02-10T07:56:06Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
Jenkins retest this please
</p>

    </div>

              </div>
              <div class="change" id="trac-change-20">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:20" class="cnum">
      <a href="10904.html#comment:20">comment:20</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-10T08%3A26%3A37Z&amp;precision=second" title="2015-02-10T08:26:37Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
Jenkins retest this please
</p>

    </div>

              </div>
              <div class="change" id="trac-change-21">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:21" class="cnum">
      <a href="10904.html#comment:21">comment:21</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-10T08%3A58%3A11Z&amp;precision=second" title="2015-02-10T08:58:11Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. Fix bad include.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/53d30cb05751da73fef600a749f5a88086e31c2d" title="53d30cb05751da73fef600a749f5a88086e31c2d">53d30cb05751da73fef600a749f5a88086e31c2d</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-22">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:22" class="cnum">
      <a href="10904.html#comment:22">comment:22</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-10T13%3A17%3A39Z&amp;precision=second" title="2015-02-10T13:17:39Z in Timeline">6 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
Jenkins, retest this please
</p>

    </div>

              </div>
              <div class="change" id="trac-change-23">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:23" class="cnum">
      <a href="10904.html#comment:23">comment:23</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-10T14%3A13%3A28Z&amp;precision=second" title="2015-02-10T14:13:28Z in Timeline">6 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
The builds have got themselves into some odd state with this pull request. I suggest closing it without merging and opening a fresh one.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-24">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:24" class="cnum">
      <a href="10904.html#comment:24">comment:24</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-10T14%3A21%3A41Z&amp;precision=second" title="2015-02-10T14:21:41Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>verify</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
This is being verified as <a class="ext-link" href="https://github.com/mantidproject/mantid/pull/196"><span class="icon">â€‹</span>pull request #196</a>.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-25">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:25" class="cnum">
      <a href="10904.html#comment:25">comment:25</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-10T14%3A41%3A01Z&amp;precision=second" title="2015-02-10T14:41:01Z in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="10904.html" title="Write PeakShape (closed: fixed)">#10904</a>. Scope resolution for enum
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/df4c56ab348ef6b5abd194d30c0ef4f2347327a9" title="df4c56ab348ef6b5abd194d30c0ef4f2347327a9">df4c56ab348ef6b5abd194d30c0ef4f2347327a9</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-26">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:26" class="cnum">
      <a href="10904.html#comment:26">comment:26</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-10T15%3A27%3A51Z&amp;precision=second" title="2015-02-10T15:27:51Z in Timeline">6 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-27">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:27" class="cnum">
      <a href="10904.html#comment:27">comment:27</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-10T16%3A33%3A25Z&amp;precision=second" title="2015-02-10T16:33:25Z in Timeline">6 years</a> ago by Martyn Gigg
                </h3>
                
    <div class="comment searchable">
      
      <p>
The script from the ticket works as expected and so do all of the methods on the new PeakShape class. I can see that most of the changes are due to the move of the <tt>SpecialCoordinateSystem</tt>. 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-28">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:28" class="cnum">
      <a href="10904.html#comment:28">comment:28</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-02-10T16%3A33%3A37Z&amp;precision=second" title="2015-02-10T16:33:37Z in Timeline">6 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Merge pull request <a class="closed ticket" href="196.html" title="enhancement: Rename qtiplot MantidPlot (closed: fixed)">#196</a> from mantidproject/feature/10904_apply_peak_shape
</p>
<p>
Full changeset: <a class="ext-link" href="https://github.com/mantidproject/mantid/commit/35142efce2f65370653d5b5d210ba1a6dedd7147"><span class="icon">â€‹</span>35142efce2f65370653d5b5d210ba1a6dedd7147</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-29">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:29" class="cnum">
      <a href="10904.html#comment:29">comment:29</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T04%3A15%3A49%2B01%3A00&amp;precision=second" title="2015-06-04T04:15:49+01:00 in Timeline">5 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
This ticket has been transferred to github issue <a class="ext-link" href="http://github.com/mantidproject/mantid/issues/11743"><span class="icon">â€‹</span>11743</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="../wiki/TracTickets.html">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/mantid/pygments/trac.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/10904?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/10904?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/10904?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.5</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>