<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #9389 (SpecularReflectionPositionCorrect algorithm)
     â€“ Mantid Project
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="prev" href="9388.html" title="Ticket #9388" />
        <link rel="last" href="11888.html" title="Ticket #11888" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/9389?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/9389?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/9389?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="9390.html" title="Ticket #9390" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="1.html" title="Ticket #1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Mantid Project" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="a82fe30e7bef2e30fd2838e9";
    </script>
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="../chrome/common/js/resizer.js"></script><script type="text/javascript" src="../chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/mantid/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 9389, escape_newlines: 0}
        $("#comment").autoPreview("/mantid/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/mantid/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.mantidproject.org/"><img src="../chrome/site/mantid_logo_with_name.png" alt="Mantid Logo" width="250" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.mantidproject.org/mantid/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="9388.html" title="Ticket #9388">Previous Ticket</a></span></li><li><span><a class="next" href="9390.html" title="Ticket #9390">Next Ticket</a> &rarr;</span></li><li class="last"><a href="../depgraph/9389.html">Depgraph</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="9389.html">Ticket #9389</a>
          <span class="status">(closed: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-29T10%3A52%3A26%2B01%3A00&amp;precision=second" title="2014-04-29T10:52:26+01:00 in Timeline">6 years</a> ago</p>
    <p>Last modified <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T03%3A16%3A11%2B01%3A00&amp;precision=second" title="2015-06-04T03:16:11+01:00 in Timeline">5 years</a> ago</p>
  </div>
  <h2 class="summary searchable">SpecularReflectionPositionCorrect algorithm</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;reporter=Owen+Arnold">Owen Arnold</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;owner=Owen+Arnold">Owen Arnold</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;priority=major">major</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="../milestone/Release&#32;3.2.html">Release 3.2</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;component=Framework">Framework</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby"><span></span></td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking"><span><a class="closed ticket" href="9184.html" title="ReflectometryReductionOne should correct positions">#9184</a>, <a class="closed ticket" href="9401.html" title="Theta calculation bug">#9401</a></span></td>
        <th id="h_tester">
          Tester:
        </th>
        <td headers="h_tester">
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
We can use the specular reflection condition to correct detector positions for both point detectors and multi detectors. 
</p>
<p>
Some of this functionality is already done in ReflectometryReductionOne, but is more generally useful than just applied there. This algorithm can then be used in ReflectometryReductionOne. It should also be much much easier to test this functionality if it's provided as a separate algorithm. 
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="9389.html#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-29T11%3A14%3A46%2B01%3A00&amp;precision=second" title="2014-04-29T11:14:46+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Summary</strong>
        changed from <em>ReflectometryCorrectDetectorPositions algorithm</em> to <em>SpecularReflectionPositionCorrect algorithm</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="9389.html#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T11%3A11%3A35%2B01%3A00&amp;precision=second" title="2014-04-30T11:11:35+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9389.html" title="enhancement: SpecularReflectionPositionCorrect algorithm (closed: fixed)">#9389</a>. New algorithm created.
</p>
<p>
Basic destructive unit tests added.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/508207651f6d83ab70a0ad879cf2b6fefd701f6b" title="508207651f6d83ab70a0ad879cf2b6fefd701f6b">508207651f6d83ab70a0ad879cf2b6fefd701f6b</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="9389.html#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T11%3A11%3A36%2B01%3A00&amp;precision=second" title="2014-04-30T11:11:36+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9389.html" title="enhancement: SpecularReflectionPositionCorrect algorithm (closed: fixed)">#9389</a>. Vertical correction working for single detector.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/48acf640ce99dedcccc5c62086dd61577f31e053" title="48acf640ce99dedcccc5c62086dd61577f31e053">48acf640ce99dedcccc5c62086dd61577f31e053</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="9389.html#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-06T15%3A37%3A07%2B01%3A00&amp;precision=second" title="2014-05-06T15:37:07+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9389.html" title="enhancement: SpecularReflectionPositionCorrect algorithm (closed: fixed)">#9389</a>. Implement moveComponent and test.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/35bd96436b166f683d6548c6a0a3f402e2d4cdca" title="35bd96436b166f683d6548c6a0a3f402e2d4cdca">35bd96436b166f683d6548c6a0a3f402e2d4cdca</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="9389.html#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-06T15%3A44%3A05%2B01%3A00&amp;precision=second" title="2014-05-06T15:44:05+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9389.html" title="enhancement: SpecularReflectionPositionCorrect algorithm (closed: fixed)">#9389</a>. Offseting working for linear as well as point detectors.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/90119d673881fbf87a71a4fb55f4589047a37b13" title="90119d673881fbf87a71a4fb55f4589047a37b13">90119d673881fbf87a71a4fb55f4589047a37b13</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="9389.html#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-07T09%3A46%3A51%2B01%3A00&amp;precision=second" title="2014-05-07T09:46:51+01:00 in Timeline">6 years</a> ago by Nick Draper
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>assigned</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="9389.html#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-07T15%3A33%3A54%2B01%3A00&amp;precision=second" title="2014-05-07T15:33:54+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>assigned</em> to <em>inprogress</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9389.html" title="enhancement: SpecularReflectionPositionCorrect algorithm (closed: fixed)">#9389</a>. Better documentation and testing.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/959b055e1b00681f6eb576b4d45effc1bdb8a864" title="959b055e1b00681f6eb576b4d45effc1bdb8a864">959b055e1b00681f6eb576b4d45effc1bdb8a864</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="9389.html#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-07T15%3A33%3A54%2B01%3A00&amp;precision=second" title="2014-05-07T15:33:54+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9389.html" title="enhancement: SpecularReflectionPositionCorrect algorithm (closed: fixed)">#9389</a>. Make input workspaces on the fly.
</p>
<p>
It's actually only the detector positions that we care about in this algorithm. Data is not important.
Therefore use LoadEmptyInstrument to indicate to future users and maintainers that this is the case. Should also be quicker than running Load.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/05b8f74748e18530fdf3e8b0fe46df40dd1c21cd" title="05b8f74748e18530fdf3e8b0fe46df40dd1c21cd">05b8f74748e18530fdf3e8b0fe46df40dd1c21cd</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="9389.html#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-07T15%3A46%3A21%2B01%3A00&amp;precision=second" title="2014-05-07T15:46:21+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9389.html" title="enhancement: SpecularReflectionPositionCorrect algorithm (closed: fixed)">#9389</a>. Fix warnings.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/1f409d36caad8188c74cbf49c30492195adc3269" title="1f409d36caad8188c74cbf49c30492195adc3269">1f409d36caad8188c74cbf49c30492195adc3269</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="9389.html#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-07T15%3A54%3A10%2B01%3A00&amp;precision=second" title="2014-05-07T15:54:10+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9389.html" title="enhancement: SpecularReflectionPositionCorrect algorithm (closed: fixed)">#9389</a>. Fix more warnings.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/9c86927092722f7acbfe9a39910b32ba0e76b376" title="9c86927092722f7acbfe9a39910b32ba0e76b376">9c86927092722f7acbfe9a39910b32ba0e76b376</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-11">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:11" class="cnum">
      <a href="9389.html#comment:11">comment:11</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-07T16%3A13%3A11%2B01%3A00&amp;precision=second" title="2014-05-07T16:13:11+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9389.html" title="enhancement: SpecularReflectionPositionCorrect algorithm (closed: fixed)">#9389</a>. Fix type conversion warnings.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/52db76ce7571360fdc6a7ccec3c61b08531d988c" title="52db76ce7571360fdc6a7ccec3c61b08531d988c">52db76ce7571360fdc6a7ccec3c61b08531d988c</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:12" class="cnum">
      <a href="9389.html#comment:12">comment:12</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-07T16%3A20%3A07%2B01%3A00&amp;precision=second" title="2014-05-07T16:20:07+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="9389.html" title="enhancement: SpecularReflectionPositionCorrect algorithm (closed: fixed)">#9389</a>. Fix type dereferencing rules.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/a147487b4f0979a34789ce48001bce5bdcdd0442" title="a147487b4f0979a34789ce48001bce5bdcdd0442">a147487b4f0979a34789ce48001bce5bdcdd0442</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-13">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:13" class="cnum">
      <a href="9389.html#comment:13">comment:13</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-08T08%3A52%3A14%2B01%3A00&amp;precision=second" title="2014-05-08T08:52:14+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
    <div class="comment searchable">
      
      <p>
Tester: The following shows this working. The unit tests also provide extensive testing scenarios.
</p>
<div class="code"><pre>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">sample_detector_vector</span><span class="p">(</span>ws<span class="p">):</span>
        inst <span class="o">=</span> ws<span class="o">.</span>getInstrument<span class="p">()</span>
        refFrame <span class="o">=</span> inst<span class="o">.</span>getReferenceFrame<span class="p">()</span>
        detector_pos<span class="o">=</span> inst<span class="o">.</span>getComponentByName<span class="p">(</span><span class="s">'point-detector'</span><span class="p">)</span><span class="o">.</span>getPos<span class="p">()</span>
        sample_pos <span class="o">=</span> inst<span class="o">.</span>getComponentByName<span class="p">(</span><span class="s">'some-surface-holder'</span><span class="p">)</span><span class="o">.</span>getPos<span class="p">()</span>
        sample_to_detector <span class="o">=</span> detector_pos <span class="o">-</span> sample_pos
        <span class="k">return</span> sample_to_detector
        
        
inst_dir <span class="o">=</span> config<span class="o">.</span>getInstrumentDirectory<span class="p">()</span>
<span class="nb">file</span> <span class="o">=</span> os<span class="o">.</span>path<span class="o">.</span>join<span class="p">(</span>inst_dir<span class="p">,</span> <span class="s">'POLREF_Definition.xml'</span><span class="p">)</span>
ws <span class="o">=</span> LoadEmptyInstrument<span class="p">(</span><span class="nb">file</span><span class="p">)</span>

MoveInstrumentComponent<span class="p">(</span>ws<span class="p">,</span> <span class="s">'point-detector'</span><span class="p">,</span> RelativePosition<span class="o">=</span><span class="bp">False</span><span class="p">,</span> X<span class="o">=</span><span class="mi">1</span><span class="p">)</span>
MoveInstrumentComponent<span class="p">(</span>ws<span class="p">,</span> <span class="s">'some-surface-holder'</span><span class="p">,</span> RelativePosition<span class="o">=</span><span class="bp">False</span><span class="p">,</span> X<span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">print</span> <span class="s">"Before Correction: "</span><span class="p">,</span> sample_detector_vector<span class="p">(</span>ws<span class="p">)</span>

ws <span class="o">=</span> SpecularReflectionPositionCorrect<span class="p">(</span>ws<span class="p">,</span> <span class="mi">45</span><span class="p">,</span> DetectorComponentName<span class="o">=</span><span class="s">'point-detector'</span><span class="p">,</span> SampleComponentName<span class="o">=</span><span class="s">'some-surface-holder'</span><span class="p">)</span>

<span class="k">print</span>  <span class="s">"After Correction: (45 degree angle)"</span><span class="p">,</span> sample_detector_vector<span class="p">(</span>ws<span class="p">)</span>
</pre></div>
    </div>

              </div>
              <div class="change" id="trac-change-14">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:14" class="cnum">
      <a href="9389.html#comment:14">comment:14</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-08T08%3A52%3A56%2B01%3A00&amp;precision=second" title="2014-05-08T08:52:56+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-15">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:15" class="cnum">
      <a href="9389.html#comment:15">comment:15</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-08T09%3A28%3A21%2B01%3A00&amp;precision=second" title="2014-05-08T09:28:21+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>9401</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
(In <a class="closed ticket" href="9401.html" title="enhancement: Theta calculation bug (closed: fixed)">#9401</a>) This is actually blocked by <a class="closed ticket" href="9389.html" title="enhancement: SpecularReflectionPositionCorrect algorithm (closed: fixed)">#9389</a>, because in order to fix this in a general way, we need to be able to determine an averaged vertical detector location as well as the sample location. The code to do this is already in SpecularReflectionCorrectPositions (9389). 
</p>
<ul><li>A first step to getting this done will be to extract out an algorithm base class called <strong>SpecularReflectionAlgorithm</strong> from <strong>SpecularReflectionCorrectPositions</strong>. This will provide two protected method and will otherwise virtual. Two methods are <strong>getDetectorComponent()</strong> and <strong>getSampleComponent()</strong>  
</li><li>Next step is to use the base class to create a new algorithm called <strong>SpecularReflectionCorrectTheta</strong>, which will use this base class.
</li><li>Next step is to wire this algorithm into <strong>ReflectometryReductionOne</strong> to replace to existing correction logic.
</li></ul>
    </div>

              </div>
              <div class="change" id="trac-change-16">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:16" class="cnum">
      <a href="9389.html#comment:16">comment:16</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-08T11%3A14%3A38%2B01%3A00&amp;precision=second" title="2014-05-08T11:14:38+01:00 in Timeline">6 years</a> ago by Peter Parker
                </h3>
                
    <div class="comment searchable">
      
      <p>
Code looked fine to me.  Unit tests are passing and seem to offer good coverage.
</p>
<p>
I had a play with the script, changing the magnitude and direction of the initial sample-detector vector, and those changes gave me different results.  There was no change in result for vectors in the Y-direction, but if I've understood the code correctly this is expected (as they lie "across" the beam).
</p>

    </div>

              </div>
              <div class="change" id="trac-change-17">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:17" class="cnum">
      <a href="9389.html#comment:17">comment:17</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-08T11%3A15%3A28%2B01%3A00&amp;precision=second" title="2014-05-08T11:15:28+01:00 in Timeline">6 years</a> ago by Peter Parker
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Merge remote-tracking branch 'origin/feature/9389_correct_positions_refl'
</p>
<p>
Full changeset: <a class="ext-link" href="https://github.com/mantidproject/mantid/commit/47f57aec41e954f7b94d3f2ad73cea1c859d9b48"><span class="icon">â€‹</span>47f57aec41e954f7b94d3f2ad73cea1c859d9b48</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-18">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:18" class="cnum">
      <a href="9389.html#comment:18">comment:18</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T03%3A16%3A11%2B01%3A00&amp;precision=second" title="2015-06-04T03:16:11+01:00 in Timeline">5 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
This ticket has been transferred to github issue <a class="ext-link" href="http://github.com/mantidproject/mantid/issues/10232"><span class="icon">â€‹</span>10232</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="../wiki/TracTickets.html">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/mantid/pygments/trac.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/9389?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/9389?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/9389?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.5</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>