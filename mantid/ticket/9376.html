<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #9376 (Create mantid dataset for published data)
     – Mantid Project
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="prev" href="9375.html" title="Ticket #9375" />
        <link rel="last" href="11888.html" title="Ticket #11888" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/9376?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/9376?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/9376?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="9377.html" title="Ticket #9377" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="1.html" title="Ticket #1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Mantid Project" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="a82fe30e7bef2e30fd2838e9";
    </script>
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="../chrome/common/js/resizer.js"></script><script type="text/javascript" src="../chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/mantid/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 9376, escape_newlines: 0}
        $("#comment").autoPreview("/mantid/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/mantid/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.mantidproject.org/"><img src="../chrome/site/mantid_logo_with_name.png" alt="Mantid Logo" width="250" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.mantidproject.org/mantid/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="9375.html" title="Ticket #9375">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="9377.html" title="Ticket #9377">Next Ticket</a> &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="9376.html">Ticket #9376</a>
          <span class="status">(closed: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-25T14%3A38%3A54%2B01%3A00&amp;precision=second" title="2014-04-25T14:38:54+01:00 in Timeline">6 years</a> ago</p>
    <p>Last modified <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T03%3A15%3A38%2B01%3A00&amp;precision=second" title="2015-06-04T03:15:38+01:00 in Timeline">5 years</a> ago</p>
  </div>
  <h2 class="summary searchable">Create mantid dataset for published data</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;reporter=Jay+Rainey">Jay Rainey</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;owner=Jay+Rainey">Jay Rainey</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;priority=major">major</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="../milestone/Release&#32;3.2.html">Release 3.2</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;component=Framework">Framework</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;keywords=~ICAT">ICAT</a>
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby"><span></span></td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking"><span></span></td>
        <th id="h_tester">
          Tester:
        </th>
        <td headers="h_tester">
              Peter Parker
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
      <span class="lastmod" title="2014-04-30 10:25:18.992304+00:00">
        (last modified by Jay Rainey)
        (<a href="https://trac.mantidproject.org/mantid/ticket/9376?action=diff&amp;version=16">diff</a>)
      </span>
    </h3>
    <div class="searchable">
      <p>
Currently, when <em>publishing</em> a datafile to the archives it is stored in the <a class="ext-link" href="https://github.com/mantidproject/mantid/blob/master/Code/Mantid/Framework/ICat/src/ICat4/ICat4Catalog.cpp#L887"><span class="icon">​</span>Default (first)</a> dataset alongside the raw experiment data. Instead, analyzed data published from Mantid should be stored in a separate dataset (named <tt>mantid</tt>). 
</p>
<p>
To achieve this, I need to:
</p>
<ol><li>Loop over the datasets for the specific investigation.
</li><li>Set the <a class="ext-link" href="https://github.com/mantidproject/mantid/blob/master/Code/Mantid/Framework/ICat/src/ICat4/ICat4Catalog.cpp#L862"><span class="icon">​</span>datasetID</a> to the dataset ID of the <tt>mantid</tt> dataset if it exists.
</li><li>When the loop is complete, check if datasetID is still it's default value. If it is, then no <tt>mantid</tt> dataset was found. As no dataset was found, we need to create one via <tt>createMantidDataset</tt><strong>*</strong>.
</li></ol><p>
<strong>*</strong>
This method will create a dataset named <tt>mantid</tt> for a given investigationID. I will need to call <tt>isAccessAllowed</tt> prior to <tt>create</tt> to verify if I can create the dataset. If I cannot then I should return -1 and output a <tt>notice()</tt>.
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="9376.html#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-25T14%3A40%3A27%2B01%3A00&amp;precision=second" title="2014-04-25T14:40:27+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Description</strong>
        modified (<a href="https://trac.mantidproject.org/mantid/ticket/9376?action=diff&amp;version=1">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="9376.html#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-25T14%3A41%3A51%2B01%3A00&amp;precision=second" title="2014-04-25T14:41:51+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Description</strong>
        modified (<a href="https://trac.mantidproject.org/mantid/ticket/9376?action=diff&amp;version=2">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="9376.html#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-25T16%3A43%3A25%2B01%3A00&amp;precision=second" title="2014-04-25T16:43:25+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>8538</em> removed
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="9376.html#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-29T15%3A16%3A54%2B01%3A00&amp;precision=second" title="2014-04-29T15:16:54+01:00 in Timeline">6 years</a> ago by Owen Arnold
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>assigned</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="9376.html#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T10%3A52%3A36%2B01%3A00&amp;precision=second" title="2014-04-30T10:52:36+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>assigned</em> to <em>inprogress</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Add generic isAccessAllowed method. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/459c6b01b5ca1950a2932e17ade79f4886281727" title="459c6b01b5ca1950a2932e17ade79f4886281727">459c6b01b5ca1950a2932e17ade79f4886281727</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="9376.html#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T10%3A52%3A37%2B01%3A00&amp;precision=second" title="2014-04-30T10:52:37+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
    <div class="comment searchable">
      
      <p>
Use isAccessAllowed for publish GUI. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/e753685a3932579bd3a1c223d561b0efa5779ae1" title="e753685a3932579bd3a1c223d561b0efa5779ae1">e753685a3932579bd3a1c223d561b0efa5779ae1</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="9376.html#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T10%3A52%3A37%2B01%3A00&amp;precision=second" title="2014-04-30T10:52:37+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
    <div class="comment searchable">
      
      <p>
Add a method to search ICAT. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/6848ee831f915cb238f620360acc36166032c589" title="6848ee831f915cb238f620360acc36166032c589">6848ee831f915cb238f620360acc36166032c589</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="9376.html#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T10%3A52%3A37%2B01%3A00&amp;precision=second" title="2014-04-30T10:52:37+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
    <div class="comment searchable">
      
      <p>
Use new search method. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8cc230e68bff91581e405b38ee780854c0dc43cc" title="8cc230e68bff91581e405b38ee780854c0dc43cc">8cc230e68bff91581e405b38ee780854c0dc43cc</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="9376.html#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T10%3A52%3A37%2B01%3A00&amp;precision=second" title="2014-04-30T10:52:37+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
    <div class="comment searchable">
      
      <p>
Forgot to add search to getMantidDatasetId. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/1aa471c75442a95e4786f9db4487d073dd193e55" title="1aa471c75442a95e4786f9db4487d073dd193e55">1aa471c75442a95e4786f9db4487d073dd193e55</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="9376.html#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T10%3A52%3A37%2B01%3A00&amp;precision=second" title="2014-04-30T10:52:37+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
    <div class="comment searchable">
      
      <p>
Tidy return logic. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/c2e738a2345dc9965b25b11c8318e4411c730ae1" title="c2e738a2345dc9965b25b11c8318e4411c730ae1">c2e738a2345dc9965b25b11c8318e4411c730ae1</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-11">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:11" class="cnum">
      <a href="9376.html#comment:11">comment:11</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T10%3A52%3A37%2B01%3A00&amp;precision=second" title="2014-04-30T10:52:37+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
    <div class="comment searchable">
      
      <p>
Removed unnecessary icat4 namespace prefixes. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/21e18466616766eb95a9016b0a413905031bead1" title="21e18466616766eb95a9016b0a413905031bead1">21e18466616766eb95a9016b0a413905031bead1</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:12" class="cnum">
      <a href="9376.html#comment:12">comment:12</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T10%3A52%3A37%2B01%3A00&amp;precision=second" title="2014-04-30T10:52:37+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
    <div class="comment searchable">
      
      <p>
Remove debug statement. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/61a88e9cc900ac82c5d9dd02690fcf311a1f7295" title="61a88e9cc900ac82c5d9dd02690fcf311a1f7295">61a88e9cc900ac82c5d9dd02690fcf311a1f7295</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-13">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:13" class="cnum">
      <a href="9376.html#comment:13">comment:13</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T10%3A52%3A38%2B01%3A00&amp;precision=second" title="2014-04-30T10:52:38+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
    <div class="comment searchable">
      
      <p>
Move method to align with header order. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/eb99ecc435d563d5c6921ca350c1942f410cfbee" title="eb99ecc435d563d5c6921ca350c1942f410cfbee">eb99ecc435d563d5c6921ca350c1942f410cfbee</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-14">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:14" class="cnum">
      <a href="9376.html#comment:14">comment:14</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T10%3A52%3A38%2B01%3A00&amp;precision=second" title="2014-04-30T10:52:38+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
    <div class="comment searchable">
      
      <p>
Added createMantidDataset method. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/1bc871a666e800197da79c619d0af94edf544c8a" title="1bc871a666e800197da79c619d0af94edf544c8a">1bc871a666e800197da79c619d0af94edf544c8a</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-15">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:15" class="cnum">
      <a href="9376.html#comment:15">comment:15</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T10%3A53%3A26%2B01%3A00&amp;precision=second" title="2014-04-30T10:53:26+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
    <div class="comment searchable">
      
      <p>
Create a mantid dataset if none exist. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/2a4fe517a558b7ec3f0a7c93b1d0801f58b2d352" title="2a4fe517a558b7ec3f0a7c93b1d0801f58b2d352">2a4fe517a558b7ec3f0a7c93b1d0801f58b2d352</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-16">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:16" class="cnum">
      <a href="9376.html#comment:16">comment:16</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T11%3A25%3A18%2B01%3A00&amp;precision=second" title="2014-04-30T11:25:18+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Description</strong>
        modified (<a href="https://trac.mantidproject.org/mantid/ticket/9376?action=diff&amp;version=16">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-17">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:17" class="cnum">
      <a href="9376.html#comment:17">comment:17</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T12%3A55%3A21%2B01%3A00&amp;precision=second" title="2014-04-30T12:55:21+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Added debugging statements for publishing. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/dafe1289b589b0503798adc45f2b351b78a6d63a" title="dafe1289b589b0503798adc45f2b351b78a6d63a">dafe1289b589b0503798adc45f2b351b78a6d63a</a>
</p>

    </div>

                <div class="trac-lastedit ">
                  Last edited <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T13%3A29%3A56%2B01%3A00&amp;precision=second" title="2014-04-30T13:29:56+01:00 in Timeline">6 years</a> ago
                      by Jay Rainey
                    (<a href="https://trac.mantidproject.org/mantid/ticket/9376?cversion=0&amp;cnum_hist=17#comment:17">previous</a>)
                    (<a href="https://trac.mantidproject.org/mantid/ticket/9376?action=comment-diff&amp;cnum=17&amp;version=1">diff</a>)
                </div>
              </div>
              <div class="change" id="trac-change-18">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:18" class="cnum">
      <a href="9376.html#comment:18">comment:18</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T13%3A27%3A59%2B01%3A00&amp;precision=second" title="2014-04-30T13:27:59+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
    <div class="comment searchable">
      
      <h2 id="Overview">Overview</h2>
<p>
This ticket deals with separating analyzed data and experimental data in ICAT. I have opted to create a new dataset (named <tt>mantid</tt>) for the investigation the user wants to relate files to when they try to publish data. If the <tt>mantid</tt> dataset already exists, then we <tt>PUT</tt> the files there.
</p>
<h3 id="Testingpublishingfunctionality">Testing publishing functionality</h3>
<p>
<strong>Note:</strong> You must use the mantid ICAT test account to verify this ticket as it has an investigation in <tt>my data</tt>.
</p>
<ol><li>Open the <tt>Search</tt> GUI and check <tt>My Data only</tt>. Ensure that <tt>Instrument name</tt> is empty. (This way it will return all investigations).
</li><li>Copy the <tt>Investigation ID</tt> of <tt>Mantid Test Investigation</tt>. (It's <strong>1193002</strong>).
</li><li>From the <tt>Algorithms</tt> menu enter <tt>CatalogGetDataSets</tt>.
</li><li>Enter the copied investigation ID (<strong>1193002</strong>) into the <tt>InvestigationID</tt> field, and input <tt>testingTicket</tt> into the <tt>OutputWorkspace</tt> field and click <tt>Run</tt>.
</li><li>Right click the workspace and click <tt>Show data</tt>. Observe that there are two datasets for this specific investigation, and take note of the <tt>Number of datafiles</tt> in the <tt>mantid</tt> dataset.
</li><li>Open the publish dialog and publish a datafile.
</li><li>Execute <tt>CatalogGetDataSets</tt> again as above, and observe that the <tt>Number of datafiles</tt> in <tt>mantid</tt> has increased. This proves that datafiles are not published to the <tt>mantid</tt> dataset.
</li><li>Use the <tt>Search</tt> GUI to find the datafile you just published, and load it into Mantid.
</li></ol><h3 id="Testingsearchingfunctionality">Testing searching functionality</h3>
<p>
As the <tt>createMantidDataset</tt> performs several actions (to ensure <tt>create</tt> is successful and valid) I re-factored the searching of ICAT into a separate method named <tt>performSearch</tt>. As such, all ICAT functionality that performs searches will also have to be tested, which includes:
</p>
<ol><li><tt>Instrument name</tt> is populated correctly via <tt>CatalogListInstruments</tt> on the ICAT GUI.
</li><li><tt>Investigation type</tt> is populated correctly via <tt>CatalogListInvestigationTypes</tt> on the ICAT GUI.
</li><li>Perform searches on the ICAT GUI works correctly.
</li><li>Publishing datafiles works correctly (<tt>getMantidDatasetId</tt> is used to search for the dataset ID of the investigation to publish to).
</li><li><tt>CatalogMyData</tt> needs to be run via the <tt>Algorithms</tt> menu.
</li></ol><p>
Perform a code review to ensure the changes made are sensible.
</p>

    </div>

                <div class="trac-lastedit ">
                  Last edited <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T13%3A29%3A48%2B01%3A00&amp;precision=second" title="2014-04-30T13:29:48+01:00 in Timeline">6 years</a> ago
                      by Jay Rainey
                    (<a href="https://trac.mantidproject.org/mantid/ticket/9376?cversion=0&amp;cnum_hist=18#comment:18">previous</a>)
                    (<a href="https://trac.mantidproject.org/mantid/ticket/9376?action=comment-diff&amp;cnum=18&amp;version=1">diff</a>)
                </div>
              </div>
              <div class="change" id="trac-change-19">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:19" class="cnum">
      <a href="9376.html#comment:19">comment:19</a>
    </span>
                          <span>follow-up:</span>
      <a href="9376.html#comment:26">↓ 26</a>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T15%3A17%3A17%2B01%3A00&amp;precision=second" title="2014-04-30T15:17:17+01:00 in Timeline">6 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
There's an Intel compiler warning here that shows why it's better to always put brackets around if-else clauses even if they're only one line:
</p>
<p>
<a class="ext-link" href="http://builds.mantidproject.org/job/develop_incremental/label=osx-10.8-build/110/warnings24Result/"><span class="icon">​</span>http://builds.mantidproject.org/job/develop_incremental/label=osx-10.8-build/110/warnings24Result/</a>?
</p>

    </div>

              </div>
              <div class="change" id="trac-change-20">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:20" class="cnum">
      <a href="9376.html#comment:20">comment:20</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T15%3A17%3A21%2B01%3A00&amp;precision=second" title="2014-04-30T15:17:21+01:00 in Timeline">6 years</a> ago by Russell Taylor
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>reopened</em>
    </li><li>
      <strong>Resolution</strong>
        <em>fixed</em> deleted
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-21">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:21" class="cnum">
      <a href="9376.html#comment:21">comment:21</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T15%3A23%3A58%2B01%3A00&amp;precision=second" title="2014-04-30T15:23:58+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>reopened</em> to <em>inprogress</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Add braces to address Intel compiler warning. Refs <a class="closed ticket" href="9376.html" title="enhancement: Create mantid dataset for published data (closed: fixed)">#9376</a>.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/770ab5bda8cdecbb2ae9bed32bd86a0d6b3f374c" title="770ab5bda8cdecbb2ae9bed32bd86a0d6b3f374c">770ab5bda8cdecbb2ae9bed32bd86a0d6b3f374c</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-22">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:22" class="cnum">
      <a href="9376.html#comment:22">comment:22</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-04-30T16%3A15%3A48%2B01%3A00&amp;precision=second" title="2014-04-30T16:15:48+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-23">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:23" class="cnum">
      <a href="9376.html#comment:23">comment:23</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-02T13%3A21%3A27%2B01%3A00&amp;precision=second" title="2014-05-02T13:21:27+01:00 in Timeline">6 years</a> ago by Peter Parker
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        set to <em>Peter Parker</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-24">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:24" class="cnum">
      <a href="9376.html#comment:24">comment:24</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-02T14%3A55%3A42%2B01%3A00&amp;precision=second" title="2014-05-02T14:55:42+01:00 in Timeline">6 years</a> ago by Peter Parker
                </h3>
                
    <div class="comment searchable">
      
      <p>
Changes are sensible.  New functionality works as expected and the existing search functionality seems to be unaffected.
</p>
<p>
Closing.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-25">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:25" class="cnum">
      <a href="9376.html#comment:25">comment:25</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-02T14%3A57%3A20%2B01%3A00&amp;precision=second" title="2014-05-02T14:57:20+01:00 in Timeline">6 years</a> ago by Peter Parker
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Merge remote-tracking branch 'origin/feature/9376_icat_create_mantid_dataset'
</p>
<p>
Full changeset: <a class="ext-link" href="https://github.com/mantidproject/mantid/commit/0455fbf70e139c22cde2c2b368c1de8fcc280d98"><span class="icon">​</span>0455fbf70e139c22cde2c2b368c1de8fcc280d98</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-26">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:26" class="cnum">
      <a href="9376.html#comment:26">comment:26</a>
    </span>
                        in reply to:
      <a href="9376.html#comment:19">↑ 19</a>
                        ;
                          <span>follow-up:</span>
      <a href="9376.html#comment:27">↓ 27</a>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-02T15%3A08%3A45%2B01%3A00&amp;precision=second" title="2014-05-02T15:08:45+01:00 in Timeline">6 years</a> ago by Peter Parker
                </h3>
                
    <div class="comment searchable">
      
      <p>
Replying to <a href="9376.html#comment:19" title="Comment 19 for Ticket #9376">Russell Taylor</a>:
</p>
<blockquote class="citation">
<p>
There's an Intel compiler warning here that shows why it's better to always put brackets around if-else clauses even if they're only one line:
</p>
<p>
<a class="ext-link" href="http://builds.mantidproject.org/job/develop_incremental/label=osx-10.8-build/110/warnings24Result/"><span class="icon">​</span>http://builds.mantidproject.org/job/develop_incremental/label=osx-10.8-build/110/warnings24Result/</a>?
</p>
</blockquote>
<p>
I'm not wholly convinced this is an argument against bracket-less condition statements (which, I'll admit, I like and use a lot).  Surely the code before and after Jay's fix is logically equivalent as per the standard and so it is the compiler at fault here?
</p>
<p>
Are there other reasons why we should be avoiding them?  It seems to me they're as easy / hard to read as condition statements in Python, and that always adding brackets as a rule takes more effort than only adding brackets when they're necessary.  I am open to other arguments, though.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-27">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:27" class="cnum">
      <a href="9376.html#comment:27">comment:27</a>
    </span>
                        in reply to:
      <a href="9376.html#comment:26">↑ 26</a>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-02T15%3A28%3A27%2B01%3A00&amp;precision=second" title="2014-05-02T15:28:27+01:00 in Timeline">6 years</a> ago by Jay Rainey
                </h3>
                
    <div class="comment searchable">
      
      <p>
Replying to <a href="9376.html#comment:26" title="Comment 26 for Ticket #9376">Peter Parker</a>:
</p>
<p>
The Intel error above was not related to braces. I wrote a short-hand <tt>if/else</tt> and forgot to put a return statement in the <tt>else</tt> after I commented out the return method (as it did not exist on develop, e.g. something like <a class="ext-link" href="https://github.com/mantidproject/mantid/blob/develop/Code/Mantid/Framework/ICat/src/ICat4/ICat4Catalog.cpp#L943-946"><span class="icon">​</span>this</a>). 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-28">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:28" class="cnum">
      <a href="9376.html#comment:28">comment:28</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-02T16%3A30%3A17%2B01%3A00&amp;precision=second" title="2014-05-02T16:30:17+01:00 in Timeline">6 years</a> ago by Russell Taylor
                </h3>
                
    <div class="comment searchable">
      
      <p>
The code that triggered the warning looked like this:
</p>
<pre class="wiki">905       if (icat.search(&amp;request,&amp;response) == SOAP_OK)
906         searchResults = response.return_;
907       else
908         // throwErrorMessage(icat);
909 
910       return searchResults;
</pre><p>
Because whitespace doesn't matter, the return statement 'belonged' to the else clause, and the if path was then missing any return statement, triggering the warning.
</p>
<p>
If there had been braces then the commenting out would have left an empty else clause, so perhaps my comment should have also been that tickets shouldn't be closed with commented out code (though in this case I think develop had somehow diverged anyway so this code wasn't in the branch).
</p>
<p>
I tend not to like brace-less single line if-elses because of the risk that someone will add a line and it will not do what they expect. What I often do for these is put them on the same line, i.e.:
</p>
<pre class="wiki">  if (test) doSomething;
  else doSomethingElse;
</pre>
    </div>

              </div>
              <div class="change" id="trac-change-29">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:29" class="cnum">
      <a href="9376.html#comment:29">comment:29</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-05-02T17%3A12%3A03%2B01%3A00&amp;precision=second" title="2014-05-02T17:12:03+01:00 in Timeline">6 years</a> ago by Peter Parker
                </h3>
                
    <div class="comment searchable">
      
      <p>
Okay, thanks for the clarification guys.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-30">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:30" class="cnum">
      <a href="9376.html#comment:30">comment:30</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T03%3A15%3A38%2B01%3A00&amp;precision=second" title="2015-06-04T03:15:38+01:00 in Timeline">5 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
This ticket has been transferred to github issue <a class="ext-link" href="http://github.com/mantidproject/mantid/issues/10219"><span class="icon">​</span>10219</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="../wiki/TracTickets.html">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/9376?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/9376?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/9376?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.5</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>