<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #10200 (Add property LeastMaxPeakObsY to FindPeaks)
     – Mantid Project
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="prev" href="10199.html" title="Ticket #10199" />
        <link rel="last" href="11888.html" title="Ticket #11888" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/10200?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/10200?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/10200?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="10201.html" title="Ticket #10201" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="1.html" title="Ticket #1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Mantid Project" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="a82fe30e7bef2e30fd2838e9";
    </script>
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="../chrome/common/js/resizer.js"></script><script type="text/javascript" src="../chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/mantid/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 10200, escape_newlines: 0}
        $("#comment").autoPreview("/mantid/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/mantid/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.mantidproject.org/"><img src="../chrome/site/mantid_logo_with_name.png" alt="Mantid Logo" width="250" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.mantidproject.org/mantid/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="10199.html" title="Ticket #10199">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="10201.html" title="Ticket #10201">Next Ticket</a> &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="10200.html">Ticket #10200</a>
          <span class="status">(closed: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-09-02T21%3A12%3A42%2B01%3A00&amp;precision=second" title="2014-09-02T21:12:42+01:00 in Timeline">6 years</a> ago</p>
    <p>Last modified <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T03%3A49%3A34%2B01%3A00&amp;precision=second" title="2015-06-04T03:49:34+01:00 in Timeline">5 years</a> ago</p>
  </div>
  <h2 class="summary searchable">Add property LeastMaxPeakObsY to FindPeaks</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;reporter=Wenduo+Zhou">Wenduo Zhou</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;owner=Wenduo+Zhou">Wenduo Zhou</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;priority=critical">critical</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="../milestone/Release&#32;3.3.html">Release 3.3</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;component=Diffraction">Diffraction</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
              petersonpf@…
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby"><span></span></td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking"><span></span></td>
        <th id="h_tester">
          Tester:
        </th>
        <td headers="h_tester">
              Roman Tolchenov
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
Add property LeastMaxPeakObsY to FindPeaks.  This property will specify the minimum value of the maximum Y value of peak within specified range.  By it, a peak with small maximum counts on Y can be excluded.  It is useful for EventWorkspace with integer counts on each bin. 
</p>
<p>
Propagate this new property to GetDetOffsetsMultiPeaks and CalibrateRectangularDetector. 
</p>

    </div>
  </div>
</div>
          
    <div id="attachments">
        <h2 class="foldable">Attachments</h2>
        <div>
          <dl class="attachments">
              <dt>
    <a href="../attachment/ticket/10200/verify10200.py.html" title="View attachment">verify10200.py</a><a href="../raw-attachment/ticket/10200/verify10200.py" class="trac-rawlink" title="Download">​</a>
       (<span title="684 bytes">684 bytes</span>) -
      added by <em>Wenduo Zhou</em> <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-09-30T18%3A28%3A01%2B01%3A00&amp;precision=second" title="2014-09-30T18:28:01+01:00 in Timeline">6 years</a> ago.
  </dt>
          </dl>
          
        </div>
    </div>

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="10200.html#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-09-03T13%3A31%3A51%2B01%3A00&amp;precision=second" title="2014-09-03T13:31:51+01:00 in Timeline">6 years</a> ago by Peter Peterson
                </h3>
                
    <div class="comment searchable">
      
      <p>
That is a pretty bad name. How about "MinimumPeakHeightObs" since it is parallel to "MinimumPeakHeight".
</p>

    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="10200.html#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-09-03T21%3A36%3A02%2B01%3A00&amp;precision=second" title="2014-09-03T21:36:02+01:00 in Timeline">6 years</a> ago by Wenduo Zhou
                </h3>
                
    <div class="comment searchable">
      
      <p>
Refs <a class="closed ticket" href="10200.html" title="Add property LeastMaxPeakObsY to FindPeaks (closed: fixed)">#10200</a>.  Added property MinimumPeakHeightObs.
</p>
<p>
To FindPeaks, GetDetOffsetsMultiPeak and CalibrateRectangularDetectors.
On branch feature/10200_findpeaks_min_maxobsy
Changes to be committed:
</p>
<blockquote>
<p>
modified:   ../Mantid/Framework/Algorithms/inc/MantidAlgorithms/FindPeaks.h
modified:   ../Mantid/Framework/Algorithms/inc/MantidAlgorithms/GetDetOffsetsMultiPeaks.h
modified:   ../Mantid/Framework/Algorithms/src/FindPeaks.cpp
modified:   ../Mantid/Framework/Algorithms/src/GetDetOffsetsMultiPeaks.cpp
modified:   ../Mantid/Framework/PythonInterface/plugins/algorithms/CalibrateRectangularDetectors.py
</p>
</blockquote>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/3d0dd68a3ec9b3efff298516ea95271fb5f089ab" title="3d0dd68a3ec9b3efff298516ea95271fb5f089ab">3d0dd68a3ec9b3efff298516ea95271fb5f089ab</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="10200.html#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-09-04T22%3A18%3A08%2B01%3A00&amp;precision=second" title="2014-09-04T22:18:08+01:00 in Timeline">6 years</a> ago by Wenduo Zhou
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>assigned</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="10200.html#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-09-10T17%3A10%3A42%2B01%3A00&amp;precision=second" title="2014-09-10T17:10:42+01:00 in Timeline">6 years</a> ago by Wenduo Zhou
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>assigned</em> to <em>inprogress</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="10200.html#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-09-30T18%3A27%3A45%2B01%3A00&amp;precision=second" title="2014-09-30T18:27:45+01:00 in Timeline">6 years</a> ago by Wenduo Zhou
                </h3>
                
    <div class="comment searchable">
      
      <h2 id="Fortester">For tester</h2>
<p>
The purpose of this ticket is to add one more criteria on finding peaks.  With the new property MinimumPeakHeightOBs, the peaks, whose maximum observed intensities are lower than specified value, will not be considered.  It is good to avoid to fit noise as peak. 
</p>
<p>
You can download verify10200.py.  Inside the script, a mockup workspace is created.  Peaks are fit with and without the new option.  You can tell the difference easily. 
</p>

    </div>

              </div>
              <div class="change">
                <h3 class="change">
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-09-30T18%3A28%3A01%2B01%3A00&amp;precision=second" title="2014-09-30T18:28:01+01:00 in Timeline">6 years</a> ago by Wenduo Zhou
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Attachment</strong>
        <a href="../attachment/ticket/10200/verify10200.py.html"><em>verify10200.py</em></a><a href="../raw-attachment/ticket/10200/verify10200.py" title="Download" class="trac-rawlink">​</a>
          added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="10200.html#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-09-30T18%3A28%3A13%2B01%3A00&amp;precision=second" title="2014-09-30T18:28:13+01:00 in Timeline">6 years</a> ago by Wenduo Zhou
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="10200.html#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-10-03T14%3A07%3A01%2B01%3A00&amp;precision=second" title="2014-10-03T14:07:01+01:00 in Timeline">6 years</a> ago by Roman Tolchenov
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        set to <em>Roman Tolchenov</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="10200.html#comment:8">comment:8</a>
    </span>
                          <span>follow-up:</span>
      <a href="10200.html#comment:9">↓ 9</a>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-10-03T15%3A08%3A37%2B01%3A00&amp;precision=second" title="2014-10-03T15:08:37+01:00 in Timeline">6 years</a> ago by Roman Tolchenov
                </h3>
                
    <div class="comment searchable">
      
      <p>
A couple of questions:
</p>
<ul><li>FindPeaks with the new option leaves a row filled with zeros. Is it possible not to output this row at all?
</li><li>I ran FindPeaks without PeaksPositions. The new option doesn't make a difference. Is it expected?
</li></ul>
    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="10200.html#comment:9">comment:9</a>
    </span>
                        in reply to:
      <a href="10200.html#comment:8">↑ 8</a>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-10-03T16%3A23%3A47%2B01%3A00&amp;precision=second" title="2014-10-03T16:23:47+01:00 in Timeline">6 years</a> ago by Wenduo Zhou
                </h3>
                
    <div class="comment searchable">
      
      <p>
Replying to <a href="10200.html#comment:8" title="Comment 8 for Ticket #10200">Roman Tolchenov</a>:
</p>
<blockquote class="citation">
<p>
A couple of questions:
</p>
<ul><li>FindPeaks with the new option leaves a row filled with zeros. Is it possible not to output this row at all?
</li></ul></blockquote>
<p>
FindPeaks is called intensively by GetDetOffsetsMultiPeaks, which specifies a list of peak positions to find.  I used the zero-value row to indicate that the fit to a certain peak fails, i.e., no peak is found at that position.  Such that it won't be considered.  Without the zero-value row, it is difficult to have the mapping between input peaks positions and output fitted peak positions. 
</p>
<blockquote class="citation">
<ul><li>I ran FindPeaks without PeaksPositions. The new option doesn't make a difference. Is it expected?
</li></ul></blockquote>
<p>
It is an expected behavior.  If FindPeaks is run without PeakPositions, then an algorithm is used to search peak automatically.  Usually it'd rather miss a peak than fit to tiny peak close to noise. 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="10200.html#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-10-03T16%3A29%3A45%2B01%3A00&amp;precision=second" title="2014-10-03T16:29:45+01:00 in Timeline">6 years</a> ago by Roman Tolchenov
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Merge remote-tracking branch 'origin/feature/10200_findpeaks_min_maxobsy'
</p>
<p>
Full changeset: <a class="ext-link" href="https://github.com/mantidproject/mantid/commit/280f1ba70bf8f9ea31e4210f4933144598242ed8"><span class="icon">​</span>280f1ba70bf8f9ea31e4210f4933144598242ed8</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-11">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:11" class="cnum">
      <a href="10200.html#comment:11">comment:11</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2014-10-06T15%3A06%3A39%2B01%3A00&amp;precision=second" title="2014-10-06T15:06:39+01:00 in Timeline">6 years</a> ago by Roman Tolchenov
                </h3>
                
    <div class="comment searchable">
      
      <p>
Merge remote-tracking branch 'origin/feature/10200_findpeaks_min_maxobsy'
</p>
<p>
Full changeset: <a class="ext-link" href="https://github.com/mantidproject/mantid/commit/280f1ba70bf8f9ea31e4210f4933144598242ed8"><span class="icon">​</span>280f1ba70bf8f9ea31e4210f4933144598242ed8</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:12" class="cnum">
      <a href="10200.html#comment:12">comment:12</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T03%3A49%3A34%2B01%3A00&amp;precision=second" title="2015-06-04T03:49:34+01:00 in Timeline">5 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
This ticket has been transferred to github issue <a class="ext-link" href="http://github.com/mantidproject/mantid/issues/11042"><span class="icon">​</span>11042</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="../wiki/TracTickets.html">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/10200?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/10200?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/10200?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.5</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>