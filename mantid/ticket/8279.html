<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #8279 (Can no longer plot the Spectra of a Group Workspace)
     – Mantid Project
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="prev" href="8278.html" title="Ticket #8278" />
        <link rel="last" href="11888.html" title="Ticket #11888" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/8279?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/8279?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/8279?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="8280.html" title="Ticket #8280" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="1.html" title="Ticket #1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Mantid Project" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="a82fe30e7bef2e30fd2838e9";
    </script>
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="../chrome/common/js/resizer.js"></script><script type="text/javascript" src="../chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/mantid/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 8279, escape_newlines: 0}
        $("#comment").autoPreview("/mantid/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/mantid/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.mantidproject.org/"><img src="../chrome/site/mantid_logo_with_name.png" alt="Mantid Logo" width="250" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.mantidproject.org/mantid/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="8278.html" title="Ticket #8278">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="8280.html" title="Ticket #8280">Next Ticket</a> &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="8279.html">Ticket #8279</a>
          <span class="status">(closed: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-29T15%3A27%3A53Z&amp;precision=second" title="2013-10-29T15:27:53Z in Timeline">7 years</a> ago</p>
    <p>Last modified <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T02%3A30%3A11%2B01%3A00&amp;precision=second" title="2015-06-04T02:30:11+01:00 in Timeline">5 years</a> ago</p>
  </div>
  <h2 class="summary searchable">Can no longer plot the Spectra of a Group Workspace</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;reporter=Peter+Parker">Peter Parker</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;owner=Peter+Parker">Peter Parker</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;priority=critical">critical</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="../milestone/Release&#32;3.0.html">Release 3.0</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;component=GUI">GUI</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby"><span></span></td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking"><span></span></td>
        <th id="h_tester">
          Tester:
        </th>
        <td headers="h_tester">
              Karl Palmen
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
      <span class="lastmod" title="2013-10-29 15:53:12.879576+00:00">
        (last modified by Peter Parker)
        (<a href="https://trac.mantidproject.org/mantid/ticket/8279?action=diff&amp;version=1">diff</a>)
      </span>
    </h3>
    <div class="searchable">
      <p>
To reproduce, load MUSR00015193 from the AutoTestData directory.  Right-click on the resulting GroupWorkspace, and select "Plot Spectrum...".  You will be unable to plot any of the spectra since for some reason it doesn't detect any "common" spectra between them.
</p>
<p>
Note that selecting the child workspaces individually works fine.
</p>
<p>
EDIT
</p>
<p>
Even worse, I've just discovered that if you select a GroupWorkspace and one of its child workspaces, then try to plot spectra, then Mantid crashes.
</p>

    </div>
  </div>
</div>
          
    <div id="attachments">
        <h2 class="foldable">Attachments</h2>
        <div>
          <dl class="attachments">
              <dt>
    <a href="../attachment/ticket/8279/Test&#32;Plot&#32;Spectra.py.html" title="View attachment">Test Plot Spectra.py</a><a href="../raw-attachment/ticket/8279/Test&#32;Plot&#32;Spectra.py" class="trac-rawlink" title="Download">​</a>
       (<span title="1245 bytes">1.2 KB</span>) -
      added by <em>Peter Parker</em> <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-30T12%3A15%3A10Z&amp;precision=second" title="2013-10-30T12:15:10Z in Timeline">7 years</a> ago.
  </dt>
          </dl>
          
        </div>
    </div>

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="8279.html#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-29T15%3A53%3A12Z&amp;precision=second" title="2013-10-29T15:53:12Z in Timeline">7 years</a> ago by Peter Parker
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Description</strong>
        modified (<a href="https://trac.mantidproject.org/mantid/ticket/8279?action=diff&amp;version=1">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="8279.html#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-30T11%3A31%3A28Z&amp;precision=second" title="2013-10-30T11:31:28Z in Timeline">7 years</a> ago by Peter Parker
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Milestone</strong>
        changed from <em>Backlog</em> to <em>Release 3.0</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Not sure why I set to backlog.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="8279.html#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-30T12%3A11%3A38Z&amp;precision=second" title="2013-10-30T12:11:38Z in Timeline">7 years</a> ago by Peter Parker
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>inprogress</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Refs <a class="closed ticket" href="8279.html" title="defect: Can no longer plot the Spectra of a Group Workspace (closed: fixed)">#8279</a> - Fix crash and undesired behaviour.
</p>
<p>
Ultimately, the problems were caused as a result of code I wrote nearly
two years ago.  It was some of the first C++ and Mantid code I ever did,
and it really does show.  Overengineered in places and underengineered in
others, redundant code, useless abstractions, and poor use of common
idioms.  Just awful.
</p>
<p>
I'd love a chance to go back and redo it, and probably make it a third of
the size in the process.
</p>
<p>
In the meantime, I've made the following changes:
</p>
<ul><li>Correctly filtered the workspaces that have been selected by the user to exclude non-MatrixWorkspaces.  This means including the children of WorkspaceGroups and excluding WorkspaceGroups themselves.
</li></ul><ul><li>Correctly find the common spectra IDs between selected workspaces.
</li></ul><ul><li>Only offer the user the chance to select spectra IDs to plot if there are indeed common IDs between all selected workspaces.  Otherwise just allow selection of common workspace indices.
</li></ul><ul><li>If workspaces only share a single common workspace index (and don't share any common spectra IDs), or if all workspaces only have a single spectrum, then just go ahead and plot them.  No need to ask the user at this point.
</li></ul><p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/b12631b7fe6f78d45d9ad85fa8982da895a7bba3" title="b12631b7fe6f78d45d9ad85fa8982da895a7bba3">b12631b7fe6f78d45d9ad85fa8982da895a7bba3</a>
</p>

    </div>

                <div class="trac-lastedit ">
                  Last edited <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-30T12%3A13%3A24Z&amp;precision=second" title="2013-10-30T12:13:24Z in Timeline">7 years</a> ago
                      by Peter Parker
                    (<a href="https://trac.mantidproject.org/mantid/ticket/8279?cversion=0&amp;cnum_hist=3#comment:3">previous</a>)
                    (<a href="https://trac.mantidproject.org/mantid/ticket/8279?action=comment-diff&amp;cnum=3&amp;version=1">diff</a>)
                </div>
              </div>
              <div class="change">
                <h3 class="change">
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-30T12%3A15%3A10Z&amp;precision=second" title="2013-10-30T12:15:10Z in Timeline">7 years</a> ago by Peter Parker
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Attachment</strong>
        <a href="../attachment/ticket/8279/Test&#32;Plot&#32;Spectra.py.html"><em>Test Plot Spectra.py</em></a><a href="../raw-attachment/ticket/8279/Test&#32;Plot&#32;Spectra.py" title="Download" class="trac-rawlink">​</a>
          added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="8279.html#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-30T12%3A43%3A14Z&amp;precision=second" title="2013-10-30T12:43:14Z in Timeline">7 years</a> ago by Peter Parker
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>inprogress</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
<strong>To Test:</strong>
</p>
<p>
Run the attached script to generate some workspaces with various spectra IDs.  Try to plot various combinations of workspaces and see if you get reasonable choices presented to you by the dialog, or whether the plot is done automatically.
</p>
<p>
See the comment for the commit above for how the dialog is supposed to behave.
</p>
<p>
To help, here are some expected results that should hold true for various combinations of the generated workspaces:
</p>
<table class="wiki">
<tr><th> Plot Combination </th><th> Available Spectra ID's </th><th> Available WS Indice(s) 
</th></tr><tr><td> <tt>even</tt>          </td><td> 0, 2, 4, 6          </td><td> 0-3 
</td></tr><tr><td> <tt>odd</tt>           </td><td> 1, 3, 5, 7          </td><td> 0-3 
</td></tr><tr><td> <tt>consecutive</tt>   </td><td> 2, 3, 4, 5          </td><td> 0-3 
</td></tr><tr><td> <tt>singleEven</tt> </td><td colspan="2"> The only available spectrum is automatically plotted 
</td></tr><tr><td> <tt>singleOdd</tt> </td><td colspan="2"> The only available spectrum is automatically plotted 
</td></tr><tr><td> <tt>singleOdd</tt> &amp; <tt>odd</tt> </td><td> 5 </td><td> 0 
</td></tr><tr><td> <tt>odd</tt> &amp; <tt>even</tt> </td><td> None available </td><td> 0-3 
</td></tr><tr><td> <tt>even</tt> &amp; <tt>consecutive</tt> </td><td> 2, 4 </td><td> 0-3 
</td></tr></table>
<p>
Also, load some WorkspaceGroup files (i.e. some MUSR000XXXXX.nxs files from AutoTestData) and see if selecting the WorkspaceGroup itself causes any problems.  Try various combinations that include the group children and the above workspaces.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="8279.html#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-30T13%3A03%3A55Z&amp;precision=second" title="2013-10-30T13:03:55Z in Timeline">7 years</a> ago by Karl Palmen
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        set to <em>Karl Palmen</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="8279.html#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-30T14%3A23%3A19Z&amp;precision=second" title="2013-10-30T14:23:19Z in Timeline">7 years</a> ago by Karl Palmen
                </h3>
                
    <div class="comment searchable">
      
      <p>
I find that the spectra plotted are the union of the sets of spectra of the workspaces. The ticket does not make it clear whether this is the desired behaviour, but it seems OK. There is also no crash when parent and child are selected.
</p>
<p>
One other issue, is that the title is the title of the first workspace rather than a composite of all the workspaces. I've created ticket <a class="assigned ticket" href="8302.html" title="enhancement: Sensible title of spectra plottered from several workspaces (assigned)">#8302</a> for this.
</p>
<p>
Test passed.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="8279.html#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-10-30T14%3A31%3A19Z&amp;precision=second" title="2013-10-30T14:31:19Z in Timeline">7 years</a> ago by Karl Palmen
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Merge remote-tracking branch 'origin/bugfix/8279_fix_plot_spectra_for_groups_and_multiple_workspace'
</p>
<p>
Full changeset: <a class="ext-link" href="https://github.com/mantidproject/mantid/commit/322f6b1fb22e326a251bf2cd8fdf0d37f19224ee"><span class="icon">​</span>322f6b1fb22e326a251bf2cd8fdf0d37f19224ee</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="8279.html#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T02%3A30%3A11%2B01%3A00&amp;precision=second" title="2015-06-04T02:30:11+01:00 in Timeline">5 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
This ticket has been transferred to github issue <a class="ext-link" href="http://github.com/mantidproject/mantid/issues/9124"><span class="icon">​</span>9124</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="../wiki/TracTickets.html">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/8279?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/8279?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/8279?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.5</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>