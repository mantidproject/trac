<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #7351 (SofQ is broken)
     – Mantid Project
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="prev" href="7350.html" title="Ticket #7350" />
        <link rel="last" href="11888.html" title="Ticket #11888" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/7351?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/7351?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="https://trac.mantidproject.org/mantid/ticket/7351?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="7352.html" title="Ticket #7352" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="1.html" title="Ticket #1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Mantid Project" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="a82fe30e7bef2e30fd2838e9";
    </script>
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="../chrome/common/js/resizer.js"></script><script type="text/javascript" src="../chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/mantid/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 7351, escape_newlines: 0}
        $("#comment").autoPreview("/mantid/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/mantid/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.mantidproject.org/"><img src="../chrome/site/mantid_logo_with_name.png" alt="Mantid Logo" width="250" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.mantidproject.org/mantid/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="7350.html" title="Ticket #7350">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="7352.html" title="Ticket #7352">Next Ticket</a> &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="7351.html">Ticket #7351</a>
          <span class="status">(closed: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-06-25T10%3A53%3A58%2B01%3A00&amp;precision=second" title="2013-06-25T10:53:58+01:00 in Timeline">7 years</a> ago</p>
    <p>Last modified <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T01%3A51%3A44%2B01%3A00&amp;precision=second" title="2015-06-04T01:51:44+01:00 in Timeline">5 years</a> ago</p>
  </div>
  <h2 class="summary searchable">SofQ is broken</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;reporter=Alex+Buts">Alex Buts</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;owner=Alex+Buts">Alex Buts</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;priority=major">major</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="../milestone/Release&#32;2.6.html">Release 2.6</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.mantidproject.org/mantid/query?status=!closed&amp;component=Direct+Inelastic">Direct Inelastic</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
              jon.taylor@…, nick.draper@…
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby"><span></span></td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking"><span></span></td>
        <th id="h_tester">
          Tester:
        </th>
        <td headers="h_tester">
              Martyn Gigg
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
      <span class="lastmod" title="2013-07-16 16:19:26.577440+00:00">
        (last modified by Martyn Gigg)
        (<a href="https://trac.mantidproject.org/mantid/ticket/7351?action=diff&amp;version=21">diff</a>)
      </span>
    </h3>
    <div class="searchable">
      <p>
Take direct geometry reduced file (I tried ISIS MAPSReduction.nxs from system tests but they all seems have the same problem)
</p>
<p>
Run SofQ.
</p>
<p>
error:
</p>
<p>
Error in execution of algorithm SofQW:
Workspace2D::getSpectrum, histogram number 1200 out of range 1200
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="7351.html#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-06-25T11%3A16%3A14%2B01%3A00&amp;precision=second" title="2013-06-25T11:16:14+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Owner</strong>
        set to <em>Alex Buts</em>
    </li><li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>assigned</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="7351.html#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-06-25T11%3A16%3A19%2B01%3A00&amp;precision=second" title="2013-06-25T11:16:19+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>assigned</em> to <em>accepted</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="7351.html#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-08T12%3A09%3A09%2B01%3A00&amp;precision=second" title="2013-07-08T12:09:09+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="7351.html" title="defect: SofQ is broken (closed: fixed)">#7351</a> This should fix it
</p>
<p>
Added the piece of code, which processes Ei log value in a way similar to SofQ3 does
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/ca33d17c71855cf4af2d1cde4520aa5db1af845a" title="ca33d17c71855cf4af2d1cde4520aa5db1af845a">ca33d17c71855cf4af2d1cde4520aa5db1af845a</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="7351.html#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-08T12%3A42%3A00%2B01%3A00&amp;precision=second" title="2013-07-08T12:42:00+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>accepted</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
To tester:
</p>
<p>
Fixed SofQ should run in indirect mode without providing incident energy as input property if Ei log value is present on data file
</p>
<p>
(e.g. MARIREduction.nxs can be processed by SofQ without providing incident energy value EFixed)
</p>
<p>
if one deletes data logs (RemoveLogs) SofQ would request to have EFixed provided. 
</p>
<p>
If Efixed provided is wrong (too small for the energy transfer, present in the data file) it generates meaningful error message. 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="7351.html#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-09T15%3A11%3A07%2B01%3A00&amp;precision=second" title="2013-07-09T15:11:07+01:00 in Timeline">7 years</a> ago by Russell Taylor
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>reopened</em>
    </li><li>
      <strong>Resolution</strong>
        <em>fixed</em> deleted
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Please fix this compiler warning and then re-close: <a class="ext-link" href="http://download.mantidproject.org/jenkins/view/Develop%20Clean%20Builds%20and%20Tests/job/is_clean_rhel6_develop/135/warnings19Result/file.1137216455/"><span class="icon">​</span>http://download.mantidproject.org/jenkins/view/Develop%20Clean%20Builds%20and%20Tests/job/is_clean_rhel6_develop/135/warnings19Result/file.1137216455/</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="7351.html#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-09T16%3A45%3A20%2B01%3A00&amp;precision=second" title="2013-07-09T16:45:20+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>reopened</em> to <em>accepted</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="7351.html#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-09T17%3A06%3A16%2B01%3A00&amp;precision=second" title="2013-07-09T17:06:16+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="7351.html" title="defect: SofQ is broken (closed: fixed)">#7351</a> Trivial fix to compiler warning
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/76860622e893240b15dd4babbf8d2add8faea66e" title="76860622e893240b15dd4babbf8d2add8faea66e">76860622e893240b15dd4babbf8d2add8faea66e</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="7351.html#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-10T15%3A15%3A28%2B01%3A00&amp;precision=second" title="2013-07-10T15:15:28+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>accepted</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="7351.html#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-12T14%3A15%3A46%2B01%3A00&amp;precision=second" title="2013-07-12T14:15:46+01:00 in Timeline">7 years</a> ago by Gesner Passos
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        set to <em>Gesner Passos</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="7351.html#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-12T14%3A45%3A32%2B01%3A00&amp;precision=second" title="2013-07-12T14:45:32+01:00 in Timeline">7 years</a> ago by Gesner Passos
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>reopened</em>
    </li><li>
      <strong>Resolution</strong>
        <em>fixed</em> deleted
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Two things: 
</p>
<p>
Run this and the same 'wrong' output comes out. 
</p>
<pre class="wiki">Load(Filename=r'MAPSReduction.nxs',OutputWorkspace='MAPSReduction')
SofQW(InputWorkspace='MAPSReduction',OutputWorkspace='out',QAxisBinning='0.2,0.2,2.0',EMode='Indirect', EFixed=2.082)
</pre><p>
Besides, it is not clear from the documentation that in direct mode, the ei from the run will override the one given by the user. (What I thing goes against the expected behavior. Values given by the user should override default values, do you agree?)
</p>

    </div>

              </div>
              <div class="change" id="trac-change-11">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:11" class="cnum">
      <a href="7351.html#comment:11">comment:11</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-12T15%3A16%3A52%2B01%3A00&amp;precision=second" title="2013-07-12T15:16:52+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>reopened</em> to <em>accepted</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
2) Yes, I have not looked at Indirect reduction, so may be worth fixing it too. Indirect usually has energy on components, so user supplied energy is rare. 
</p>
<p>
1) Doing Efixed on workspace overrides users Efixed I followed conversion noticed in SaveNXSPE, which used just before dealing with this ticket. The problem with user overrides Ei on workspace is that property remembers last used value. This means that user dealing with another workspace with another energy and not changing the energy in the algorithm window will provide wrong energy. This is why I think Efixed on workspace should override Efixed as property for direct conversion. For indirect it should be probably vise versa, as diffractometer set up to a specific energy which rarely changes, so user does not provides an energy without a reason. So, honestly, I do not know what way is better. Any decision of course should be well documented, so I would accept this change on this basis. 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:12" class="cnum">
      <a href="7351.html#comment:12">comment:12</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-15T17%3A48%3A26%2B01%3A00&amp;precision=second" title="2013-07-15T17:48:26+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="7351.html" title="defect: SofQ is broken (closed: fixed)">#7351</a> Extracted Common part of the SofQ codes into separate class
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/c73febef98b7561978f42272aba395962a93aa03" title="c73febef98b7561978f42272aba395962a93aa03">c73febef98b7561978f42272aba395962a93aa03</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-13">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:13" class="cnum">
      <a href="7351.html#comment:13">comment:13</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-15T17%3A48%3A32%2B01%3A00&amp;precision=second" title="2013-07-15T17:48:32+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="7351.html" title="defect: SofQ is broken (closed: fixed)">#7351</a> fixed crash in PDFFourierTransform
</p>
<p>
which is not connected to SofQ in any way but prevents me from running unit tests on Algorithms.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/2fb0ead633fbe561457207de6a880d6c5fb7dac2" title="2fb0ead633fbe561457207de6a880d6c5fb7dac2">2fb0ead633fbe561457207de6a880d6c5fb7dac2</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-14">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:14" class="cnum">
      <a href="7351.html#comment:14">comment:14</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-15T17%3A48%3A32%2B01%3A00&amp;precision=second" title="2013-07-15T17:48:32+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="7351.html" title="defect: SofQ is broken (closed: fixed)">#7351</a> Fixed ParameterMap failing in debug mode
</p>
<p>
after replacing double if statement
It does not look like anything to do with SofQ but prevents me from running unit tests for algorithms.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/d430704403446076f46bcc743ba0b93b814c8b40" title="d430704403446076f46bcc743ba0b93b814c8b40">d430704403446076f46bcc743ba0b93b814c8b40</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-15">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:15" class="cnum">
      <a href="7351.html#comment:15">comment:15</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-15T17%3A48%3A32%2B01%3A00&amp;precision=second" title="2013-07-15T17:48:32+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="7351.html" title="defect: SofQ is broken (closed: fixed)">#7351</a> Fixing ExtractMaskToTable which fails test in debug mode
</p>
<p>
this is nothing to do with SofQ but prevents me from running Algorithms tests in debug mode.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/4fc77fbf691aab7d6372f522e3113522ad8091d4" title="4fc77fbf691aab7d6372f522e3113522ad8091d4">4fc77fbf691aab7d6372f522e3113522ad8091d4</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-16">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:16" class="cnum">
      <a href="7351.html#comment:16">comment:16</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-15T18%3A02%3A16%2B01%3A00&amp;precision=second" title="2013-07-15T18:02:16+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="7351.html" title="defect: SofQ is broken (closed: fixed)">#7351</a> fixed crash in PDFFourierTransform
</p>
<p>
which is not connected to SofQ in any way but prevents me from running unit tests on Algorithms.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/8e1094ceed3700800b6bb748fb7bfa47a26c35b9" title="8e1094ceed3700800b6bb748fb7bfa47a26c35b9">8e1094ceed3700800b6bb748fb7bfa47a26c35b9</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-17">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:17" class="cnum">
      <a href="7351.html#comment:17">comment:17</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-15T18%3A02%3A16%2B01%3A00&amp;precision=second" title="2013-07-15T18:02:16+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="7351.html" title="defect: SofQ is broken (closed: fixed)">#7351</a> Fixed ParameterMap failing in debug mode
</p>
<p>
after replacing double if statement
It does not look like anything to do with SofQ but prevents me from running unit tests for algorithms.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/b3c51923444cab1ef5eae67ee196c2c144ba21c5" title="b3c51923444cab1ef5eae67ee196c2c144ba21c5">b3c51923444cab1ef5eae67ee196c2c144ba21c5</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-18">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:18" class="cnum">
      <a href="7351.html#comment:18">comment:18</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-15T18%3A02%3A16%2B01%3A00&amp;precision=second" title="2013-07-15T18:02:16+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="7351.html" title="defect: SofQ is broken (closed: fixed)">#7351</a> Fixing ExtractMaskToTable which fails test in debug mode
</p>
<p>
this is nothing to do with SofQ but prevents me from running Algorithms tests in debug mode.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/5c93875e2d1ae9143b7c2b46a6e725150dfc07cc" title="5c93875e2d1ae9143b7c2b46a6e725150dfc07cc">5c93875e2d1ae9143b7c2b46a6e725150dfc07cc</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-19">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:19" class="cnum">
      <a href="7351.html#comment:19">comment:19</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-15T18%3A36%3A07%2B01%3A00&amp;precision=second" title="2013-07-15T18:36:07+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="7351.html" title="defect: SofQ is broken (closed: fixed)">#7351</a> Reverting commits related to <a class="closed ticket" href="7454.html" title="enhancement: Unit test failures in Debug mode on windows (closed: fixed)">#7454</a>
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/c74ce0e70175d0546e6f4286d5516963221f3cc1" title="c74ce0e70175d0546e6f4286d5516963221f3cc1">c74ce0e70175d0546e6f4286d5516963221f3cc1</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-20">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:20" class="cnum">
      <a href="7351.html#comment:20">comment:20</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-15T18%3A48%3A20%2B01%3A00&amp;precision=second" title="2013-07-15T18:48:20+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>accepted</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
After some elaboration I've decided that the best way of dealing with this stuff is to provide unified interface for all SofQ algorithms. This is why the part responsible for Efixed property and emode is extracted from all 3 algorithms and added as separate class to all of them. 
</p>
<p>
I have also added check for negative ei in indirect mode, though the only situation when it can happens is when one processed direct data in indirect mode (fundamentally wrong)
</p>
<p>
Unit tests pass though I did not tried anything else. 
</p>
<p>
There were unit tests failing in Debug mode, so I had to fix this to actually run them. All these commits have been extracted from this ticket and went into <a class="closed ticket" href="7454.html" title="enhancement: Unit test failures in Debug mode on windows (closed: fixed)">#7454</a>
</p>

    </div>

                <div class="trac-lastedit ">
                  Last edited <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-15T18%3A51%3A22%2B01%3A00&amp;precision=second" title="2013-07-15T18:51:22+01:00 in Timeline">7 years</a> ago
                      by Alex Buts
                    (<a href="https://trac.mantidproject.org/mantid/ticket/7351?cversion=0&amp;cnum_hist=20#comment:20">previous</a>)
                    (<a href="https://trac.mantidproject.org/mantid/ticket/7351?action=comment-diff&amp;cnum=20&amp;version=1">diff</a>)
                </div>
              </div>
              <div class="change" id="trac-change-21">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:21" class="cnum">
      <a href="7351.html#comment:21">comment:21</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-16T17%3A19%3A26%2B01%3A00&amp;precision=second" title="2013-07-16T17:19:26+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Description</strong>
        modified (<a href="https://trac.mantidproject.org/mantid/ticket/7351?action=diff&amp;version=21">diff</a>)
    </li><li>
      <strong>Tester</strong>
        changed from <em>Gesner Passos</em> to <em>Martyn Gigg</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-22">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:22" class="cnum">
      <a href="7351.html#comment:22">comment:22</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-16T17%3A24%3A22%2B01%3A00&amp;precision=second" title="2013-07-16T17:24:22+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>reopened</em>
    </li><li>
      <strong>Resolution</strong>
        <em>fixed</em> deleted
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
There are some compiler warnings that I assume are related to this ticket. Could you fix them first.
</p>
<p>
<a class="ext-link" href="https://builds.sns.gov/view/Develop%20Clean/job/ornl_clean_rhel6_develop/2056/warnings17Result/"><span class="icon">​</span>https://builds.sns.gov/view/Develop%20Clean/job/ornl_clean_rhel6_develop/2056/warnings17Result/</a>?
</p>
<p>
While you are changing things could you look at the formatting of the SofQCommon code. There seems to be a lot of uneccessary whitespace, i.e line 10 &amp; 11, line 55,56. And finally the indentation of line 27 of SofCommon.h is inconsistent.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-23">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:23" class="cnum">
      <a href="7351.html#comment:23">comment:23</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-18T14%3A37%3A14%2B01%3A00&amp;precision=second" title="2013-07-18T14:37:14+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="7351.html" title="defect: SofQ is broken (closed: fixed)">#7351</a> Trivial compiler warnings.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/dd1177525c706a58b312b2b0864ed29b890171d8" title="dd1177525c706a58b312b2b0864ed29b890171d8">dd1177525c706a58b312b2b0864ed29b890171d8</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-24">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:24" class="cnum">
      <a href="7351.html#comment:24">comment:24</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-18T15%3A44%3A36%2B01%3A00&amp;precision=second" title="2013-07-18T15:44:36+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
refs <a class="closed ticket" href="7351.html" title="defect: SofQ is broken (closed: fixed)">#7351</a> Changes in formatting.
</p>
<p>
Changeset: <a class="changeset" href="https://github.com/mantidproject/mantid/commit/5e9e5a85d5143e4008c7af515fc8ad16ead69a3d" title="5e9e5a85d5143e4008c7af515fc8ad16ead69a3d">5e9e5a85d5143e4008c7af515fc8ad16ead69a3d</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-25">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:25" class="cnum">
      <a href="7351.html#comment:25">comment:25</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-18T16%3A16%3A53%2B01%3A00&amp;precision=second" title="2013-07-18T16:16:53+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>reopened</em> to <em>verify</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-26">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:26" class="cnum">
      <a href="7351.html#comment:26">comment:26</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-19T15%3A04%3A09%2B01%3A00&amp;precision=second" title="2013-07-19T15:04:09+01:00 in Timeline">7 years</a> ago by Gesner Passos
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        changed from <em>Martyn Gigg</em> to <em>Gesner Passos</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-27">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:27" class="cnum">
      <a href="7351.html#comment:27">comment:27</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-19T15%3A14%3A31%2B01%3A00&amp;precision=second" title="2013-07-19T15:14:31+01:00 in Timeline">7 years</a> ago by Gesner Passos
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>verify</em>
    </li><li>
      <strong>Tester</strong>
        <em>Gesner Passos</em> deleted
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Now I tried this one, because you said the users do not supply energy:
</p>
<pre class="wiki">Load(Filename=r'MAPSReduction.nxs',OutputWorkspace='MAPSReduction')
SofQW(InputWorkspace='MAPSReduction',OutputWorkspace='out',QAxisBinning='0.2,0.2,2.0',EMode='Indirect')
</pre><p>
it failed with this line: 
</p>
<pre class="wiki">RuntimeError: Cannot find EFixed parameter for component "PSD_TUBE_STRIP pixel;PSD_TUBE_STRIP pixel;PSD_TUBE_STRIP pixel;PSD_TUBE_STRIP pixel;". This is required in indirect mode. Please check the IDF contains these values.
  at line 2 in '/tmp/testscrip.py'
  caused by line 547 in '/apps/workspace/mantid_testing/bin/mantid/simpleapi.py'
</pre><p>
But, before your changes, the script pass. 
</p>
<p>
I'll not fail it, but I will return to the pool, as I think I'm not confident in the field to analyze the outputs. 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-28">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:28" class="cnum">
      <a href="7351.html#comment:28">comment:28</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-19T15%3A25%3A46%2B01%3A00&amp;precision=second" title="2013-07-19T15:25:46+01:00 in Timeline">7 years</a> ago by Alex Buts
                </h3>
                
    <div class="comment searchable">
      
      <p>
MARI is Direct instrument, so processing it in Indirect mode is the way to have problem, though it may process it producing some rubbish. 
</p>
<p>
In this particular case, without providing energy, it tries to get EFixed on components and rightly fails to get one. Providing energy as a property should make it pass. 
</p>
<p>
Direct reduced data should have Ei property attached, and I believe this one is present in the MAPSReduction.nxs file. 
</p>
<p>
Indirect are IRIS and OSIRIS and these two should work with the script suggested though I have not tried
</p>

    </div>

                <div class="trac-lastedit ">
                  Last edited <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-19T15%3A30%3A01%2B01%3A00&amp;precision=second" title="2013-07-19T15:30:01+01:00 in Timeline">7 years</a> ago
                      by Alex Buts
                    (<a href="https://trac.mantidproject.org/mantid/ticket/7351?cversion=1&amp;cnum_hist=28#comment:28">previous</a>)
                    (<a href="https://trac.mantidproject.org/mantid/ticket/7351?action=comment-diff&amp;cnum=28&amp;version=2">diff</a>)
                </div>
              </div>
              <div class="change" id="trac-change-29">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:29" class="cnum">
      <a href="7351.html#comment:29">comment:29</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-22T08%3A56%3A32%2B01%3A00&amp;precision=second" title="2013-07-22T08:56:32+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li><li>
      <strong>Tester</strong>
        set to <em>Martyn Gigg</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-30">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:30" class="cnum">
      <a href="7351.html#comment:30">comment:30</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-22T09%3A21%3A54%2B01%3A00&amp;precision=second" title="2013-07-22T09:21:54+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>verify</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Merge remote-tracking branch 'origin/bugfix/7351_SofQ_isBroken'
</p>

    </div>

              </div>
              <div class="change" id="trac-change-31">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:31" class="cnum">
      <a href="7351.html#comment:31">comment:31</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-22T09%3A22%3A41%2B01%3A00&amp;precision=second" title="2013-07-22T09:22:41+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verify</em> to <em>verifying</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-32">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:32" class="cnum">
      <a href="7351.html#comment:32">comment:32</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-22T09%3A22%3A46%2B01%3A00&amp;precision=second" title="2013-07-22T09:22:46+01:00 in Timeline">7 years</a> ago by Martyn Gigg
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>verifying</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-33">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:33" class="cnum">
      <a href="7351.html#comment:33">comment:33</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-24T09%3A53%3A42%2B01%3A00&amp;precision=second" title="2013-07-24T09:53:42+01:00 in Timeline">7 years</a> ago by Nick Draper
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Component</strong>
        changed from <em>Mantid</em> to <em>Framework</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-34">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:34" class="cnum">
      <a href="7351.html#comment:34">comment:34</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2013-07-25T12%3A02%3A11%2B01%3A00&amp;precision=second" title="2013-07-25T12:02:11+01:00 in Timeline">7 years</a> ago by Nick Draper
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Component</strong>
        changed from <em>Framework</em> to <em>Direct Inelastic</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-35">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:35" class="cnum">
      <a href="7351.html#comment:35">comment:35</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="https://trac.mantidproject.org/mantid/timeline?from=2015-06-04T01%3A51%3A44%2B01%3A00&amp;precision=second" title="2015-06-04T01:51:44+01:00 in Timeline">5 years</a> ago by Stuart Campbell
                </h3>
                
    <div class="comment searchable">
      
      <p>
This ticket has been transferred to github issue <a class="ext-link" href="http://github.com/mantidproject/mantid/issues/8197"><span class="icon">​</span>8197</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="../wiki/TracTickets.html">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/7351?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/7351?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.mantidproject.org/mantid/ticket/7351?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.5</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>